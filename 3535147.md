# Millimeter Scale Track Irregularity Surveying Based on ZUPT-Aided INS with Sub-Decimeter Scale Landmarks

CorpusID: 3535147
 
tags: #Medicine, #Engineering, #Computer_Science

URL: [https://www.semanticscholar.org/paper/2f7fd5bf4cc113834286bda899f9dc20399b8287](https://www.semanticscholar.org/paper/2f7fd5bf4cc113834286bda899f9dc20399b8287)
 
| Is Survey?        | Result          |
| ----------------- | --------------- |
| By Classifier     | False |
| By Annotator      | (Not Annotated) |

---

Millimeter Scale Track Irregularity Surveying Based on ZUPT-Aided INS with Sub-Decimeter Scale Landmarks
Published: 12 September 2017

Qingan Jiang 
Department of Automatic Control
College of Mechatronics and Automation
National University of Defense Technology
410073ChangshaChina

Wenqi Wu 
Department of Automatic Control
College of Mechatronics and Automation
National University of Defense Technology
410073ChangshaChina

Yun Li 
Department of Automatic Control
College of Mechatronics and Automation
National University of Defense Technology
410073ChangshaChina

Mingming Jiang 
Department of Automatic Control
College of Mechatronics and Automation
National University of Defense Technology
410073ChangshaChina

Millimeter Scale Track Irregularity Surveying Based on ZUPT-Aided INS with Sub-Decimeter Scale Landmarks
Published: 12 September 201710.3390/s17092083Received: 20 August 2017; Accepted: 8 September 2017;sensors Article * Correspondence:railway track irregularityINSZUPTKalman filteringRTS smoothingcovariance analysis
Railway track irregularity surveying is important for the construction and the maintenance of railway lines. With the development of inertial devices, systems based on Inertial Navigation System (INS) have become feasible and popular approaches in track surveying applications. In order to overcome the requirement of high precision control points, this paper proposes a railway track irregularity measurement approach using the INS combined with the Zero Velocity Updates (ZUPT) technique and sub-decimeter scale landmarks. The equations for calculating track irregularity parameters from absolute position errors are deduced. Based on covariance analysis, the analytical relationships among the track irregularity measurements with the drifts of inertial sensors, the initial attitude errors and the observations of velocity and position are established. Simulations and experimental results show that the relative accuracy for 30 m chord of the proposed approach for track irregularity surveying can reach approximately 1 mm (1σ) with gyro bias instability of 0.01 • /h, random walk noise of 0.005 • / √ h, and accelerometer bias instability of 50 µg, random noise of 10 µg/ √ Hz, while velocity observations are provided by the ZUPT technique at about every 60 m intervals. This accuracy can meet the most stringent requirements of millimeter scale medium wavelength track irregularity surveying for railway lines. Furthermore, this approach reduces the requirement of high precision landmarks which can lighten the maintenance burden of control points and improve the work efficiency of railway track irregularity measurements. flexible track surveying trolleys can handle different measurement tasks such as measurements during the construction stage and measurements of shorter stretches of track[1,2].The most well-known track surveying trolleys, widely deployed in China, are the GPR1000 series products provided by Amberg Technologies (Regensdorf, Switzerland)[3]. These kinds of trolleys are all-in-one solutions for surveying railway tracks, enabling the assessment of parameters such as the cant, track gauge, chainage, alignment and level with high accuracy, and can provide sub-millimeter absolute accuracy measured by total station in stop-and-go mode. The Swiss Trolley is another representative track surveying trolley which is developed by the Institute of Geodesy and Photogrammetry at ETH Zurich[1,2]. Glaus[2]has presented this kind of trolley thoroughly. The basic devices the Swiss Trolley is equipped with are an inclinator, track gauge measuring system and odometer can measure gradient, cant, gauge, and chainage. Absolute positioning is done by Global Positioning System (GPS) and total station. According to Glaus [2], GPS measurements fulfill most accuracy requirements contrary to the general opinion that submillimeter absolute accuracy has to be obtained in railway surveying.With the development of inertial sensors, INS is no longer expensive and bulky. Track surveying systems based on INS have been widely applied in railway track surveying. A limitation of a stand-alone INS is its unfavourable error propagation. Error drifts of INS should be depressed by other sensors providing relative or absolute measurement updates such as ZUPT, Control Points Coordinate Updates (CUPT) and so on. Luck [4] discussed the design of track measurement systems based on INS/GPS integration for the dynamic inspection locomotive. Niu and Chen [3] presented an INS/GPS integrated system to measure railway track irregularities with relative accuracy of 1 mm. Non-holonomic constraint and ZUPT are implemented in their integration algorithm to improve the surveying accuracy. In order to implement the measuring task with GPS outages, Li [5] presented a track irregularity measurement trolley equipped with a laser-aided INS/odometer integration system for subway applications whose observations of control points for position updates are measured by the laser scanner. The standard deviations of alignment and vertical irregularities can reach approximately 1 mm. Jiang [6] utilized the Inertial Measurement Unit (IMU)/odometer/landmark integration technique for railway track surveying and obtained absolute accuracy of 1 mm.The key issue about INS-based track irregularity surveying systems is suppressing the position errors produced by drifts of inertial sensors using global position information[5]. In previous works, a great job about the integrations of INS with position measurement sensors and the data fusion of INS measurement with position information has been done for track surveying, but there are few studies about the accuracy requirement of inertial sensors and observation updates that can meet the demands for railway irregularity measurement theoretically or experimentally. In addition, the traditional measurement approaches based on global position information have their own shortcomings. The GPS signal may be disturbed by obstructions which affect the GPS solutions negatively. The distribution and precision of control points are crucial to ensure measurement accuracy for approaches based on landmarks. The construction of control points is costly and their maintenance at millimeter scale is difficult. Even if high precision landmarks can be maintained well, high precise position observations cannot be provided frequently in order to insure the work efficiency of the measurement task, especially for environments without GPS signals, for instance tunnels. Therefore, it is significant to research approaches using less number of landmarks with low precision for railway track irregularity measurement.This paper focuses on the issue of the railway track irregularity measurement using a ZUPT-aided INS to achieve high accuracy measurement of relative track geometry parameters to reduce the requirement of high precision landmarks. A typical Kalman filter with 12 dimensional error states is designed in the paper and the Rauch-Tung-Striebel (RTS) smoother is employed to improve the position accuracy. Aiming at alignment and level irregularities of the track, we established the relationship between track irregularities and the absolute position deviations. Based on covariance analysis, the surveying accuracy of alignment and level irregularities is presented, the analytical relationship Sensors 2017, 17, 2083 3 of 22about irregularities with the precisions of inertial sensors, initial attitudes and observation updates are established. Simulation and experimental results are also presented.

## Introduction

Railway track irregularity is one of the most important factors affecting the safe operation of the train. The irregularity can be assessed by track geometry parameters, the measurement of which plays a significant role in monitoring the track deformation and guiding the maintenance of railway lines [1]. Trains with higher speed require higher track smoothness. With the development of high-speed railways, the demands for track irregularity measurement techniques with high-accuracy and high-efficiency are increasing rapidly [2].

Traditionally, there are mainly two categories of track irregularity measurement methods namely dynamic measurement and static measurement. Methods based on Track Recording Coaches (TRCs) are a kind of dynamic one under wheel loading [1,2]. TRC can measure long wavelength track irregularities with high work efficiency, but their availability is restricted and the measuring accuracy does not fulfil the requirements for track renewals [2]. Another method based on manual measuring devices is a kind of static one. These kinds of devices used for spot assessment are surpassed by railway track surveying trolleys in terms of data amounts and time efficiency. The lightweight and established the relationship between track irregularities and the absolute position deviations. Based on covariance analysis, the surveying accuracy of alignment and level irregularities is presented, the analytical relationship about irregularities with the precisions of inertial sensors, initial attitudes and observation updates are established. Simulation and experimental results are also presented.

The rest of the paper is organized as follows: Section 2 describes the railway track irregularity and assessment. Section 3 describes the overview of the measurement system and the algorithm. Section 4 describes the design of Kalman filter and smoother. Section 5 presents the calculation method of alignment and level irregularities from absolute position as well as the covariance analysis of them. Section 6 reports the simulation and experimental results of track irregularity. Section 7 concludes this paper.


## Railway Track Irregularity and Assessment

Railway tracks can be regarded as a 3-dimensional curve [3,5]. Track irregularity refers to the deviation of the track from its design geometry, which is usually determined by five geometry parameters, namely alignment (horizontal alignment), level (vertical alignment), cant (super-elevation or cross-level), twist and gauge [7][8][9]. As illustrated in Figure 1, the axes of the rail coordinate system are defined as follows: the x-axis is in the travelling direction, y-axis parallel to the running surface, and z-axis perpendicular to the running surface and pointing downwards. Alignment is the track's displacement in the horizontal plane, which can be seen as the deviation of actual track from the design one in horizontal plane. Level is the displacement in the vertical plane [1]. Gauge is the distance between the inner sides of the two railheads. Cant is the difference between the elevations of the running surface of two rails, representing the tilting of the track in curves in order to compensate the centripetal force. Twist is defined as the difference in cant over a given length.

In this paper, the gauges are estimated from track gauge measurement system. Cant and twist can be calculated in simple models, and will not be discussed in detail. The alignment and level irregularities will be evaluated as examples to demonstrate the measuring accuracy. According to the railway standards [8,9], the alignment and level are measured by the vector distance value with a chord of fixed length (e.g., 30 m) on the rail surface in the horizontal and vertical directions respectively. The magnitude of alignment and level irregularities will be calculated by differential method of 30 m chord. As shown in Figure  In this paper, the gauges are estimated from track gauge measurement system. Cant and twist can be calculated in simple models, and will not be discussed in detail. The alignment and level irregularities will be evaluated as examples to demonstrate the measuring accuracy.

According to the railway standards [8,9], the alignment and level are measured by the vector distance value with a chord of fixed length (e.g., 30 m) on the rail surface in the horizontal and vertical directions respectively. The magnitude of alignment and level irregularities will be calculated by differential method of 30 m chord. As shown in Figure 2, the red curve represents a segmentation of railway track in 3-dimensional space; the other two curves are the projections in horizontal plane and vertical plane respectively. The 30 m long chord is determined by points p 0m and p 30m on the curve. Take the point p s on the curve as an example. The distance from p s to the chord is the vector distance of this point represented by d s . Vector distance of the next adjacent point p s+5m with 5 m interval is d s+5m . The track irregularity of point p s can be calculated by Equation (1) [8]:
∆ s = (d s − d s+5m ) − d s − d s+5m = d s − d s − d s+5m − d s+5m(1)
where d s and d s+5m represent measurement values of vector distances about points p s and p s+5m . d s and d s+5m represent the design values of them. ∆ s represents the track irregularity of point p s , projection of which in the horizontal plane is the alignment irregularity and in the vertical plane is the level irregularity.  


## Track Irregularity Measurement System

The track irregularity measurement system is illustrated in Figure 3. The system is equipped with a T-type trolley, a track gauge sensor, a high precision prism, an odometer, and a navigation grade IMU. The IMU consists of three high accuracy ring laser gyros (RLGs, bias instability: 0.01°/h and angular random walk (ARW): 0.005 °√h ⁄ ) and three high stability quartz accelerometers (bias instability: 50 μg and random noise: 10 μg/√Hz). The prism mounted on the trolley is used to provide position observations worked with a Leica optical total station (1 mm and 0.5″) based on control points. The odometer of the system can be used as an aid to determine the position of the irregularity measurements along the track in this paper. The gauge sensor is used to measure the gauge of the tracks.  Figure 4 illustrates an overview of the data processing procedure of the Kalman filtering and smoothing algorithm based on ZUPT-aided INS combined with landmarks employed in the paper. The system makes use of the measurements of IMU (angular increments Δθ from gyros and specific force integrations Δv from accelerometers) and the initial position measured by total station for initial alignment to calculate the initial attitudes. After that the trolley is pushed forward manually on the track at walking speed. After it moves across a certain distance interval (60 m in this paper), the trolley stops and a zero-velocity observation and a position observation will be updated. Then Kalman filtering and smoothing algorithm is executed to output the optimized 


## Kalman Filtering and Smoothing Algorithm Design


### Overview of Data Processing


## Track Irregularity Measurement System

The track irregularity measurement system is illustrated in Figure 3. The system is equipped with a T-type trolley, a track gauge sensor, a high precision prism, an odometer, and a navigation grade IMU. The IMU consists of three high accuracy ring laser gyros (RLGs, bias instability: 0.01 • /h and angular random walk (ARW): 0.005 • / √ h) and three high stability quartz accelerometers (bias instability: 50 µg and random noise: 10 µg/ √ Hz). The prism mounted on the trolley is used to provide position observations worked with a Leica optical total station (1 mm and 0.5") based on control points. The odometer of the system can be used as an aid to determine the position of the irregularity measurements along the track in this paper. The gauge sensor is used to measure the gauge of the tracks.  


## Track Irregularity Measurement System

The track irregularity measurement system is illustrated in Figure 3. The system is equipped with a T-type trolley, a track gauge sensor, a high precision prism, an odometer, and a navigation grade IMU. The IMU consists of three high accuracy ring laser gyros (RLGs, bias instability: 0.01°/h and angular random walk (ARW): 0.005 °√h ⁄ ) and three high stability quartz accelerometers (bias instability: 50 μg and random noise: 10 μg/√Hz). The prism mounted on the trolley is used to provide position observations worked with a Leica optical total station (1 mm and 0.5″) based on control points. The odometer of the system can be used as an aid to determine the position of the irregularity measurements along the track in this paper. The gauge sensor is used to measure the gauge of the tracks.  Figure 4 illustrates an overview of the data processing procedure of the Kalman filtering and smoothing algorithm based on ZUPT-aided INS combined with landmarks employed in the paper. The system makes use of the measurements of IMU (angular increments Δθ from gyros and specific force integrations Δv from accelerometers) and the initial position measured by total station for initial alignment to calculate the initial attitudes. After that the trolley is pushed forward manually on the track at walking speed. After it moves across a certain distance interval (60 m in this paper), the trolley stops and a zero-velocity observation and a position observation will be updated. Then Kalman filtering and smoothing algorithm is executed to output the optimized  Figure 4 illustrates an overview of the data processing procedure of the Kalman filtering and smoothing algorithm based on ZUPT-aided INS combined with landmarks employed in the paper. The system makes use of the measurements of IMU (angular increments ∆θ from gyros and specific force integrations ∆v from accelerometers) and the initial position measured by total station for initial alignment to calculate the initial attitudes. After that the trolley is pushed forward manually on the track at walking speed. After it moves across a certain distance interval (60 m in this paper), the trolley stops and a zero-velocity observation and a position observation will be updated. Then Kalman filtering and smoothing algorithm is executed to output the optimized position, velocity and attitude measurements of the interval. Since the wheels of the trolley can keep continuous contact with the railway track, the 3-dimensional track geometry can be determined by position and attitude sequences of the INS uniquely. Then track parameters can be calculated and track irregularities can be detected. position, velocity and attitude measurements of the interval. Since the wheels of the trolley can keep continuous contact with the railway track, the 3-dimensional track geometry can be determined by position and attitude sequences of the INS uniquely. Then track parameters can be calculated and track irregularities can be detected. 


## Kalman Filtering and Smoothing Algorithm Design


### Overview of Data Processing


## Kalman Filtering and Smoothing Algorithm Design


### Overview of Data Processing
, Δ Δv θ v INS δ v, x Pr RTS , , ε ε ∇ N D D , v rˆ, , δ δ v r φ KF K F K Fδ r RTS r INS , v r

### System Equations and Measurement Equations of Kalman Filter

The error equations of the attitude, velocity and position for the railway track surveying application can be expressed as Equation (2) [10]: 
( ) ( ) 2 2 2 δ δ δ δ δ δ δ δ δ δ δ δ = − × + − ≈ − × − = × − + × − + × + ≈ × − × + = ω ω ω ω ω v f ω ω v ω ω v f f ω v f r v φ φ φ φ φ    n
where i -frame is the inertial frame. n -frame is the local level frame (North-East-Down) used as the navigation frame. b-frame is the body frame of the IMU (Forward-Right-Down).

[ ]
T n N E D φ φ φ = φ
represents the vector of attitude errors about the north, east and downward axes of the navigation frame. δ ω and δf b can be expressed as shown by Equations (3) and (4):
[ ] δ δ ε ε ε   = = +   ω ω T T n b n n b i b i b N E D b g x g y g z C Cw w w(3)
where δω n ib is the drifts of gyros expressed in n -frame. ε N , ε E and ε D are the equivalent gyro biases of the north, east and downward directions. gx w , gy w and gz w are the random noises of gyros:
[ ] δ δ   = = ∇ ∇ ∇ +   f f T T n b n n b N E D b a x a y a z C Cw w w (4)
where δf n is the drifts of accelerometers expressed in n -frame. ∇ N , ∇ E and ∇ D are the equivalent accelerometer biases of the north, east and downward directions. ax w , ay w and az w are the random noises of accelerometers. 


### System Equations and Measurement Equations of Kalman Filter

The error equations of the attitude, velocity and position for the railway track surveying application can be expressed as Equation (2) [10]:
φ n = −ω n in × φ n + δω n in − C n b δω b ib ≈ −ω n ie × φ n − C n b δω b ib δ . v n = f n × φ n − 2ω n ie + ω n en × δv n − 2δω n ie + δω n en × v n + C n b δf b ≈ f n × φ n − 2ω n ie × δv n + C n b δf b δ . r n = δv n(2)
where i-frame is the inertial frame. n-frame is the local level frame (North-East-Down) used as the navigation frame.

b-frame is the body frame of the IMU (Forward-Right-Down).
φ n = φ N φ E φ D T
represents the vector of attitude errors about the north, east and downward axes of the navigation frame. C n b represents the direction cosine matrix. ω n in represents the turn rate of the navigation frame with respect to the inertial frame expressed in the n-frame. It can be obtained by summing the Earth's rotation rate with respect to the inertial frame and the turn rate of the navigation frame with respect to the Earth as: ω n in = ω n ie + ω n en . δω b ib represents the drift errors of gyroscopes. δv n is the vector of velocity errors. f n represents the specific force in navigation axes. δf b is the drift errors of accelerometers. δr n represents the position error in navigation axes. The errors of inertial sensors in this paper are normally modeled as piecewise constant values. The position coordinates of the measured track are expressed in segmentation with n 0 -frame, which is so near with the n-frame that C n 0 n ≈ I and δr n 0 = C n 0 n δr n ≈ δr n = δr N δr E δr D T . For medium wavelength (30 m chord) track irregularity surveying, the track segmentation is set to be 60 m long in this paper. Moreover δω b ib and δf b can be expressed as shown by Equations (3) and (4):
C n b δω b ib = δω n ib = ε N ε E ε D T + C n b w gx w gy w gz T(3)
where δω n ib is the drifts of gyros expressed in n-frame. ε N , ε E and ε D are the equivalent gyro biases of the north, east and downward directions. w gx , w gy and w gz are the random noises of gyros:
C n b δf b = δf n = ∇ N ∇ E ∇ D T + C n b w ax w ay w az T (4)
where δf n is the drifts of accelerometers expressed in n-frame. ∇ N , ∇ E and ∇ D are the equivalent accelerometer biases of the north, east and downward directions. w ax , w ay and w az are the random noises of accelerometers. The railway track surveying application has its own characteristics compared with some other applications based on inertial measurement such as land vehicle navigation, airborne gravity measurement and so on. Since the track of high speed railways is almost level and straight with a very large radius of curvature, trolley maneuvers are rather weak when moving on the track at  [3,6]. Some error parameters of the INS are coupled together with others, for example, the orientation error is coupled with the equivalent east gyro bias, and the level errors are coupled with equivalent horizontal accelerometer biases, so the equivalent east gyro bias ε E and the equivalent horizontal accelerometer biases ∇ N and ∇ E are unobservable. They will not be estimated as error states in the Kalman filter. Since the trolley moves in walking speed (less than 8 km/h [8]) and the length of the measurement interval is short, the terms of ω n en and δω n in can be ignored as shown in Equation (2).

Consider the analysis above, a typical Kalman filter with 12 dimensional error states is established in this paper. The system error model and the observation model can be expressed as Equation (5):
. x(t) = Ax(t) + Gw(t) z(t) = Hx(t) + υ(t)(5)
where the error state vector x(t) can be written as in Equation (6):
x(t) = φ N φ E φ D δv N δv E δv D δr N δr E δr D ε N ε D ∇ D T(6)
According to Equation (2), the system error matrix A and the system noise matrix G can be expressed in simplified form by Equations (7) and (8):
A =                       0 −Ω sin L 0 0 0 0 0 0 0 −1 0 0 Ω sin L 0 Ω cos L 0 0 0 0 0 0 0 0 0 0 −Ω cos L 0 0 0 0 0 0 0 0 −1 0 0 − f D f E 0 −2Ω sin L 0 0 0 0 0 0 0 f D 0 − f N 2Ω sin L 0 2Ω cos L 0 0 0 0 0 0 − f E f N 0 0 −2Ω cos L 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0                       (7) G = −C n b 0 3×3 0 3×3 C n b (8) z(t) = δv n δr n T
is the filter observation vector and velocity as well as position of the trolley are used as update information in the Kalman filter. The measurement matrix H is defined by Equation (9):
H = 0 3×3 I 3×3 0 3×3 0 3×3 0 3×3 0 3×3 I 3×3 0 3×3 (9)
w(t) and υ(t) are the system noise and the measurement noise, whose Power Spectral Density (PSD) are Q(t) and R(t) respectively. They can be expressed as Equation (10):
w(t) = w gx w gy w gz w ax w ay w az T , w(t) ∼ N(0, Q(t)) Q(t) = diag σ 2 w gx σ 2 w gy σ 2 w gz σ 2 w ax σ 2 w ay σ 2 w az υ(t) = υ v N υ v E υ v D υ r N υ r E υ r D T , υ(t) ∼ N(0, R(t)) R(t) = diag σ 2 v N σ 2 v E σ 2 v D σ 2 r N σ 2 r E σ 2 r D(10)
Sensors 2017, 17, 2083 7 of 22


### Smoothing Algorithm

The position errors and their covariance between two observation updates will increase with time caused by the residual system errors. It is even more serious for the situations that the observation is few and not much precise. In order to obtain optimal position estimations during the updates outages, a smoothing algorithm must be applied utilizing all the past, current and future measurements [11,12]. This paper employs the well-known RTS smoothing algorithm to estimate the states in the measurement intervals. The RTS smoother consists of a common forward Kalman filter and a backward smoother. The backward sweep begins at the end of the forward Kalman filter. Figure 5 illustrates the computation procedure of the RTS smoother.


### Smoothing Algorithm

The position errors and their covariance between two observation updates will increase with time caused by the residual system errors. It is even more serious for the situations that the observation is few and not much precise. In order to obtain optimal position estimations during the updates outages, a smoothing algorithm must be applied utilizing all the past, current and future measurements [11,12]. This paper employs the well-known RTS smoothing algorithm to estimate the states in the measurement intervals. The RTS smoother consists of a common forward Kalman filter and a backward smoother. The backward sweep begins at the end of the forward Kalman filter. Figure 5 illustrates the computation procedure of the RTS smoother. Figure 5. The RTS smoothing algorithm computational process.
k t 1 k t − 1 k t + 1 t 0 t 1 N t − N t − fk x − fk P + fk Pˆb k x bk Pˆ+ fN x − fN x − fN P + fN P bN x bN P + fk x
The forward Kalman filter is the common one, can be expressed in discrete form as Equation (11) shows:
[ ] 1 1 1 1ˆˆ− − − + − − + + − − + + − + +   = +     = + −   = − = Φ = Φ Φ + Γ Γ x x z x x x  T T k fk k k fk k k fk fk k k k fk fk k k fk fk k fk T T fk k fk k k k k K P H H P H R K H P I K H P P P Q(11)
where ˆf k + x and fk P + represent the updated estimate of state vector and its corresponding covariance matrix of the forward filter at epoch k.  The forward Kalman filter is the common one, can be expressed in discrete form as Equation (11) shows:
+ − + − + + − + + + − + + = = = Φ   = + −     = − −   x x x x x x     N f N N f N T k f k k f k k f k k k f k T k f k k f k k k P P H P P H P P H P P H (12) ( ) ( ) ( ) ( ) , 0 , υ υ υ υ υ υ   =   υ υ N E D N E D T v v v r r r t tNR t ( ) ( ) 2 2 2 2 2 2 σ σ σ σ σ σ   =   N E D N E D v v v r r r R t diagK k = P − f k H T k H k P − f k H T k + R k −1 x + f k =x − f k + K k z k+1 − H kx − f k P + f k = [I − K k H k ]P − f k x − f k+1 = Φ kx + f k P − f k+1 = Φ k P + f k Φ T k + Γ k Q k Γ T k(11)
wherex + f k and P + f k represent the updated estimate of state vector and its corresponding covariance matrix of the forward filter at epoch k.x − f k+1 is the optimal predicted estimate and P − f k+1 represents its covariance matrix. H k is the measurement matrix. K k is the gain matrix of forward Kalman filter at epoch k. Φ k is the system state transition matrix which can be calculated by matrix A.

The backward smoother can be expressed in the discrete form as shown by Equation (12) [13,14]:
x N =x + f N , P N = P + f N H k = P + f k Φ T k P − f k+1 −1 x k =x + f k + H k x k+1 −x − f k+1 P k = P + f k − H k P − f k+1 − P k+1 H T k(12)
wherex k is the optimal smoothed estimate of state vector at time epoch k. P k is the error state covariance matrix of the smoother. H k is the smoothing gain matrix.


### Alignment Irregularity and Level Irregularity Calculated from Absolute Poisition Devition

In order to assess the track irregularity, the relative geometry parameters of alignment and level should be calculated after obtaining the absolute position of the track. As Figure 6 illustrates, an arbitrarily 30 m chord on the 60 m track segmentation is determined by two points p 0m and p 30m whose coordinates are respectively marked in n 0 -frame as r n 0 p 0m = r p 0m N r p 0m E r p 0m D 
p 30m = r p 30m N r p 30m E r p 30m D T .
The measurement values of their coordinates are marked as r n 0 p 0m = r p 0m N r p 0m E r p 0m D T and r n 0 p 30m = r p 30m N r p 30m E r p 30m D T respectively. p s represents an arbitrary point on the trajectory for this chord, coordinates of which are marked as r n 0 p s = r p s N r p s E r p s D T for the true value and r n 0 p s = r p s N r p s E r p s D T for the measurement value. d s is the vector distance from p s to the chord, projections of which in horizontal plane and vertical plane are alignment and level, respectively.


### Alignment Irregularity and Level Irregularity Calculated from Absolute Poisition Devition

In order to assess the track irregularity, the relative geometry parameters of alignment and level should be calculated after obtaining the absolute position of the track. As Figure 6 illustrates, an arbitrarily 30 m chord on the 60 m track segmentation is determined by two points 0m p and 30m p whose coordinates are respectively marked in 0 n -frame as 0  As shown in Figure 6, the track segmentation is 60 m long for ZUPT and absolute position update. For arbitrary 30 m chord on the track segmentation, we define a new frame as c -frame, whose x-axis is identical with the chord and can be obtained by a rotation θ a about z-axis and a rotation θ l about y-axis of 0 n -frame sequentially. We can calculate the vector distance values for every point of a trajectory by transforming the coordinates from 0 n -frame to c -frame. The relationship between 0 n -frame and c -frame can be written as Equation (13):   As shown in Figure 6, the track segmentation is 60 m long for ZUPT and absolute position update. For arbitrary 30 m chord on the track segmentation, we define a new frame as c-frame, whose x-axis is identical with the chord and can be obtained by a rotation θ a about z-axis and a rotation θ l about y-axis of n 0 -frame sequentially. We can calculate the vector distance values for every point of a trajectory by transforming the coordinates from n 0 -frame to c-frame. The relationship between n 0 -frame and c-frame can be written as Equation (13) 
0 0 0 0   =   r m m m mθ θ θ θ     − −             = = − −                 −             − = −θ θ θ θ θ   −       −         −      
According to the definition of alignment and level together with the Figure 6, r c p s y represents the alignment and r c p s z represents the level and they can be calculated by Equation (14): r c p s y = − r n 0 p s N − r n 0 p 0m N sin θ a + r n 0 p s E − r n 0 p 0m E cos θ a r c p s z = r n 0 p s N − r n 0 p 0m N sin θ l cos θ a + r n 0 p s E − r n 0 p 0m E sin θ l sin θ a + r n 0 p s D − r n 0 p 0m D cos θ l

Sensors 2017, 17, 2083 9 of 22

In addition, we can express θ a and θ l by coordinate values as shown in Equation (15) according to Figure 6:
sin θ a = r n 0 p 30m E −r n 0 p 0m E r n 0 p 30m N −r n 0 p 0m N 2 + r n 0 p 30m E −r n 0 p 0m E 2 , cos θ a = r n 0 p 30m N −r n 0 p 0m N r n 0 p 30m N −r n 0 p 0m N 2 + r n 0 p 30m E −r n 0 p 0m E 2 sin θ l = r n 0 p 0m D −r n 0 p 30m D r n 0 p 30m N −r n 0 p 0m N 2 + r n 0 p 30m E −r n 0 p 0m E 2 + r n 0 p 30m D −r n 0 p 0m D 2 cos θ l = r n 0 p 30m N −r n 0 p 0m N 2 + r n 0 p 30m E −r n 0 p 0m E 2 r n 0 p 30m N −r n 0 p 0m N 2 + r n 0 p 30m E −r n 0 p 0m E 2 + r n 0 p 30m D −r n 0 p 0m D 2(15)
The deviations of r c p s y and r c p s z can be calculated by variational method as expressed by Equations (16) and (17): 

Substituting Equations (16) and (17) into Equation (1) yields the alignment irregularity and the level irregularity. Since gradient of the railway track is very small (25 m/1000 m for the largest gradient) and the turning radius is very large (2000 m) in general, the alignment irregularity and the level irregularity can be simplified by ignoring the small terms as Equations (18) 

where l c = r n 0
p 30m N − r n 0 p 0m N 2 + r n 0 p 30m E − r n 0 p 0m E 2 + r n 0 p 30m D − r n 0 p 0m D 2
represents the length of the chord. l 5m = 5m is the distance between points p s and p s+5m . The derivation processes of Equations (18) and (19) are shown in Appendix A. As Figure 7 illustrates, even though the absolute position measurements may have deviations bigger than centimeter scale, the relative deviations can also be millimeter scale due to the common offset contained by the adjacent points p s and p s+5m . 


## Covariance Analysis

The track irregularity measurement accuracy can be presented by its variance. According to Equations (18) 


## Covariance Analysis

The track irregularity measurement accuracy can be presented by its variance. According to Equations (18) and (19), in order to calculate the variance of track irregularity, the covariances among calculate, we will firstly carry out the covariance analysis theoretically for the simplified situation by ignoring the system noises, and numerically for the general situation with system noises. Since the projections of the Earth angular velocity through the attitude errors are small and remain constant in short time interval, they can be equivalent to the gyro drifts. The terms of Coriolis acceleration are so small that they can also be ignored in a short time interval. Therefore, the system matrix can be further simplified as expressed in Equation (20) for the simplified situation [10]: 
A =                                             (20)
where g is the value of gravity. In addition, in order to simplify the solving process, we suppose that the railway track is a straight track in north direction without loss of generality. In these conditions, Equations (18) and (19) can be simplified as expressed by Equations (21) and (22):
∆ p s y = δr c p s y − δr c p s+5m y = δr n 0 p s E − δr n 0 p s+5m E + l 5m l c δr n 0 p 30m E − δr n 0 p 0m E(21)
∆ p s z = δr c p s z − δr c p s+5m z = δr n 0 p s D − δr n 0 p s+5m D + l 5m l c δr
n 0 p 30m D − δr n 0 p 0m D(22)
For a ZUPT-aided INS with landmark integration, the distribution of trolley stop points and position observations is crucial to ensure the surveying accuracy [5]. In general, higher-frequency observation updates will result in better accuracy. However higher-frequency observation means more stop points which will influence the work efficiency. Therefore, in this paper, the distance of two stop points is 60 m for measuring position and providing zero velocity, and the observation updates are only provided in the end of every 30 m chord interval as Figure 6 shows.

For the measurement of every 30 m interval, the observation updates are measured at the end time epoch. For the forward filtering process, the optimal estimate of error state vector and its covariance matrix at other time epochs with no observations can be expressed as the functions of initial values in continuous form as Equation (23) shows according to Equation (11) [13]:
x f (t) = Φ(t, 0)x f (0) P f (t) = Φ(t, 0)P f (0)Φ T (t, 0)(23)
where Φ(t, 0) is the system state transition matrix can be calculated as Equation (24) shows: 
Φ(t, 0) = e At =                                                 (24)
and the initial variance matrix can be expressed as Equation (25):
P(0) = diag p φ N p φ E p φ D p δv N p δv E p δv D p δr N p δr E p δr D p ε N p ε D p ∇ D(25)
When the observations update at time epoch T, the updated estimate of state vector and its covariance can be obtained by disperse Kalman filter as shown in Equation (26):
x + f N =x − f N + K N z N − H Nx − f N = Φ(T, 0)x f (0) + K N H N Φ(T, 0) x(0) −x f (0) + K N υ N P + f N = (I − K N H N )P − f N = (I − K N H N )Φ(T, 0)P f (0)Φ T (T, 0)(26)
For the backward smoothing process, the initial optimal smoothed estimate of state vector and its covariance arex(T) =x + f N and P(T) = P + f N . The optimal smoothed estimate and its covariance at arbitrarily time epoch t can be expressed in continuous form as Equation (27) shows:
x(t) = Φ(t, T)x(T) P(t) = Φ(t, T)P(T)Φ T (t, T)(27)
The error of the optimal smoothed estimate of state vector can be obtained by subtracting true value from its optimal smoothed estimate as Equation (28) shows:
δx(t) =x(t) − x(t) = Φ(t, T)x(T) − Φ(t, 0)x(0) = Φ(t, T) Φ(T, 0)x f (0) + K N H N Φ(T, 0) x(0) −x f (0) + K N υ N − Φ(t, 0)x(0) = Φ(t, 0)δx f (0) − Φ(t, T)K N H N Φ(T, 0)δx f (0) + Φ(t, T)K N υ N(28)
From Equation (28), we can get the position error δr  relationship is t s+5m = t s + l 5m l c T = t s + kT. Substituting δr n 0 p i E and δr n 0 p i D into Equations (21) and (22) respectively and calculating the variances of ∆ p s y and ∆ p s z , we can obtain:
φ N = p φ E = p φ , p δv N = p δv E = p δv D = p δv , p δr N = p δr E = p δr D = p δr , p ε N = p ε D = p ε , σ 2 v N = σ 2 v E = σ 2 v D = σ 2 v , σ 2 r N = σ 2 r E = σ 2 r D = σ 2 r , p δv = σ 2 v ,P ∆ ps y = E ∆ p s y ∆ T p s y = k 2 g 2 T 2 p φ σ 2 v (σ 2 r +9k 2 σ 2 v T 2 )(2ts−5kT) 2 4[σ 2 v σ 2 r +9k 2 (σ 4 v +2g 2 p φ σ 2 r )T 2 +162k 4 g 2 (pφσ 2 v +p ε σ 2 r )T 4 +1620k 6 g 2 p ε σ 2 v T 6 +2916k 8 g 4 p φ p ε T 8 ] + k 2 g 2 T 2 p ε σ 2 v (σ 2 r +9k 2 σ 2 v T 2 )(3t 2 s +3kTt s −35k 2 T 2 ) 2 36[σ 2 v σ 2 r +9k 2 (σ 4 v +2g 2 p φ σ 2 r )T 2 +162k 4 g 2 (pφσ 2 v +p ε σ 2 r )T 4 +1620k 6 g 2 p ε σ 2 v T 6 +2916k 8 g 4 p φ p ε T 8 ] + k 4 g 4 T 4 p φ p ε σ 2 r (3t 2 s −15kTt s +10k 2 T 2 ) 2 2[σ 2 v σ 2 r +9k 2 (σ 4 v +2g 2 p φ σ 2 r )T 2 +162k 4 g 2 (pφσ 2 v +p ε σ 2 r )T 4 +1620k 6 g 2 p ε σ 2 v T 6 +2916k 8 g 4 p φ p ε T 8 ] + 9k 6 g 4 T 6 p φ p ε σ 2 v (9t 4 −90kTt 3 s +321k 2 T 2 t 2 s −480k 3 T 3 t s +325k 4 T 4 ) 2[σ 2 v σ 2 r +9k 2 (σ 4 v +2g 2 p φ σ 2 r )T 2 +162k 4 g 2 (pφσ 2 v +p ε σ 2 r )T 4 +1620k 6 g 2 p ε σ 2 v T 6 +2916k 8 g 4 p φ p ε T 8 ](29)P ∆ ps z = E ∆ p s z ∆ T p s z = k 2 p ∇ D σ 2 v T 2 (5kT − 2t s ) 2 4 σ 2 v + 18k 2 p ∇ D T 2(30)
Calculating the partial derivatives about variables of Equations (29) and (30) respectively, we can
get ∂P ∆p s y ∂p φ ≥ 0, ∂P ∆p s y ∂p ε ≥ 0, ∂P ∆p s y ∂σ 2 r ≥ 0, ∂P ∆p s y ∂σ 2 v > 0 and ∂P ∆p s z ∂p ∇ D ≥ 0, ∂P ∆p s z ∂σ 2 v ≥ 0.
This means that the variances of alignment irregularity and level irregularity are monotone increasing functions. Only with variances about initial state errors and observations less than certain values can the measurements of track irregularity satisfy the surveying accuracy demands. According to Equation (30), the position error (p δr and σ 2 r ) has no effect on level irregularity. As a matter of fact, the influence of position error on the alignment irregularity is also so small than other error terms that can be ignored. When σ 2 r → ∞ which means that there is no position observation, the variance of alignment irregularity can be converted as Equation (31):
lim σ 2 r →∞ P ∆ ps y = k 2 g 2 T 2 p φ σ 2 v (2t s −5kT) 2 4(σ 2 v +18k 2 g 2 p φ T 2 +162k 4 g 2 p ε T 4 ) + k 2 g 2 T 2 p ε σ 2 v (3t 2 s +3kTt s −35k 2 T 2 ) 2 36(σ 2 v +18k 2 g 2 p φ T 2 +162k 4 g 2 p ε T 4 ) + k 4 g 4 T 4 p φ p ε (3t 2 s −15kTt s +10k 2 T 2 ) 2 2(σ 2 v +18k 2 g 2 p φ T 2 +162k 4 g 2 p ε T 4 )(31)
We can verify that the value of lim
σ 2 r →∞ P ∆ ps y − lim σ 2 r →0
P ∆ ps y is very small by a numerical method.

Consider that P ∆ ps y is a monotone increasing function of σ 2 r , it is feasible to implement track irregularity surveying tasks without position observations updating for the ZUPT-aided INS. As a result, the requirements of high precise landmarks are reduced at a large extent. The landmarks can be only used as a determination of the track segmentation that sub-decimeter scale can meet the demand. And they may be replaced by a sub-decimeter scale INS/odometer integration system in short time interval as well.

For the general situation, the system noises cannot be ignored and we carry out the covariance analysis in a numerical method. The measurement accuracy of alignment irregularity and level irregularity are related with the variances of initial error states, the accuracy of inertial sensors and the accuracy of observation update. Here, we suppose that the railway track is a straight track in the direction of north by east 45 degrees without loss of generality. The system matrix is the full form as Equation (7) shows without ignoring the projections of the Earth angular velocity through the attitude errors and the terms of Coriolis acceleration. Considering the previous analysis, we will only make use of the velocity observation to update the Kalman filter.

Firstly, we assess the influences of the observation accuracy on the irregularity measurement accuracy without position observation. Setting the tilt error to 0.006 • and the orientation error is 0.06 • . Setting the gyro bias instability to 0.01 • /h and ARW is 0.005 • / √ h, and setting the accelerometer bias instability to 50 µg and random noise is 10 µg/ √ Hz. The measurement accuracy is also affected by the measurement time of every interval or the velocity of the trolley. Shorter measurement time means less integral time of the errors, and will result in higher measurement accuracy. Here we set the trolley velocity to 1 m/s (8 km/h at most for track surveying trolley), and 30 s will be consumed for every 30 m distance interval. The relationship between railway track irregularities measurement accuracy and the velocity observation accuracy as well as initial position accuracy are illustrated in Figure 8.

only make use of the velocity observation to update the Kalman filter.

Firstly, we assess the influences of the observation accuracy on the irregularity measurement accuracy without position observation. Setting the tilt error to 0.006° and the orientation error is 0.06°. Setting the gyro bias instability to 0.01°/h and ARW is 0.005°√h ⁄ , and setting the accelerometer bias instability to 50 μg and random noise is 10 μg/√Hz. The measurement accuracy is also affected by the measurement time of every interval or the velocity of the trolley. Shorter measurement time means less integral time of the errors, and will result in higher measurement accuracy. Here we set the trolley velocity to 1 m/s (8 km/h at most for track surveying trolley), and 30 s will be consumed for every 30 m distance interval. The relationship between railway track irregularities measurement accuracy and the velocity observation accuracy as well as initial position accuracy are illustrated in Figure 8. According to Figure 8, under the supposed conditions above, the observation accuracy of velocity causes larger influences than the initial position error for the track irregularities measurement accuracy. The initial position error has no effect on the track irregularity, which is coincident with the theoretical analysis previously. In order to satisfy the relative accuracy demand of 1mm, the accuracy of velocity observation should be less than 0.15 mm/s and ZUPT can satisfy the accuracy demand of velocity. A higher level of inertial sensors than the system above should be employed to satisfy the high-speed railway accuracy demand of 0.5 mm.

Secondly, we assess the influence of the random noises of inertial sensors on the irregularity measurement accuracy. Setting the tilt error to 0.006° and the orientation error is 0.06°. Setting the gyro bias instability to 0.01°/h, the accelerometer bias instability is 50 μg. and setting the accuracy of According to Figure 8, under the supposed conditions above, the observation accuracy of velocity causes larger influences than the initial position error for the track irregularities measurement accuracy. The initial position error has no effect on the track irregularity, which is coincident with the theoretical analysis previously. In order to satisfy the relative accuracy demand of 1mm, the accuracy of velocity observation should be less than 0.15 mm/s and ZUPT can satisfy the accuracy demand of velocity. A higher level of inertial sensors than the system above should be employed to satisfy the high-speed railway accuracy demand of 0.5 mm.

Secondly, we assess the influence of the random noises of inertial sensors on the irregularity measurement accuracy. Setting the tilt error to 0.006 • and the orientation error is 0.06 • . Setting the gyro bias instability to 0.01 • /h, the accelerometer bias instability is 50 µg. and setting the accuracy of initial position to 10 cm the velocity observation is 0.1 mm/s. The relationship between track irregularities measurement accuracy and random noises of gyro and accelerometer are illustrated in Figure 9, where under the supposed conditions above, the ARW of gyro should less than 0.0071 • / √ h at most and random noise of accelerometer should less than 14.7 µg/ √ Hz at most to satisfy the demand accuracy of 1 mm both with and without position observation.

Thirdly, the influences of the tilt errors and orientation error on the irregularity measurement accuracy have been assessed. Other parameters are fixed as described values previously. The relationship between track irregularities measurement accuracy and attitude errors are illustrated in Figure 10.

As illustrated in Figure 10, the attitude errors have no effect on the level irregularity, which is coincident with the theoretical analysis as Equation (30) shows. Since the orientation error is much bigger, it has a larger effect on alignment irregularity than the tilt errors.

Finally, the influences of the equivalent biases of gyros and accelerometers on the irregularities measurement accuracy are assessed as illustrated in Figure 11. Other parameters are also fixed at the previously described values. 0.0071°√h ⁄ at most and random noise of accelerometer should less than 14.7 μg/√Hz at most to satisfy the demand accuracy of 1 mm both with and without position observation.

Thirdly, the influences of the tilt errors and orientation error on the irregularity measurement accuracy have been assessed. Other parameters are fixed as described values previously. The relationship between track irregularities measurement accuracy and attitude errors are illustrated in Figure 10. As illustrated in Figure 10, the attitude errors have no effect on the level irregularity, which is coincident with the theoretical analysis as Equation (30) shows. Since the orientation error is much bigger, it has a larger effect on alignment irregularity than the tilt errors.

Finally, the influences of the equivalent biases of gyros and accelerometers on the irregularities measurement accuracy are assessed as illustrated in Figure 11. Other parameters are also fixed at the previously described values. 0.0071°√h ⁄ at most and random noise of accelerometer should less than 14.7 μg/√Hz at most to satisfy the demand accuracy of 1 mm both with and without position observation.

Thirdly, the influences of the tilt errors and orientation error on the irregularity measurement accuracy have been assessed. Other parameters are fixed as described values previously. The relationship between track irregularities measurement accuracy and attitude errors are illustrated in Figure 10. As illustrated in Figure 10, the attitude errors have no effect on the level irregularity, which is coincident with the theoretical analysis as Equation (30) shows. Since the orientation error is much bigger, it has a larger effect on alignment irregularity than the tilt errors.

Finally, the influences of the equivalent biases of gyros and accelerometers on the irregularities measurement accuracy are assessed as illustrated in Figure 11. Other parameters are also fixed at the previously described values. As illustrated in Figure 11, the gyro biases have no effect on the level irregularity, which is coincident with the theoretical analysis as shown in Equation (30) and the influence of the accelerometer bias on the level irregularity is small. In addition, the accelerometer bias has no effect on the alignment irregularity as well as Equation (29) shows.


## Simulations and Experimental Results


### Simulations

Monte Carlo simulations of the alignment irregularity and level irregularity surveying accuracy for the proposed approach have been implemented based on the real random noises of  Figure 11. (a) The relationship between level irregularity measurement accuracy and the biases of inertial sensors; (b) The relationship between alignment irregularity measurement accuracy and the biases of inertial sensors.

As illustrated in Figure 11, the gyro biases have no effect on the level irregularity, which is coincident with the theoretical analysis as shown in Equation (30) and the influence of the accelerometer bias on the level irregularity is small. In addition, the accelerometer bias has no effect on the alignment irregularity as well as Equation (29) shows.


## Simulations and Experimental Results


### Simulations

Monte Carlo simulations of the alignment irregularity and level irregularity surveying accuracy for the proposed approach have been implemented based on the real random noises of INS. The simulated trajectory is a straight line in the direction of north by east 45 degrees. The random noises of gyros and accelerometers are measured by the mentioned INS in static state. The ARW of RLG gyro in this paper is about 0.005 • / √ h, and the bias instability is set to 0.01 • /h. The random noise of accelerometer is about 10 µg/ √ Hz, and the bias is set to 50 µg. According to the accuracy of the inertial sensor, the initial attitude errors are set to 0.006 • and the initial orientation error is set to 0.06 accelerometer bias on the level irregularity is small. In addition, the accelerometer bias has no effect on the alignment irregularity as well as Equation (29) shows.


## Simulations and Experimental Results


### Simulations

Monte Carlo simulations of the alignment irregularity and level irregularity surveying accuracy for the proposed approach have been implemented based on the real random noises of INS. The simulated trajectory is a straight line in the direction of north by east 45 degrees. The random noises of gyros and accelerometers are measured by the mentioned INS in static state. The ARW of RLG gyro in this paper is about 0.005°√h ⁄ , and the bias instability is set to 0.01°/h. The random noise of accelerometer is about 10 μg/√Hz, and the bias is set to 50 μg. According to the accuracy of the inertial sensor, the initial attitude errors are set to 0.006° and the initial orientation error is set to 0.06°. The position standard deviations are set to 10 cm, and 0.1 mm/s for the velocity observation. The high precise velocity observation can be provided by ZUPT technique. The velocity of the trolley is set to 1 m/s, and the length of the trajectory is set to 30 m. The observation updates are provided at the beginning and the end of the trajectory. We take the maximum value of track irregularity error to test the statistical accuracy. Five hundred groups of Monte Carlo simulation results based on ZUPT-aided INS approach without position observation are shown in Figure 12. According to Figure 12, the Root Mean Square (RMS) of measurement accuracy is about 0.70 mm for the level irregularity and 0.99 mm for the alignment irregularity. This is consistent to the result calculated by the covariance analysis previously. The results of Monte Carlo simulation based on ZUPT-aided INS approach with position observation are the same.


### Experimental Results

Real tests were carried out on an experimental railway line. The railway track is about 120 m long as shown in Figure 13. The absolute position is provided by a Leica optical total station with a high precision prism mounted on the trolley based on Control Points (CPIII) as shown in the figure.

At the beginning of the tests the trolley is put on the track for 15 min static initial alignment, and loading initial position measured by total station. Then pushing the trolley moves forward on the track at walking speed (about 1.5 m/s) and implementing the measurement of the track irregularities. Two different experiments have been carried out.

The first experiment is the comparison test of accuracy between the proposed approach and the total station. For this group of tests, the trolley stops at every 60 m distance interval and the velocity observation provided by ZUPT will be updated for the INS. The track irregularities measured by ZUPT-aided INS will compared with the measurements provided by total station. Since the high precise position measurements are measured by total station in every 3 m interval, the distance of two adjacent points calculating the irregularity in Equation (1) is chosen as 6 m. For 30 m chord, the deviation of measurement results between these two approaches is shown in Figure 14. As illustrated, the RMS of alignment irregularity is about 0.82 mm and level irregularity is 1.02 mm. The 3D spatial trajectories of first 60 m track segmentation measured by total station and ZUPT-aided INS are illustrated in Figure 14c. As shown in the figure, even though the absolute deviations between these two approaches are bigger, the relative deviations can still achieve millimeter scale. and loading initial position measured by total station. Then pushing the trolley moves forward on the track at walking speed (about 1.5 m/s) and implementing the measurement of the track irregularities. Two different experiments have been carried out.

The first experiment is the comparison test of accuracy between the proposed approach and the total station. For this group of tests, the trolley stops at every 60 m distance interval and the velocity observation provided by ZUPT will be updated for the INS. The track irregularities measured by ZUPT-aided INS will compared with the measurements provided by total station. Since the high precise position measurements are measured by total station in every 3 m interval, the distance of two adjacent points calculating the irregularity in Equation (1) is chosen as 6 m. For 30 m chord, the deviation of measurement results between these two approaches is shown in Figure  14. As illustrated, the RMS of alignment irregularity is about 0.82 mm and level irregularity is 1.02 mm. The 3D spatial trajectories of first 60 m track segmentation measured by total station and ZUPT-aided INS are illustrated in Figure 14c. As shown in the figure, even though the absolute deviations between these two approaches are bigger, the relative deviations can still achieve millimeter scale.  The second experiment is the repeatability test. For this experiment, six groups of measurements of the same track segment were carried out. Since the designed vector distance is unknown, we just calculate the difference of two points in 5 m intervals, namely   The second experiment is the repeatability test. For this experiment, six groups of measurements of the same track segment were carried out. Since the designed vector distance is unknown, we just calculate the difference of two points in 5 m intervals, namely d s − d s+5m to estimate the repeatability of track irregularity. The comparison of track irregularity sequences obtained by ZUPT-aided INS in six runs is illustrated in Figure 15. As shown in the figure, the distance of two adjacent sample points is 0.5 m and only the track irregularities of the first 30 m chord are plotted in the figure. (b) Alignment irregularity deviation for 30 m chord between ZUPT-aided INS and total station; (c) 3D spatial trajectory of 60 m track segmentation measured by ZUPT-aided INS and total station The second experiment is the repeatability test. For this experiment, six groups of measurements of the same track segment were carried out. Since the designed vector distance is unknown, we just calculate the difference of two points in 5 m intervals, namely The irregularity differences at the same railway track points between different runs indicate the repeatability of the measurement. The results of statistic deviation of alignment and level irregularities are listed in Table 1. As Table 1 shows, the standard deviations of differences in The irregularity differences at the same railway track points between different runs indicate the repeatability of the measurement. The results of statistic deviation of alignment and level irregularities are listed in Table 1. As Table 1 shows, the standard deviations of differences in alignment irregularity and level irregularity are approximately 1mm, which is consistent with the theoretical analysis as well as the simulation results. 


## Conclusions

The measurement of railway track irregularity plays a significant role in monitoring the track deformation and guiding the maintenance of railway lines. This paper makes use of the ZUPT-aided INS for the track irregularity measuring applications. The RTS smoothing algorithm is employed to improve the performance of the surveying system.

The calculation equations of the track irregularity parameter from absolute positions have been deduced in the paper. Based on covariance analysis, the analytical relationships between the track irregularity with the drifts of inertial sensors, the accuracy of attitude and the accuracy of velocity observations as well as the accuracy of initial position are established. The theoretical analysis and numerical analysis show that the position observation of the Kalman filter has no effect on the measurement accuracy of the alignment irregularity and level irregularity, and we can implement track relative geometry surveying based on ZUPT-aided INS without position observation updates. The landmarks can be only used to determine track segmentation, sub-decimeter scale accuracy of which can satisfy the track surveying demand.

Simulations and experimental results show that the relative accuracy for 30 m chord of the proposed approach for track irregularity surveying can reach approximately 1 mm (1σ) with gyro bias instability of 0.01 • /h, random walk noise of 0.005 • / √ h and accelerometer bias instability of 50 µg, random noise of 10 µg/ √ Hz, while only velocity observations are provided by the ZUPT technique in about every 60 m interval. This accuracy can meet the most stringent requirements of the track irregularity surveying for railway lines. For higher accuracy demand of irregularity surveying, the higher level of inertial sensors than that of this paper should be employed.

This paper proposes a relative geometry parameter measuring approach for the railway track. It reduces the requirement of high precision landmarks significantly and lightens the maintenance burden of control points to a large extent. In addition, it also can improve the work efficiency of railway track irregularity measurement task.

## Figure 1 .
1Track coordinate system and geometry parameters.

## Figure 1 .
12, the red curve represents a segmentation of railway track in 3-dimensional space; the other two curves are the projections in horizontal plane and vertical plane respectively. The 30 m long chord is determined by points 0m p and 30m p on the curve. Take the point s p on the curve as an example. The distance from s p to the chord is the vector distance of this point represented by s d . Vector distance of the next Track coordinate system and geometry parameters.

## Figure 2 .
2Vector distances of two points with 5 m interval on a 3D curve for 30 m chord.

## Figure 3 .
3The track irregularity measurement system and its configuration diagram.

## Figure 2 .
2Vector distances of two points with 5 m interval on a 3D curve for 30 m chord.

## Figure 2 .
2Vector distances of two points with 5 m interval on a 3D curve for 30 m chord.

## Figure 3 .
3The track irregularity measurement system and its configuration diagram.

## Figure 3 .
3The track irregularity measurement system and its configuration diagram.

## Figure 4 .
4Block diagram of the filtering and smoothing algorithm.

## C
represents the direction cosine matrix. n in ω represents the turn rate of the navigation frame with respect to the inertial frame expressed in the n-frame. It can be obtained by summing the Earth's rotation rate with respect to the inertial frame and the turn rate of the navigation frame with respect to the Earth as:δ ω represents the drift errors of gyroscopes. δ v n is the vector of velocity errors. f n represents the specific force in navigation axes. δf b is the drift errors of accelerometers. δ r n represents the position error in navigation axes. The errors of inertial sensors in this paper are normally modeled as piecewise constant values. The position coordinates of the measured track are expressed in segmentation with 0 n -frame, which is so near with the n 30 m chord) track irregularity surveying, the track segmentation is set to be 60 m long in this paper. Moreover b ib

## Figure 4 .
4Block diagram of the filtering and smoothing algorithm.

## Figure 5 .
5The RTS smoothing algorithm computational process.

## Figure 6 .
6d is the vector distance from s p to the chord, projections of which in horizontal plane and vertical plane are alignment and level, respectively. (a) Track segmentation and the 30m chord; (b) Alignment and level calculated from the navigation coordinate.

## Figure 6 .
6level and they can be calculated by Equation(14): (a) Track segmentation and the 30m chord; (b) Alignment and level calculated from the navigation coordinate.


a sin θ a 0 − sin θ a cos θ θ l cos θ a cos θ l sin θ a − sin θ l − sin θ a cos θ a 0 sin θ l cos θ a sin θ l sin θ a cos θ

## ∂∂
sin θ a δ sin θ a + ∂r c ps z ∂ cos θ a δ cos θ a + cos θ l δ cos θ l

## ∆p
p s z = δr c p s z − δr c p s+5m z ≈ δr n 0 p s D − δr n 0 30m D − δr n 0 p 0m D

## Sensors 2017 ,Figure 7 .
2017717The relationship between absolute deviation and relative deviation.


and (19), in order to calculate the variance of track irregularity, the covariances among i 0 m,s,s 5m,30 m = + ) should be calculated. However, the analytical solutions of the Riccati equation and the state vector of the filtering and smoothing system are difficult to calculate, we will firstly carry out the covariance analysis theoretically for the simplified situation by ignoring the system noises, and numerically for the general situation with system

## Figure 7 .
7The relationship between absolute deviation and relative deviation.


D (i = 0 m, s, s + 5 m, 30 m) should be calculated. However, the analytical solutions of the Riccati equation and the state vector of the filtering and smoothing system are difficult to


expressed by the initial errors of state vector by setting the corresponding time. Setting p


and p δr = σ 2 r . The time of points p s and p s+5m are represented by t s and t s+5m , and their

## Figure 8 .
8(a) The relationship between level irregularity and accuracy of velocity observation as well as initial position; (b) The relationship between alignment irregularity accuracy and accuracy of velocity observation as well as initial position.

## Figure 8 .
8(a) The relationship between level irregularity and accuracy of velocity observation as well as initial position; (b) The relationship between alignment irregularity accuracy and accuracy of velocity observation as well as initial position.

## Figure 9 .Figure 10 .
910(a) The relationship between level irregularity measurement accuracy and noises of gyro and accelerometer; (b) The relationship between alignment irregularity measurement accuracy and noises of gyro and accelerometer. (a) The relationship between level irregularity measurement accuracy and attitude errors; (b) The relationship between alignment irregularity measurement accuracy and attitude errors.

## Figure 9 .
9(a) The relationship between level irregularity measurement accuracy and noises of gyro and accelerometer; (b) The relationship between alignment irregularity measurement accuracy and noises of gyro and accelerometer.

## Figure 9 .Figure 10 .
910(a) The relationship between level irregularity measurement accuracy and noises of gyro and accelerometer; (b) The relationship between alignment irregularity measurement accuracy and noises of gyro and accelerometer. (a) The relationship between level irregularity measurement accuracy and attitude errors; (b) The relationship between alignment irregularity measurement accuracy and attitude errors.

## Figure 10 .Figure 11 .
1011(a) The relationship between level irregularity measurement accuracy and attitude errors; (b) The relationship between alignment irregularity measurement accuracy and attitude errors.Sensors 2017, 17, (a) The relationship between level irregularity measurement accuracy and the biases of inertial sensors; (b) The relationship between alignment irregularity measurement accuracy and the biases of inertial sensors.


• . The position standard deviations are set to 10 cm, and 0.1 mm/s for the velocity observation. The high precise velocity observation can be provided by ZUPT technique. The velocity of the trolley is set to 1 m/s, and the length of the trajectory is set to 30 m. The observation updates are provided at the beginning and the end of the trajectory. We take the maximum value of track irregularity error to test the statistical accuracy. Five hundred groups of Monte Carlo simulation results based on ZUPT-aided INS approach without position observation are shown in Figure 12.

## Figure 12 .Figure 12 .
1212(a) The distribution of level irregularity measurement accuracy; (b) The distribution of alignment irregularity measurement accuracy. (a) The distribution of level irregularity measurement accuracy; (b) The distribution of alignment irregularity measurement accuracy.

## Figure 13 .
13The experimental railway line and the measurement system.

## Figure 13 .Figure 14 .
1314The experimental railway line and the measurement system.Sensors 2017, 17, (a) Level irregularity deviation for 30 m chord between ZUPT-aided INS and total station; (b) Alignment irregularity deviation for 30 m chord between ZUPT-aided INS and total station; (c) 3D spatial trajectory of 60 m track segmentation measured by ZUPT-aided INS and total station


the repeatability of track irregularity. The comparison of track irregularity sequences obtained by ZUPT-aided INS in six runs is illustrated in Figure 15. As shown in the figure, the distance of two adjacent sample points is 0.5 m and only the track irregularities of the first 30 m chord are plotted in the figure.

## Figure 14 .
14(a) Level irregularity deviation for 30 m chord between ZUPT-aided INS and total station; (b) Alignment irregularity deviation for 30 m chord between ZUPT-aided INS and total station; (c) 3D spatial trajectory of 60 m track segmentation measured by ZUPT-aided INS and total station.

## Figure 15 .
15repeatability of track irregularity. The comparison of track irregularity sequences obtained by ZUPT-aided INS in six runs is illustrated in Figure 15. As shown in the figure, the distance of two adjacent sample points is 0.5 m and only the track irregularities of the first 30 m chord are plotted in the figure. (a) Level irregularity measurement repeatability for 30 m chord; (b) Alignment irregularity measurement repeatability for 30 m chord.

## Figure 15 .
15(a) Level irregularity measurement repeatability for 30 m chord; (b) Alignment irregularity measurement repeatability for 30 m chord.


represents its covariance matrix. k H is the measurement matrix. k K is the gain matrix of forward Kalman filter at epoch k. k Φ is the system state transition matrix which can be calculated by matrix A .The backward smoother can be expressed in the discrete form as shown by Equation (12)[13,14]:1 
fk 

− 
+ 

x 

is the optimal predicted estimate and 

1 
fk 

P − 

+ 

( ) 

1 

1 

1 
1 

1 
1ˆ,ˆˆ+ 




arbitrary point on the trajectory for this chord, coordinates of which are marked asT 
n 
p 
p N 
p E 
p D 

r 
r 
r 
and 

0 

30 
30 
30 
30 

 
 
=  
 
r 

m 
m 
m 
m 

T 
n 
p 
p N 
p E 
p D 

r 
r 
r 
. The measurement values of their coordinates are marked as 

0 

0 
0 
0 
0 

 
 
=  
 
r  
 
 
 

m 
m 
m 
m 

T 
n 
p 
p N 
p E 
p D 

r 
r 
r 
and 

0 

30 
30 
30 
30 

 
 
=  
 
r  
 
 
 

m 
m 
m 
m 

T 
n 
p 
p N 
p E 
p D 

r 
r 
r 
respectively. 

s 

p 
represents an 

0 

 
 
=  
 
r 

s 
s 
s 
s 

T 
n 
p 
pN 
pE 
pD 

r 
r 
r 
for the true value and 0  
 
=  
 
r  
 
 
 

s 
s 
s 
s 

T 
n 
p 
pN 
pE 
pD 

r 
r 
r 
for the measurement value. 



## Table 1 .
1Statistic of alignment irregularity and level irregularity differences.Note: Gij represents the difference between group i and group j.NO. 
Alignment Irregularity (mm) 
Level Irregularity (mm) 

Max 
Mean 
Std 
Max 
Mean 
Std 

G12 
3.075 
−0.028 
1.006 
3.854 
−0.221 
1.296 
G13 
1.164 
0.012 
0.445 
3.005 
−0.131 
1.147 
G14 
1.617 
−0.032 
0.783 
2.954 
−0.077 
1.082 
G15 
2.184 
−0.088 
0.677 
2.767 
−0.103 
0.772 
G16 
1.403 
−0.054 
0.527 
2.667 
−0.071 
1.123 
G23 
3.034 
0.040 
1.037 
2.248 
0.089 
1.062 
G24 
1.799 
−0.004 
0.542 
2.250 
0.144 
0.842 
G25 
1.340 
−0.060 
0.654 
2.579 
0.118 
1.161 
G26 
1.987 
−0.026 
0.887 
2.795 
0.150 
1.256 
G34 
1.900 
−0.044 
0.821 
2.192 
0.054 
1.097 
G35 
2.143 
−0.099 
0.707 
2.662 
0.028 
1.104 
G36 
1.361 
−0.066 
0.524 
3.021 
0.060 
1.048 
G45 
1.485 
−0.056 
0.550 
2.947 
−0.026 
0.914 
G46 
2.029 
−0.022 
0.737 
3.626 
0.006 
1.246 
G56 
1.085 
0.034 
0.534 
2.960 
0.032 
1.225 


© 2017 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (http://creativecommons.org/licenses/by/4.0/).
Acknowledgments:This work was supported by Program for New Century Excellent Talents in University (NCET) of China.According to Equation (15), the differential of sin θ a and cos θ a in Equation (A1) can be derived by Equation (A2): The partial derivative items of Equation (A2) can be expressed as shown by Equations (A3) and (A4):Combining Equations (A2) and (A4) and rearranging yields Equation(A5):Combining Equations (1), (A1) and (A5) and rearranging we can obtain the Equation (A6):Considering the small gradient and the large turning radius of the railway track Equation (A6) can be simplified as Equation(18)According to Equation (15), the differential of sin θ l and cos θ l in Equation (A6) can be derived by Equation (A8): The partial derivative items of Equation (A8) can be expressed as Equations (A9) and (A10) show: Similarly, Equation (A12) can be simplified as Equation(19)by ignoring the small terms.
Master's Thesis, Division of Geodesy and Geoinformatics. A Engstrand, Stockholm, SwedenRoyal Institute of TechnologyRailway Surveying-A Case Study of the GRP 5000Engstrand, A. Railway Surveying-A Case Study of the GRP 5000. Master's Thesis, Division of Geodesy and Geoinformatics, Royal Institute of Technology, Stockholm, Sweden, 2011.

Kinematic Track Surveying by Means of a Multisensory Platform. R Glaus, Swiss Federal Institute of Technology Zurich, ETH, Zurich, SwitzerlandPh.D. ThesisGlaus, R. Kinematic Track Surveying by Means of a Multisensory Platform. Ph.D. Thesis, Swiss Federal Institute of Technology Zurich, ETH, Zurich, Switzerland, 2006.

Railway track irregularity measuring by GNSS/INS integration. Q Chen, X Niu, Q Zhang, Y Cheng, 10.1002/navi.78Navig. J. Inst. Navig. 62Chen, Q.; Niu, X.; Zhang, Q.; Cheng, Y. Railway track irregularity measuring by GNSS/INS integration. Navig. J. Inst. Navig 2015, 62, 83-93. [CrossRef]

Measurement of Line Characteristics and Track Irregularities by Means of DGPS and INS. T Luck, P Meinke, B Eisfeller, C Kreye, J Stephanides, Proceedings of the International Symposium on Kinematic Systems in Geodesy, Geomatics and Navigation. the International Symposium on Kinematic Systems in Geodesy, Geomatics and NavigationBanff, AB, CanadaLuck, T.; Meinke, P.; Eisfeller, B.; Kreye, C.; Stephanides, J. Measurement of Line Characteristics and Track Irregularities by Means of DGPS and INS. In Proceedings of the International Symposium on Kinematic Systems in Geodesy, Geomatics and Navigation, Banff, AB, Canada, 5-8 June 2001.

Laser-Aided INS and Odometer Navigation System for Subway Track Irregularity Measurement. Q Li, Z Chen, Q Hu, L Zhang, 10.1061/(ASCE)SU.1943-5428.0000236J. Surv. Eng. 143Li, Q.; Chen, Z.; Hu, Q.; Zhang, L. Laser-Aided INS and Odometer Navigation System for Subway Track Irregularity Measurement. J. Surv. Eng. 2017, 143, 04017014. [CrossRef]

A new filtering and smoothing algorithm for railway track surveying based on landmark and IMU/odometer. Q Jiang, W Wu, M Jiang, Y Li, 10.3390/s17061438172083Jiang, Q.; Wu, W.; Jiang, M.; Li, Y. A new filtering and smoothing algorithm for railway track surveying based on landmark and IMU/odometer. Sensors 2017, 17, 1438. [CrossRef] [PubMed] Sensors 2017, 17, 2083

Road and track irregularities: Measurement, assessment and simulation. A Haigermoser, B Luber, J Rauh, 10.1080/00423114.2015.1037312Veh. Syst. Dyn. 53Haigermoser, A.; Luber, B.; Rauh, J. Road and track irregularities: Measurement, assessment and simulation. Veh. Syst. Dyn. 2015, 53, 878-957. [CrossRef]

Inspecting Instruments for Railway Track. Tb/T, China Railway Publishing HouseBeijing, ChinaTB/T 3147-2012. Inspecting Instruments for Railway Track; China Railway Publishing House: Beijing, China, 2012.

Railway Track Geometry: A Framework to Optimally Evaluate Track Condition and Assess Maintenance Needs Based on Vehicle Response. D Tamparas, Rotterdam, The NetherlandsCivil Engineering and Geosciences, Delft University of TechnologyMaster's ThesisTamparas, D. Railway Track Geometry: A Framework to Optimally Evaluate Track Condition and Assess Maintenance Needs Based on Vehicle Response. Master's Thesis, Civil Engineering and Geosciences, Delft University of Technology, Rotterdam, The Netherlands, 2016.

Strapdown Inertial Navigation Technology. D H Titterton, J L Weston, The Institution of Electrical Engineers. London, UK2nd edTitterton, D.H.; Weston, J.L. Strapdown Inertial Navigation Technology, 2nd ed.; The Institution of Electrical Engineers: London, UK, 2004.

Improving the Inertial Navigation System (INS) Error Model for INS and INS/DGPS Applications. S Nassar, Calgary, AB, CanadaDepartment of Geomatics Engineering, University of CalgaryPh.D. ThesisNassar, S. Improving the Inertial Navigation System (INS) Error Model for INS and INS/DGPS Applications. Ph.D. Thesis, Department of Geomatics Engineering, University of Calgary, Calgary, AB, Canada, 2003.

Accurate Pipeline Surveying Using Two-Filter Optimal Smoothing of Inertial Navigation Data Augmented with Velocity and Coordinate Updates. H Liu, S Nassar, N El-Sheimy, Proceedings of the 2010 International Technical Meeting of the Institute of Navigation. the 2010 International Technical Meeting of the Institute of NavigationSan Diego, CA, USALiu, H.; Nassar, S.; El-Sheimy, N. Accurate Pipeline Surveying Using Two-Filter Optimal Smoothing of Inertial Navigation Data Augmented with Velocity and Coordinate Updates. In Proceedings of the 2010 International Technical Meeting of the Institute of Navigation, San Diego, CA, USA, 25-27 January 2010; pp. 49-56.

Optimal Estimation of Dynamic Systems. J L Crassidis, J L Junkins, Chapman and Hall/CRCBoca Raton, FL, USA2nd edCrassidis, J.L.; Junkins, J.L. Optimal Estimation of Dynamic Systems, 2nd ed.; Chapman and Hall/CRC: Boca Raton, FL, USA, 2011.

Principles of GNSS, Inertial, and Multisensor Integrated Navigation Systems. P D Groves, Artech HouseNorwood, MA, USA2nd ed.Groves, P.D. Principles of GNSS, Inertial, and Multisensor Integrated Navigation Systems, 2nd ed.; Artech House: Norwood, MA, USA, 2013.