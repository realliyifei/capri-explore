# A Review of First-Passage Theory for the Segerdahl Risk Process and Extensions

CorpusID: 232257750
 
tags: #Mathematics, #Economics

URL: [https://www.semanticscholar.org/paper/98266dff7d1304b438bccb5404d42bdc737015d8](https://www.semanticscholar.org/paper/98266dff7d1304b438bccb5404d42bdc737015d8)
 
| Is Survey?        | Result          |
| ----------------- | --------------- |
| By Classifier     | False |
| By Annotator      | (Not Annotated) |

---

A Review of First-Passage Theory for the Segerdahl Risk Process and Extensions
16 Mar 2021 March 18, 2021

Florin Avram 
Jose-Luis Perez-Garmendia 
A Review of First-Passage Theory for the Segerdahl Risk Process and Extensions
16 Mar 2021 March 18, 2021Segerdahl processaffine coefficientsfirst passagespectrally negative Markov processscale functionshypergeometric functions
The Segerdahl process(Segerdahl (1955)), characterized by exponential claims and affine drift, has drawn a considerable amount of interest-see, for example,(Tichy (1984);Avram and Usabel (2008);Albrecher et al. (2013); Marciniak and Palmowski (2016)), due to its economic interest (it is the simplest risk process which takes into account the effect of interest rates). See (Albrecher and Asmussen 2010, Chapter 8) for an excellent overview, including extensions to processes with state dependent drift. It is also the simplest non-Lévy, non-diffusion example of a spectrally negative Markov risk model. Note that for both spectrally negative Lévy and diffusion processes, first passage theories which are based on identifying two "basic" monotone harmonic functions/martingales have been developed. This means that for these processes many control problems involving dividends, capital injections, etc., may be solved explicitly once the two basic functions have been obtained. Furthermore, extensions to general spectrally negative Markov processes are possible (Landriault et al. (2017), Avram et al. (2018); Avram and Goreac (2019); Avram et al. (2019b)). Unfortunately, methods for computing the basic functions are still lacking outside the Lévy and diffusion classes, with the notable exception of the Segerdahl process, for which the ruin probability has been computed (Paulsen andGjessing (1997). As a consequence, the W scale function may be computed as well, via simple probability arguments which apply a priori to all processes with exponential jumps (and may be extended to phase-type jumps as well). Further work going beyond exponential jumps and linear drifts has been provided in provided in (Avram and Usabel(2008))and(Czarna et al. (2017)), respectively. However, there is a striking lack of numerical results in both cases. This motivated us to review these approaches, with the purpose of drawing attention to connections between them, and underlining open problems.1 See [Iva13] for a nice exposition of killing. 2 The fact that the survival probability has the multiplicative structure (4) is equivalent to the absence of positive jumps, by the strong Markov property; this is the famous "gambler's winning" formula[Kyp14].3 ν q may be more useful than W q in the spectrally negative Markov framework [AG19].

# Introduction and Brief Review of First Passage Theory for Spectrally Negative Markov Processes

To set the stage for our topic and future research, consider a spectrally negative jump diffusion on a filtered probability space (Ω, {F t } t≥0 , P ), which satisfies the SDE:
dX t = c(X t )dt + σ(X t )dB t − dJ t , J t = N λ (t) i=1 C i , ∀X t > 0
(1) and is absorbed when leaving a half line (l, ∞). § Here, C i are nonnegative i.i.d. random variables with distribution measure F C (dz) and finite mean, B t is an independent standard Brownian motion, σ(x) > 0, c(x) > 0, ∀x > l, N λ (t) is an independent Poisson process of intensity λ. The functions c(x), v(x) := σ 2 (x) 2 and Π(dz) = λF C (dz) are referred to as the Lévy -Khinchine characteristics of X t .

Note that we assume that all jumps go in the same direction and have constant intensity so that we can take advantage of potential simplifications of the first passage theory in this case. See [Pau10] and [AA10, Chapter 8] for further information on risk processes with state dependent drift, and in particular the two pages of historical notes and references in the last reference.

The Segerdahl process is the simplest example outside the spectrally negative Lévy and diffusion classes. It is obtained by assuming v(x) = 0 in (1), and C k to be exponential i.i.d random variables with density f (x) = µe −µx -see [Seg55] for the case c(x) = c + rx, r > 0, c ≥ 0, and see also [Tic84] for nonlinear c(x). The Segerdahl process satisfies thus the SDE
dX t = (c + rX t ) dt − d Nt i=1 C i , r > 0, c ≥ 0.
It is given explicitly by X t = X 0 + r t 0 X s ds + K t , ⇔ X t = X 0 e rt + e rt t 0 e −rs dK s , with K t = ct − Nt i=1 C i being a Cramér-Lundberg process, whose Laplace exponent is
κ(θ) := 1 t log E[e θKt ] = cθ + λ( µ µ + θ − 1).
Remark 1. An essential point for the Segerdahl process is the fact that the point − c r is an absolute ruin level, in the sense that after a jump below this point, the process will never cross back. We may assume w.l.o.g. that the absolute ruin level is 0, or, equivalently, that c = 0.

First passage theory concerns the first passage times above and below fixed levels. For any process (X t ) t≥0 , these are defined by T b,+ = T X b,+ = inf{t ≥ 0 : X t > b}, T a,− = T X a,− = inf{t ≥ 0 : X t < a},

with inf ∅ = +∞, and the upper script X typically omitted. Since a is typically fixed below, we will often write for simplicity T instead of T a,− . First passage times are important in the control of reserves/risk processes. The rough idea is that when below low levels a, reserves processes should be replenished at some cost, and when above high levels b, they should be partly invested to yield income-see, for example, the comprehensive textbook [AA10].

The most important first passage functions are the two-sided upward and downward exit functions from a bounded interval [a, b], defined respectively by where e q is an independent exponential random variable of rate q. We will call them (killed) survival and ruin probabilities, respectively 1 , but the qualifier killed will be usually dropped below. The absence of killing will be indicated by omitting the subindex q. Note that in the context of potential theory, (3) are called equilibrium potentials [BG07] (of the capacitors {b, a} and {a, b}). Beyond ruin probabilities : scale functions, dividends, capital gains, etc. Recall that for "completely asymmetric Lévy " processes, with jumps going all in the same direction, a large variety of first passage problems may be reduced to the computation of the two monotone "scale functions" W q , Z q -see, for example , [Sup76, Ber97, Ber98, AKP04, APP07, APP15, APY16, IP12, AIZ16, LZ17, LP16,AZ17], and see [AGVA17] for a recent compilation of more than 20 laws expressed in terms of W q , Z q .

For example, for spectrally negative Lévy processes, the killed survival probability has a well known simple factorization 2 :
Ψ b q (x, a) = Wq(x−a) Wq(b−a) .(4)
For a second example, the [dF57] discounted dividends fixed barrier objective for spectrally negative Lévy processes has a simple expression in terms of either the W q scale function or of its logarithmic derivative ν q =
W ′ q Wq [APP07]. 3 V b (x) = Wq(x) W ′ q (b) = e − b x νq(m)dm 1 νq(b) 0 ≤ x ≤ b V b (x) = x − b + V b (b) x > b .(5)
Maximizing over the reflecting barrier b is simply achieved by finding the roots of
W ′′ q (b) = 0 ⇔ ∂ ∂b 1 ν q (b) = ∂ ∂b V b (b) = 1.(6)
Since results for spectrally negative Lévy processes (like the de Finetti problem mentioned above) require often not much more than the strong Markov property, it is natural to attempt to extend them to the spectrally negative strong Markov case. As expected, everything worked out almost smoothly for "Lévy -type cases" like random walks [AV17], Markov additive processes [IP12], etc. Recently, it was discovered that W, Z formulas continue to hold a priori for spectrally negative Markov processes [LLZ17], [ALL18]. The main difference is that in equations like (4), W q (x − a) must be replaced by a two-variable function W q (x, a) (which reduces in the Lévy case to W q (x, y) = W q (x − y), with W q being the scale function of the Lévy process). The same holds of course for the second scale function Z q,θ (x − a) [APP15,IP12]. This unifying structure has lead to recent progress for the optimal dividends problem for spectrally negative Markov processes -see [AG19]; however, as of today, we are not aware of other results on the control of the process (1) which have succeeded to exploit the W, Z formalism.

Several approaches may allow handling particular cases of spectrally negative Markov processes:

1. for the Segerdahl process, the direct IDE solving approach is successful for computing the ruin probability -see ( [PG97]) and Theorem 1, Section 3.

2. for Lévy driven Langevin-type processes, renewal equations have been provided in [CPRY17] -see Section 4.

3. for processes with operators having affine drift and volatility, an explicit integrating factor for the Laplace transform may be found in [AU08]-see Section 5.

4. with phase-type jumps, there is Asmussen's embedding into a regime switching diffusion [Asm95]-see Section 7, and the complex integral representations of [JJ07].

We will review and complete here the first approach, and also review and discuss the second and third approaches. Asmussen's approach is also recalled, because we believe it has considerable potential.

We end this introduction with an example of a still open problem we would like to solve in the future:

Problem 1. Find the optimal dividend policy for the Segerdahl process in the presence of capital injections and bankruptcy (in particular, investigate the extensions of Equations (5) and (6)).

Contents. Section 2 explains the simplicity of spectrally negative Markov processes with negative exponential and phase-type jumps, already sketched in [ALL18].

Section 3 reviews the direct classic Kolmogorov approach for solving first passage problems. The discounted ruin probability (q > 0) (25) for the Segerdahl process is obtained, following [PG97], by transforming the renewal equation (15) into the ODE (16), which is hypergeometric of order 2. 4 We also complete the study of this process by providing its W scale function, using the results in section 2.

Section 4 reviews the recent approach based on renewal equations due to [CPRY17] (which needs still be justified for increasing premiums satisfying (32)). An important renewal (Equation (35)) for the "scale derivative" w is recalled here, and a new result relating the scale derivative to the integrating factor defined in (40) is offered-see Theorem 4.

Section 5 reviews older computations of [AU08] for more general processes with affine operator, and provides explicit formulas for the Laplace transforms of the survival and ruin probability (48), in terms of the same integrating factor (40) and its antiderivative.

Section 6 checks that our integrating factor approach recovers various results for Segerdahl's process, when q = 0 or x = 0.

Section 7 reviews Asmussen's approach for solving first passage problems with phasetype jumps, and illustrates the simple structure of the survival and ruin probability of the Segerdahl-Tichy process, in terms of the scale derivative w. This approach yields quasi-explicit results when q = 0.

Section 8 reviews necessary hypergeometric identities (used in section 3). Finally, Section 9 outlines further promising directions of research.

2 Two-sided first passage probabilities for spectrally negative Markov processes with negative exponential and phase-type jumps reduce to computing two one sided first passage functions H q , Ψ q Remark 2. The results in this section apply a priori to a large class of spectrally negative Markov processes (1) with negative exponential jumps, and are formulated as such. In particular, Brownian motion may be present, and hence creeping downwards is possible.

Our study of spectrally negative Markov processes with negative exponential jumps is based on an increasing q-harmonic function of our process H q (x), l ≤ x satisfying (7), and a decreasing one Ψ q (x, a), x ≥ a, defined in (3). For the Segerdahl process, these functions, to be denoted by K 1 (x), K 2 (x), x ≥ 0, turn out to be related to the increasing and decreasing Kummer hypergeometric functions M and U , respectively. Note that K 1 (0) = 0, which renders (7) immediate. Subsequently, other useful functions like W q (x, a), Z q (x, a) will be identified by simple probability arguments which apply a priori to all processes with exponential jumps, and may be extended to phase-type jumpssee Lammas 1,2. With W and Z computed, one may hope to solve complicated control problems involving dividends and capital injections, by applying similar arguments as in the Lévy case.

Our first step is to investigate the existence of a factorization formula for two-sided first passage probabilities upwards, with lower limit at the boundary domain l:
Ψ b q (x, l) = E x e −qT b,+ ; T b,+ ≤ T l,− := W q (x, l − ) W q (b, l − ) := H q (x) H q (b) , l ≤ x ≤ b,(7)
which defines the function H q , up to a multiplicative constant, and up to the existence of the limits when x → l − (the latter is a delicate point which must be resolved separately in each particular case). The existence of such a function H is suggested by spectral negativity and the strong Markov property. To emphasize that this property holds a priori outside the Lévy framework, we provide a justification, based on the trick of adding a point c > b, and starting with
Ψ c q (x, l) = Ψ b q (x, l)Ψ c q (b, l),
where only the absence of positive jumps and the strong Markov property were used. Therefore,
Ψ b q (x, l) = Ψ c q (x, l) Ψ c q (b, l)
; So, the quotient decomposition is trivial as long as we stay on a fixed interval [0, c], with c arbitrarily big.

In the Lévy case, the dependence on l cancels, and H q (x) = e Φqx , where Φ q is the unique nonnegative root of the Cramèr-Lundberg equation. For diffusions, H q (x) is the increasing solution of the Sturm Liouville equation (G − q)f (x) = 0 (see for example [BS12]). In the general state dependent case, to provide a factorization independent of c, it suffices to obtain an increasing q-harmonic function of our process H q (x), l ≤ x satisfying H q (0) = 0, as is the case with the Segerdahl process; Doob's optional stopping theorem yields then the factorization.

When the claims are exponential, computing two-sided exit first passage probabilities on [a, b], a ≥ l, may be reduced to computing H q (x), x ≥ l, and the first passage ruin probabilities Ψ(x, a), cf. [ALL18].

Lemma 1. Let Ψ q,J (x, a), Ψ q,C (x, a) denote the killed ruin probabilities by jump and by creeping, respectively (more precisely Laplace transforms , but Laplace transforms are just ruin probabilities with respect to a process where the inter-arrivals are killed-see [Iva13] for generalizations and applications to risk theory). For the process (1) with negative exponential jumps, no upward jumps and a > l, it holds that
Ψ b q (x, a) = H q (x) − Ψ q,C (x, a)H q (a) − Ψ q,J (x, a) a−l 0 µe −µy H q (a − y)dy H q (b) − Ψ q,C (b, a)H q (a) − Ψ q,J (b, a) a−l 0 µe −µy H q (a − y)dy := W q (x, a) W q (b, a) . (8) Also Ψ b q (x, a, dy) = E x e −qT a,− 1 T a,− <T b,+ ,a−X T a,− ∈dy = Ψ q (x, a, dy) − Ψ b q (x, a)Ψ q (b, a, dy) = Ψ q (x, a) − W q (x, a) W q (b, a) Ψ q (b, a) µe −µy dy,(9)
and
Ψ b q (x, a, θ) = Ψ q (x, a) − W q (x, a) W q (b, a) Ψ q (b, a) µ µ + θ .(10)
Remark 3. When a = l this result holds as well, provided that H q (l) = 0.

Proof:
Ψ b q (x, a) = E x e −qT b,+ 1 {Tb,+<Ta,−} = E x e −qT b,+ − E x e −qT a,− 1 {X T a,− =a,T a,− <T b,+ } E a e −qT b,+ − a−l 0 E x e −qT a,− 1 {a−X T a,− ∈dy,T a,− <T b,+ } E a−y e −qT b,+ = Ψ b q (x) − Ψ b q,C (x, a)Ψ b q (a) − Ψ b q,J (x, a) a−l 0 Ψ b q (a − y)µe −µy dy = 1 H q (b) H q (x) − Ψ b q,C (x, a)H q (a) − Ψ b q,J (x, a) a−l 0 H q (a − y)µe −µy dy (11)
where Ψ q,C , Ψ q,J denote respectively ruin by creeping and by jumps. Similarly,
Ψ b q,C (x, a) = Ψ q,C (x, a) − Ψ b q,J (x, a)Ψ q,C (b, a), Ψ b q,J (x, a) = Ψ q,J (x, a) − Ψ b q,J (x, a)Ψ q,J (b, a).
Plugging the last equality into (11) and putting
W q (x, a) = H q (x) − Ψ q,C (x, a)H q (a) − Ψ q,J (x, a) a−l 0 µe −µy H q (a − y)dy yields H q (b)Ψ b q (x, a) = W q (x) + Ψ b q (x, a) H q (a)Ψ q,C (b, a) + Ψ q,J (b, a) a−l 0 H q (a − y)µe −µy dy and solving for Ψ b q (x, a) yields Ψ b q (x, a) = H q (x) − Ψ q,C (x, a)H q (a) − Ψ q,J (x, a) a−l 0 µe −µy H q (a − y)dy H q (b) − Ψ q,C (b, a)H q (a) − Ψ q,J (b, a) a−l 0 µe −µy H q (a − y)dy . (12)
Remark 4. (11), (9) show that, with negative exponential jumps, both two-sided exit first passage probabilities may be constructed using three functions H q , Ψ q,C , Ψ q,J from the onesided theory. If down-crossing continuously is impossible, only two functions H q , Ψ q,J are necessary.

The extension to downwards jumps of phase-type ( β, B) (a dense family) is immediate.

Lemma 2. For processes with downwards jumps of phase-type ( β, B) (11) becomes:
Ψ b q (x, a) = E x e −qT b,+ 1 {Tb,+<Ta,−} = H q (x) − Ψ q,C (x, a)H q (a) − Ψ q,J (x, a) a−l 0 e By bH q (a − y)dy H q (b) − Ψ q,C (b, a)H q (a) − Ψ q,J (b, a) a−l 0 e By bH q (a − y)dy := W q (x, a) W q (b, a) ,(13)
where Ψ q,J (x, a) is the lign vector of ruin probabilities whose k-th component is the ruin probability when crossing of x axis occurs during phase k, and b = (−B)1 .

Similarly, (9) becomes
Ψ b q (x, a, dy) = Ψ q (x, a) − Ψ b q (x, a) Ψ q (b, a) e By bdy.(14)
Proof: The same ideas as in the exponential case apply, except that now we must take into account the "conditional memory-less property of phase-type variables":
Ψ b q (x, a) = Ψ b q (x) − Ψ b q,C (x, a)Ψ b q (a) − a−l 0 K k=1 E x e −qT b,+ 1 {T a,− <T b,+ ,Jc=k,X T a,− ∈a−dy,T b,+ <∞} ,
where J c is the phase when down-crossing a. Now the last term may be written as
K k=1 a−l 0 E x e −qT b,+ 1 {T a,− <T b,+ ,Jc=k,X T a,− ∈a−dy,T b,+ <∞} = K k=1 a−l 0 E x e −qT a,− 1 {T a,− <T b,+ ,Jc=k,X T a,− ∈a−dy} E a−y e −qT b,+ ; T b,+ < ∞ K k=1 Ψ q,J (x, a, k) a−l 0 e By b k Ψ b q (a − y)dy = Ψ q,J (x, a) a−l 0 e By b H q (a − y)dy H q (b) ,
where Ψ q,J (x, a, k) denotes the ruin probability with crossing in phase k, and where the conditional memory-less property was applied. The rest of the proof must be modified similarly.

Remark 5. Note that the formula
H q (x) = W q (x, a) + Ψ q,C (x, a)H q (a) + Ψ q,J (x, a) a−l 0 e Bz bH q (a − z)dz
has a clear heuristic probabilistic interpretation: the "total weight", starting from x, of all paths converging to ∞ equals the "total weight" of all paths not reaching a + the "total weight" of all paths dropping to some a − z > l, 0 ≤ z, and converging to ∞ afterwards. Note that in the presence of a lower limit l, converging to ∞ in the heuristic may be replaced by never reaching l.


# Direct Conversion to an ODE of Kolmogorov's Integro-Differential Equation for the Discounted Ruin Probability

One may associate to the process (1) a Markovian semi-group with generator
Gh(x) = v(x)h ′′ (x) + c(x)h ′ (x) + (0,∞) [h(x − y) − h(x)]Π(dy)
acting on h ∈ C 2 (0,∞) , up to the minimum between its explosion and exit time T 0,− . The classic approach for computing the ruin, survival, optimal dividends, and other similar functions starts with the well-known Kolmogorov integro-differential equations associated to this operator. With jumps having a rational Laplace transform, one may remove the integral term in Kolmogorov 's equation above by applying to it the differential operator n(D) given by the denominator of the Laplace exponent κ(D). For example, with exponential claims, we would apply the operator µ + D.


## Ruin probabilities for Segerdahl's Process with Exponential Jumps Paulsen and Gjessing (1997), ex. 2.1

When v(x) = 0 and C k in (1) are exponential i.i.d random variables with density f (x) = µe −µx , the Kolmogorov integro-differential equation for the ruin probability is:
c(x)Ψ q (x, a) ′ + λµ x a e −µ(x−z) Ψ q (z, a)dz − (λ + q)Ψ q (x, a) + λe −µx = 0, Ψ q (b, a) = 1, Ψ q (x, a) = 0, x < a.(15)
To remove the convolution term Ψ q * f C , apply the operator µ + D, which replaces the convolution term by λµΨ q (x) 5 yielding finally
c(x)D 2 + (c ′ (x) + µc(x) − (λ + q))D − qµ) Ψ q (x) = 0
When c(x) = c + rx, a = 0, b = ∞, the ruin probability satisfies:
(c + x) D 2 + (1 + µ(c + x) −q −λ)D − µq Ψ q (x) = 0, (−c D + λ + q)Ψ q (0) = λ 6 , Ψ q (∞) = 0 (16) see [PG97,
(2.14),(2.15)], whereλ = λ r ,q = q r , and −c := − c r is the absolute ruin level. Changing the origin to −c by z = µ(x +c), Ψ q (x) = y(z) brings this to the form
zy ′′ (z) + (z + 1 − n)y ′ (z) −qy(z) = 0, n =λ +q,(17)
(we corrected here two wrong minuses in [PG97]), which corresponds to the process killed at the absolute ruin, with claims rate µ = 1. Note that the (Sturm-Liouville) Equation (17) intervenes also in the study of the squared radial Ornstein-Uhlenbeck diffusion (also called Cox-Ingersoll-Ross process) [BS12, p. 140, Chapter II.8].

Let K i (z) = K i (q, n, z), i = 1, 2, n =q +λ denote the (unique up to a constant) increasing/decreasing solutions for z ∈ (0, ∞) of the confluent hypergeometric Equation (17). The solution of (17) is thus
c 1 K 1 (q, n, z) + c 2 K 2 (q, n, z) = c 1 z n e −z M (q + 1, n + 1, z) + c 2 z n e −z U (q + 1, n + 1, z),(18) where [AS65, 13.2.5] U [a, a + c, z] = 1 Γ[a] ∞ 0 e −zt t a−1 (t + 1) c−1 dt, Re[z] > 0, Re[a] > 0 is
Tricomi's decreasing hypergeometric U function and M (a, a + c, z) = 1 F 1 (a, a + c; z) is Kummer's increasing nonnegative confluent hypergeometric function of the first kind. 7 The killed ruin probability must be combination of U and M , but the fact that it decreases to 0 suggests the absence of the function K 1 . The next result shows that this is indeed the case: the ruin probability is proportional to K 2 (µ(x + c(a)/r)) on an arbitrary interval [a, ∞), a > −c. K 1 yields the absolute survival probability (and scale function) on [−c, ∞), but over an arbitrary interval we must use a combination of K 1 and K 2 .
Theorem 1. Put z(x) = µ(c + x),c = c(a)/r. The ruin probability on [a, ∞) is Ψ q (x, a) = E x [e −qT a,− ] =λ cµ e −µx (1 + x/c) (q+λ) U 1 +q, 1 +q +λ, µ(c + x) U 1 +q, 2 +q +λ, µc(19)
(when q = 0, K 2 (0, n, z) = Γ(λ, z) and (25) reduces to Γ(λ,µ(c+x)) Γ(λ+1,µc)) ). 8

Proof. Following [PG97, ex. 2.1], note that the limits lim z→∞ U (z) = 0, lim z→∞ M (z) = ∞ imply
Ψ q (x) = k K 2 (z) = ke −z z q+λ U q + 1, q +λ + 1, z , z = µ(x +c).
The proportionality constant k is obtained from the boundary condition (16). Putting
G b [h](x) := [c(x)(h) ′ (x) − (λ + q)h(x)] x=0 , G b [Ψ q ](x) + λ = 0 =⇒ k = λ −G b [K 2 ](z(x)) ,
= −e −z zq +λ+1 U q + 1,q +λ + 2, z

Putting z 0 = µc, we find
−G b [K 2 ](z(x)) = z 0 e −z 0 z q+λ−1 0 U q, q +λ, z 0 + ( q +λ)e −z 0 z q+λ 0 U q + 1, q +λ + 1, z 0 = e −z 0 z q+λ 0 (U q, q +λ, z 0 + ( q +λ)U q + 1, q +λ + 1, z 0 ),
where we have used the identity [BS12, p. 640] This may be further simplified to
K ′ 2 (z) = −e −z z q+λ−1 U q, q +λ, z .(20)−G b [K 2 ](z(x)) = e −z 0 z q+λ+1 0 U q + 1, q +λ + 2, z 0 ), by using the identity U [a, b, z] + bU [a + 1, b + 1, z] = zU [a + 1, b + 2, z], a > 1,(21)
which is itself a consequence of the identities [AS65, 13.4.16,13.4.18]
(b − a)U [a, b, z] + zU [a, 2 + b, z] = (z + b)U [a, 1 + b, z] (22) U [a, b, z] + (b − a − 1)U [a + 1, b, z] = zU [a + 1, b + 1, z](23)
(replace a by a + 1 in the first identity, and subtract the second). Finally, we obtain:
Ψ q (x) = λ cµ e −µx (1 + x c ) q+λ U q + 1, q + 1 +λ, µ(x +c) U q + 1, q + 1 +λ + 1, µc = λ µ ∞ x (s − x) q (s +c)λ −1 e −µs ds ∞ 0
s q (s +c)λ e −µs ds , and Ψ q (0) = λ cµ U q + 1,λ + q + 1,cµ
U q + 1,λ + q + 2,cµ = λ cµ ∞ 0 t q (1 + t)λ −1 e −cµt dt ∞ 0 t q (1 + t)λ e −cµt dt = λ µ ∞ 0 s q (s +c)λ −1 e −µs ds ∞ 0 s q (s +c)λ e −µs ds = λ c ∞ 0 t q (t + µ)λ −1 e −ct dt ∞ 0 t q (t + µ)λ e −ct dt .
For (a, ∞), a > −c, the same proof works after replacing c, z(0) by c(a), z(a).


## Essentials of first passage theory for the Segerdahl process

We gather now together the most basic first passage results for the Segerdahl process with r = 1 and c = 0 (so that the absolute ruin point is −c = 0), and µ = 1. The general case with c = 0, r = 0, µ = 1, can be obtained by replacing z, a in the theorem below by z(x) := µ(x + c c 1 ) and z(a) -see Section 3.1.

Theorem 2. When r = 1, c = 0, the following formulas hold, with n = q + λ:

1. The function H q is up to a proportionality constant
H q (z) = K 1 (z) ∼ z n e −z M (q + 1, n + 1, z) = z n M (λ, n + 1, −z),(24)
where K 1 (z) is the unique q-harmonic function which increases on (0, ∞). The last expression, obtained via a Kummer transformation, is sometimes more stable numerically.

2. For a > 0, the ruin function is
Ψ q (z, a) = E z [e −qT a,− ] = λ K 2 (q, n, z) K 2 (q, n + 1, a) = λ µ e −z z n U (q+1,n+1,z) e −a a n+1 U (q+1,n+2,a) , z ≥ a > 0 λΓ(1+q)
Γ(1+q+λ) e −z z n U (q + 1, n + 1, z), a = 0 (25) (where we used lim z→0 z q+1+λ U [1 + q, q + 2 + λ, z] = Γ(1+q+λ) Γ(1+q) for the case a = 0).


## 3.

Ψ q (z, a, θ) = E z [e −qT a,− +θX T a,− ] = Ψ q (z, a) µ µ + θ (by the memoryless property of exponential claims). z ≥ a > 0, cf. (12), the scale function is given by


## For
W q (z, a) = H q (z) − Ψ q (z, a) a 0 µe −µy H q (a − y)dy = K 1 (q, n, z) − Ψ q (z, a)
K 1 (q, n + 1, a) n + 1 = K 1 (q, n, z) − λ n + 1 K 1 (q, n + 1, a) K 2 (q, n + 1, a) K 2 (q, n, z)

= z n e −z M (q + 1, n + 1, z) − λ n + 1 U (q + 1, n + 1, z) M (q + 1, n + 2, a) U (q + 1, n + 2, a) .

Since this is only determined up to a constant, we may and will usually take from now on W q (z, a) = z n e −z M (1 + q, λ + 1 + q, z) M (1 + q, λ + 2 + q, a) λU (1 + q, λ + 1 + q, z) (λ + 1 + q)U (1 + q, λ + 2 + q, a) =

z n e −z [(λ + q + 1)M (q + 1, n + 1, z)U (q + 1, n + 2, a) − λU (q + 1, n + 1, z) M (q + 1, n + 2, a)] .

The second derivative is W ′′ q (z, a) = µ 2 K ′′ 1 (q, n, z) − λ n + 1 K 1 (q, n + 1, a) K 2 (q, n + 1, a) K ′′ 2 (q, n, z) =⇒ W ′′ q (z, a)e a a −n+2 /Γ(n) = 1F1 (q + 1; n + 2; a) λn(an−aq−n 2 +n)U (q+1,n+1,a) U (q+1,n+2,a) + a(a − n + 1)((n + 1)(n − q) − λn) n + 1 + −(a + 1)n + aq + n 2 1F1 (q + 1; n + 1; a) and satisfies
W ′′ q (0, 0) = (n − 1)n 1 − λnU (q+1,n+1,0) (n+1) 2 U (q+1,n+2,0) Γ(n + 1) < 0 iff q + λ < 1.(28)

## The two-sided ruin function (3) with stopping at an upper bound b satisfies
Ψ b q (z, a) = Ψ q (z, a) − W q (z, a) W q (b, a) Ψ q (b, a) = λ a
e −z z n U (q + 1, n + 1, z) e −a a n U (q + 1, n + 2, a) − λ a e −b b n U (q + 1, n + 1, b) e −a a n U (q + 1, n + 2, a) × ( z b ) n e b−z (λ + q + 1)M (q + 1, n + 1, z)U (q + 1, n + 2, a) − λU (q + 1, n + 1, z) M (q + 1, n + 2, a) (λ + q + 1)M (q + 1, n + 1, b)U (q + 1, n + 2, a) − λU (q + 1, n + 1, b) M (q + 1, n + 2, a) .

Proof. 1. holds since K 1 (z) is the unique solution which increases on (0, ∞). 2. is a particular case of Theorem 1.

3. This follows from the memoryless property of the exponential jumps. 4. Apply (12). More precisely,
W q (z, a) = H q (z) − Ψ q (x, a)
a 0 e y−a H q (y)dy = K 1 (z, n) − Ψ q (x, a) K 1 (a, n + 1) n + 1 = z n e −z M (q + 1, n + 1, z) − λ e −z z n U (q + 1, n + 1, z) a n+1 U (q + 1, n + 2, a) a 0 y n M (q + 1, n + 1, y)dy = z n e −z M (q + 1, n + 1, z) − λ e −z z n U (q + 1, n + 1, z) a n+1 U (q + 1, n + 2, a) a n+1 n + 1 M (q + 1, n + 2, a) = z n e −z M (q + 1, n + 1, z) − λ n + 1 U (q + 1, n + 1, z) M (q + 1, n + 2, a) U (q + 1, n + 2, a) ,

where we used a 0 y n M (q + 1, n + 1, y)dy = a n+1 n+1 M (q + 1, n + 2, a) -see [AS65]. 5. This result is immediate.

Remark 6. The apparent singularity in (25) when a, z → 0 may be removed, since
Ψ q (0, 0) = lim z−>0 Ψ q (z, z) = lim z−>0 λ z U (q + 1, λ + q + 1, z) U (q + 1, λ + q + 2, z) = λΓ(q + λ) Γ(q + λ + 1) = λ λ + q .
(29) This result has a clear probabilistic interpretation and holds in fact clearly for any Lévy measure of finite negative intensity λ.

Remark 7. When q = 0, (28) and
M (1, 1 + λ, z) = λe x x −λ γ(λ, z) U (1, 1 + λ, z) = e x x −λ Γ(λ, z) = e x E 1−λ (z)(30)
where Γ(λ, y) = M (1, λ + 2, a) λU (1, λ + 1, z) (λ + 1)U (1, λ + 2, a) = e a −a −λ−1 Γ(λ+2)λ(Γ(λ, z)−Γ(λ, a)).

Up to a constant, we have
W (z, a) ∼ Γ(λ, a) − Γ(λ, z) = z a t λ−1 e −t dt =⇒ W ′ (z, a) ∼ e −z z λ−1 ,
a particular case of the formula W ′ (z, a) ∼ e −z c(z) λ−1 , which will be rederived below.


# The Renewal Equation for the Scale Derivative of Lévy Driven Langevin Processes Czarna et al. (2017)

One tractable extension of the Segerdahl-Tichy process is provided by is the "Langevintype" risk process defined by
X t = x + t 0 c(X s ) ds + Y t ,(31)
where Y t is a spectrally negative Lévy process, and c(u) is a nonnegative premium function satisfying
u > 0 =⇒ c(u) > 0, ∞ x 0 1 c(u) du = ∞, ∀x 0 > 0.(32)
The integrability condition above is necessary to preclude explosions. Indeed when Y t is a compound Poisson process, in between jumps (claims) the risk process (31) moves deterministically along the curves x t determined by the vector field
dx dt = c(x) ⇔ t = x x 0 du c(u) := C(x; x 0 ), ∀x 0 > 0.
From the last equality, it may be noted that if C(x; x 0 ) satisfies lim x→∞ C(x; x 0 ) < ∞, then x t must explode, and the stochastic process X t may explode.

The case of Langevin processes has been tackled recently in [CPRY17], who provide the construction of the process (31) in the particular case of non-increasing functions c(·). This setup can be used to model dividend payments, and other mathematical finance applications. [CPRY17] showed that the W, Z scale functions which provide a basis for first passage problems of Lévy spectrally positive negative processes have two variables extensions W, Z for the process (31), which satisfy integral equations. The equation for W, obtained by putting φ(x) = c(a) − c(x) in [CPRY17, eqn. (40)], is:
W q (x, a) = W q (x − a) + x a (c(a) − c(z))W q (x − z)W ′ q (z; a)dz,(33)
where W q is the scale function of the Lévy process obtained by replacing c(x) with c(a). It follows that the scale derivative 
w q (x, a) = ∂ ∂x W q (x,w q (x − a) + x a w q (x − z)w q (z; a)(c(a) − c(z))dz = w q (x, a), Y t of unbounded variation w q (x, a) c(x) c(a) , Y t of bounded variation . (35)
Problem 2. It is natural to conjecture that the formula (35) holds for all drifts satisfying (32), but this is an open problem for now.

Remark 8. Note that renewal equations are a more appropriate tool than Laplace transforms for the general Langevin problem. Indeed, taking "shifted Laplace transform" L a f (x) = (where we have used that W q (0) = 0( 1 c ) in the two cases, respectively). We obtain now from (38) the following ODE
r w ′ q (s, a) − κ(s) s w q (s, a) = −1 + κ(s) s W q (0) = −1 unbdd variation case −1 + κ(s) cs := − h(s) c bdd variation case ,(39)
where h(s) = Π(s) + q s .


## Remark 10. The Equation (39) is easily solved multiplying by an integrating factor
I q (s, s 0 ) = e − s s 0 κ(z)/z r dz = e − s s 0 α 0 z+c− Π(z)−q/z r dz ,(40)
where s 0 > 0 is an arbitrary integration limit chosen so that the integral converges (the formula (40) appeared first in [AU08]). To simplify, we may choose s 0 = 0 to integrate the first part α 0 z + c − Π(z), and a different lower bound s 0 = 1 to integrate q/z. Putting q = q r ,c = c r , α 0 = α 0 r , we get that 
I q (s) = e − s
where we replaced s 0 by · to indicate that two different lower bounds are in fact used, and we put I(s) = I 0 (s) (the subscript 0 will be omitted when q = 0).


## Solving (39) yields:

Theorem 3. Fix a and put I q (s) = ∞ s I q (y)dy. Then, the Laplace transform of the scale derivative of an Ornstein-Uhlenbeck type process (31) satisfies:
w q (s, a) = I q (s) rI q (s) − W q (0) =    Iq(s) rIq(s) ,
in the unbounded variation case
Iq(s) rIq(s) − 1 c , in the bounded variation case .(42)
Proof. In the unbounded variation case, applying the integrating factor to (39) yields immediately:

w q (s, a)I q (s) = r −1 ∞ s I q (y)dy = r −1 I q (s).

In the bounded variation case, we observe that
i ′ q (s) = h(s) r i q (s),
where i q is defined in (41). An integration by parts now yields 


# The Laplace transform-Integrating Factor Approach for Jump-Diffusions with Affine Operator Avram and Usabel (2008)

We summarize now for comparison the results of [AU08] for the still tractable, more general extension of the Segerdahl-Tichy process provided by jump-diffusions with affine premium and volatility
c(x) = rx + c σ 2 (x) 2 = α 1 x + α 0 , α 1 , α 0 ≥ 0.(43)
Besides Ornstein-Uhlenbeck type processes, (43) includes another famous particular case, Cox-Ingersoll-Ross (CIR) type processes, obtained when α 1 > 0.

Introduce now a combined ruin-survival expected payoff at time t
V (t, u) = E X 0 =u w (X T ) 1 {T < t} + p(X t ) 1 {T ≥ t} (44)
where w, p represent, respectively:

• A penalty w(X T ) at a stopping time T , w : R→ R

• A reward for survival after t years: p(X t ), p : R→ R + .

Some particular cases of interest are the survival probability for t years, obtained with w(X T ) = 0, p(X t ) = 1 {Xt ≥ 0 } and the ruin probability with deficit larger in absolute value than y, obtained with
w(X T ) = 1 {X T < −y } , p(X t ) = 0 Let V q (x) = ∞ 0 qe −qt V (t, x)dt = E x w (X T ) 1 {T < eq} + p(X eq ) 1 {T ≥ eq} ,(45)
denote a "Laplace-Carson"/"Gerber Shiu" discounted penalty/pay-off. x w(x − u)Π(du) denote the expected payoff at ruin, and let g(x) := w Π (x) + qp(x), g(s) denote the combination of the two payoffs and its Laplace transform; note that the particular cases
g(s) = q s , g(s) = λF (s)
correspond to the survival and ruin probability , respectively [AU08]. Then, the Laplace transform of the derivative
V * (x) = ∞ 0 e −sx dV q (x) = s V q (s) − V q (0) satisfies the ODE (α 1 s + r) V * (s) ′ − ( κ(s) s − α 1 )V * (s) = −h(s)V q (0) − α 0 V ′ q (0) + g(s) =⇒ V * (s)I q (s) = ∞ s I q (y) h(y)V q (0) + α 0 V ′ q (0) − g(y) r + α 1 y dy,(46)
where h(s) = Π(s)+ q s (this corrects a typo in [AU08, eqn. (9)]), and where the integrating factor is obtained from (40) by replacing c with c − α 1 [AU08, eqn. (11)]. Equivalently,
r s V q (s) ′ − κ(s) s s V q (s) = −(c + α 0 s)V q (0) − α 0 V ′ q (0) + g(s) =⇒ s V q (s)I q (s) = ∞ s I q (y) (c + α 0 s)V q (0) + α 0 V ′ q (0) − g(y) r + α 1 y dy.(47)
(b) If α 0 = 0 = α 1 and q > 0, the survival probability satisfies
Ψ q (0) =q I q−1 (0) cI q (0)(48)
s Ψ q (s)I q (s) = ∞ s I q (y)(cΨ q (0) −q y )dy =cΨ q (0)I q (s) −qI q−1 (s) =q
I q−1 (0) I q (0) I q (s) − I q−1 (s) Proof. (b)
The survival probability follow from (a), by plugging g(y) = q y . Indeed, the Equation (47) becomes for the survival probability s Ψ q (s)I q (s) = ∞ s I q (y)(cΨ q (0) −q y ) dy =cΨ q (0)I q (s) −qI q−1 (s).

Letting s → 0 in this equation yields Ψ q (0) =q I q−1 (0) cIq(0) . As a check, let us verify also Equation (47) for the ruin probability, by plugging g(y) = λF (y):
s Ψ q (s)I q (s) = ∞ s I q (y)(cΨ q (0) − λF (y))dy =cΨ q (0)Ī q (y) − J(y), J(y) = ∞ s yqe −cy j ′ (y)dy, j(y) := eλ y 0F (z)dz .
Integrating by parts, J(y) = −I q (s) +cI q (s) −qI q−1 (s). Finally,
s Ψ q (s)I q (s) =c(1 − Ψ q (0))I q (s) − − I q (s) +cI q (s) −qI q−1 (s) = I q (s) +qI q−1 (s) −cΨ q (0)I q (s) = I q (s) − s Ψ q (s)I q (s).(49)

## Segerdahl's Process via the Laplace Transform Integrating Factor

We revisit now the particular case of Segerdahl's process with exponential claims of rate µ and α 0 = α 1 = 0. Using Π(y) = λF C (y)dy = λ y+µ we find that for Segerdahl's process the integrand in the exponent is κ(s) rs =c −λ/(s + µ) −q/s, and the integrating factor (41) may be taken as
I q (x) = xqe −cx (1 + x/µ)λ.
The antiderivativeĪ q (x) is not explicit, except for:

1. x = 0, when it holds that I q (0) = µq +1 U (q + 1,q +λ + 2,cµ),  2. for q = 0, when it holds that
I(x) = e −cx (1 + x/µ)λ,Ī(x) = ∞ x I(y)dy = ec µ (cµ) −λ Γ(λ + 1,c(x + µ)) c .
10 Note that when c = 1, this function reduces to a power: U (a, a + 1, z) = However, the Laplace transforms of the integrating factor I q (x) and its primitive are explicit:

I q (s) = ∞ 0 e −(s+c)x xq(1 + x/µ)λ = Γ(q + 1)U (q + 1,q +λ + 2, µ(c + s), I q (s) = Γ(q + 1) U (q + 1,q +λ + 2, µc) − U (q + 1,q +λ + 2, µ(c + s) s .

Finally, we may compute:
Ψ q (0) =q I q−1 (0) cI q (0) =q U (q,q +λ + 1,cµ)
cµU (q + 1,q +λ + 2,cµ) Ψ q (0) = 1 − Ψ q (0) = 1 −q U (q,q +λ + 1,cµ) cµU (q + 1,q +λ + 2,cµ) =c µU (q + 1,q +λ + 2,cµ) −qU (q,q +λ + 1,cµ) cµU (q + 1,q +λ + 2,cµ) = λ cµ U q + 1, q + 1 +λ, µc U q + 1, q +λ + 2, µc ,

where we used the identity [AS65,13.4.18]
U [a − 1, b, z] + (b − a)U [a, b, z] = zU [a, b + 1, z], a > 1,(52)
with a =q + 1, b =q +λ + 1. This checks the (corrected) Paulsen result (24) for x = 0.

Remark 12. We can now numerically answer Problem 1: (a) obtain the antiderivativē I q (x) by numerical integration; (b) compute the Laplace transform of the scale derivative by (42); c) Invert the Laplace transform.

The example above raises the question: Problem 3. Is it possible to compute explicitly the Laplace transforms of the integrating factor I q (x) and its primitive for affine processes with phase-type jumps?

6 Revisiting Segerdahl's Process via the Scale Derivative/Integrating Factor Approach

Despite the new scale derivative/integrating factor approach, we were not able to produce further explicit results beyond (25), due to the fact that neither the scale derivative, nor the integral of the integrating factor are explicit when q > 0 (this is in line with [ACdL10]).

(25) remains thus for now an outstanding, not well-understood exception.

Problem 4. Are there other explicit first passage results for Segerdahl's process when q > 0?

In the next subsections, we show that via the scale derivative/integrating factor approach, we may rederive well-known results for q = 0.


## Laplace Transforms of the Eventual Ruin and Survival Probabilities

For q = 0, both Laplace transforms and their inverses are explicit, and several classic results may be easily checked. The scale derivative may be obtained using Proposition 3 and Γ(λ + 1, v) = e −v vλ + λΓ(λ, v) with v =c(s + µ). We find w(s, a) = ec µ (cµ) −λ Γ(λ + 1,c(s + µ))
e −cs (1 + s/µ)λ − 1 = 1 + λe v (v) −λ Γ(λ, v) − 1 =λU (1, 1 +λ,c(s + µ)) =⇒ w(x, a) =λ c 1 + x c λ −1 e −µx ,(53)
which checks (64). Using again w(s) =c I(y) I(y) − 1 yields the ruin and survival probabilities:
s Ψ(s) = ∞ sc Ψ(0)I(y)dy I(s) = Ψ(0)( w(s) + 1) s Ψ(s) = ∞ s (cΨ(0) −λ y+µ )I(y)dy I(s) = Ψ(0)( w(s) + 1) − w(s).
Letting s → 0 yields
Ψ(0) = w(0) w(0) + 1 =λ U 1, 1 +λ, µc µc U 1, 2 +λ, µc =λ Γ(λ,cµ) Γ(λ + 1,cµ) ⇔ Ψ(0) = lim s→0 s Ψ(s) w(0) + 1 = Ψ(∞) 1 +λ U 1, 1 +λ, µc = 1 µc U 1, 2 +λ, µc(54)
For the survival probability, we finally find s Ψ(s) = Ψ(0)(1 + w(s)) = 1 +λU 1, 1 +λ, µ(c + s) 1 +λU 1, 1 +λ, µc =c (µ + s)U 1, 2 +λ, µ(c + s) cµU 1, 2 +λ, µc , which checks with the Laplace transform of the Segerdahl result (58).


## The Eventual Ruin and survival probabilities

These may also be obtained directly by integrating the explicit scale derivative w(x, a) = λ c 1 + x c λ −1 e −µx (53) Indeed, 
∞ u w(x)dx = ∞ uλ c 1 + x c λ −1 e −µx dx =λe µc ∞ 1+ ũ c yλ −1 e µcy dy =λe µc 1 (µ c)λ ∞ µ( c+u) tλ −1 e −t dt =λe µc (µ c) −λ Γ(λ, µ( c + u)), where Γ(η, x) = ∞ x t η−1 e −t dt
where we used
U 1, 1 +λ, v) = e v v −λ Γ(λ, v)(56)
and 1 +λU 1, 1 +λ, v = vU 1, 2 +λ, v ,

which holds by integration by parts. A simpler formula holds for the rate of ruin ψ(x) and its Laplace transform
ψ(x) = −Ψ ′ (x) = w(x) 1 + ∞ 0 w(x)dx =λ Γ(λ + 1,cµ) µ(µ(c + x))λ −1 e −µ(c+x) = e −µc γλ ,µ (x +c) ⇔ ψ(s) = Ψ(0) w(s) =   λ U (1,1+λ,c(s+µ)) cµU (1,2+λ,cµ) , c > 0 (1 + s/µ) −λ , c = 0 ,(58)
where γ denotes a (shifted) Gamma density. Of course, the case c > 0 simplifies to a Gamma density when moving the origin to the "absolute ruin" point −c = − c r ,, i.e., by putting y = x +c, Y t = X t +c, where the process Y t has drift rate rY t .

Problem 5. Find a relation between the ruin derivative ψ q (x) = −Ψ ′ q (x) and the scale derivative w q (x) when q > 0.


# Asmussen's Embedding Approach for Solving Kolmogorov's Integro-Differential Equation with Phase-Type Jumps

One of the most convenient approaches to get rid of the integral term in (15) is a probabilistic transformation which gets rid of the jumps as in [Asm95], when the downward phase-type jumps have a survival function
F C (x) = ∞ x f C (u)du = βe Bx 1,
where B is a n × n stochastic generating matrix (nonnegative off-diagonal elements and nonpositive row sums), β = (β 1 , . . . , β n ) is a row probability vector (with nonnegative elements and n j=1 β j = 1), and 1 = (1, 1, ..., 1) is a column probability vector. The density is f C (x) = βe −Bx b, where b = (−B)1 is a column vector, and the Laplace transform isb
(s) = β(sI − B) −1 b.
Asmussen's approach [Asm95,?] replaces the negative jumps by segments of slope −1, embedding the original spectrally negative Lévy process into a continuous Markov modulated Lévy process. For the new process we have auxiliary unknowns A i (x) representing ruin or survival probabilities (or, more generally, Gerber-Shiu functions) when starting at x conditioned on a phase i with drift downwards (i.e., in one of the "auxiliary stages of artificial time" introduced by changing the jumps to segments of slope −1). Let A denote the column vector with components A 1 , . . . , A n . The Kolmogorov integro-differential equation turns then into a system of ODE's, due to the continuity of the embedding process.
Ψ ′ q (x) A ′ (x) = λ+q c(x) − λ c(x) β b B Ψ q (x) A(x) , x ≥ 0.(59)
For the ruin probability with exponential jumps of rate µ for example, there is only one downward phase, and the system is:
Ψ ′ q (x) A ′ (x) = λ+q c(x) − λ c(x) µ −µ Ψ q (x) A(x) x ≥ 0.(60)
For survival probabilities, one only needs to modify the boundary conditions-see the following section.

7.1 Exit Problems for the Segerdahl-Tichy process, with q = 0

Asmussen's approach is particular convenient for solving exit problems for the Segerdahl-Tichy process.

Example 1. The eventual ruin probability. When q = 0, the system for the ruin probabilities with x ≥ 0 is:
   Ψ ′ (x) = λ c(x) (Ψ(x) − A(x)), Ψ(∞) = A(∞) = 0 A ′ (x) = µ (Ψ(x) − A(x)), A(0) = 1(61)
This may be solved by subtracting the equations. Putting 

whenever K(v) is integrable at ∞. The boundary condition A(0) = 1 implies that 1 − Ψ(0) = 1 µ ∞ 0 K(v)dv and
A(x) = µ(1 − Ψ(0)) ∞ x K(v)dv = ∞ x K(v)dv ∞ 0 K(v)dv , Ψ(x) − A(x) = − K(x) µ ∞ 0 K(v)dv .
Finally,
Ψ(x) = A(x) + (Ψ(x) − A(x)) = µ ∞ x K(v)dv − K(x) µ ∞ 0 K(v)dv
, and for the survival probability Ψ,
Ψ(x) = µ x 0 K(v)dv + K(x) µ ∞ 0 K(v)dv := Ψ(0)W(x) = W(x) W(∞) ,(63)W(x) = µ x 0 K(v)dv + K(x),
where Ψ(0) = 1 W(∞) by plugging W(0) = 1 in the first and last terms in (63). We may also rewrite (63) as:
Ψ(x) = 1 + x 0 w(v)dv 1 + ∞ 0 w(v)dv ⇔ Ψ(x) = ∞ x w(v)dv 1 + ∞ 0 w(v)dv , w(x) := W ′ (x) = λK(x) c(x)(64)
Note that w(x) > 0 implies that the scale function W(x) is nondecreasing. Indeed, the analog of (62) is: Remark 13. The definition adopted in this section for the scale function W(x, a) uses the normalization W(a, a) = 1, which is only appropriate in the absence of Brownian motion.
       Ψ b (x, a) − A b (x) = Ψ b (a,
Problem 6. Extend the equations for the survival and ruin probability of the Segerdahl-Tichy process in terms of the scale derivative w q , when q > 0. Essentially, this requires obtaining T q (x) = E x e −q[T a,− min T b,+ ] 8 Further Details on the Identities Used in the Proof of Theorem 1

We recall first some continuity and differentiation relations needed here [AS65] Proposition 4. , and they are shown to be related via Thm. 1. Segerdahl's process per se is worthy of further investigation. A priori, many risk problems (with absorbtion/reflection at a barrier b or with double reflection, etc.) might be solved by combinations of the hypergeometric functions U and M .

However, this approach leads to an impasse for more complicated jump structures, which will lead to more complicated hypergeometric functions. In that case, we would prefer answers expressed in terms of the fundamental functions w or I.


x, a) := E x e −qT b,+ 1 {Tb,+<Ta,−} = P x [T b,+ < min(T a,− , e q )] Ψ b q (x, a) := E x e −qT a,− 1 {Ta,−<Tb,+} = P x [T a,− < min(T b,+ , e q )] q ≥ 0, a ≤ x ≤ b,(3)

## 7
M (a, b, z) and U (a, b, z) are the increasing/decreasing solutions of the to Weiler's canonical form of Kummer equation zf ′′ (z) + (b − z)f ′ (z) − a f (z) = 0, which is obtained via the substitution y(z) = e −z z n f (z), with a =q + 1, b = n + 1. Some computer systems use instead of M the Laguerre function defined by M (a, b, z) = L b−1 −a (z) Γ(1−a)Γ(b) Γ(b−a) , which yields for natural −a the Laguerre polynomial of degree −a. 8 Note that we have corrected Paulsen's original denominator by using the identity [AS65, 13.4.18] U [a − 1, b, z] + (b − a)U [a, b, z] = zU [a, b + 1, z], a > 1.


y x λ−1 e −x dx is the incomplete gamma function, γ(λ, y) = y 0 x λ−1 e −x dx = Γ(λ) − Γ(λ, y) is the lower incomplete gamma function, and E λ (z) = ∞ 1 t −λ e −xt dt is the ExpIntegral function, yield W (z, a) = z λ e −z M (1, λ + 1, z)


a) of the scale function of the process (31) satisfies a Volterra renewal equation [CPRY17, eqn. (41)]:w q (x, a) (1 + (c(x) − c(a))W q (0)) = w q (x − a) + x a (c(a) − c(z))w q (x − z)w q (z; a)dz,(34)where w q is the derivative of the scale function of the Lévy process Y t = Y (a) t obtained by replacing c(x) with c(a). This may further be written as:


−s(y−a) w q (y, a)dy, w q,c (s, a) = ∞ a e −s(y−a) w q (y, a)c(y)dy w q (s) = ∞ 0 e −sy w q (y)dyThe Linear Case c(x) = rx + c To get explicit Laplace transforms , we will turn next to Ornstein-Uhlenbeck type pro-cesses 9 X(·), with c(x) = c(a) + r(x − a), which implies w q,c (s, a) = ∞ a e −s(y−a) w q (y, a)(r(y − a) + c(a))dy = −r w ′ q (s, a) + c(a) w q (s,a).(37)Equation (36) simplify then to:w q (s)(1 + r w ′ q (s, a)) = w q (s, a) unbdd variation case w q (s, a) − r c(a) w ′ q (s, a) bdd variation case .(38)Remark 9. Note that the only dependence on a in this equation is via c(a), and via the shifted Laplace transform. Since a is fixed, we may and will from now on simplify by assuming w.l.o.g. a = 0, and write c = c(a).Let now κ(s) = α 0 s 2 + cs − s Π(s) − q, α 0 > 0, denote the Laplace exponent or symbol of the Lévy process Y t = √ 2α 0 B t − J t + ct,


dz := sqI(s) := e −cs i q (s),


cy i ′ q (y)dy = c −1 (−I q (s) +c ∞ s e −cy i q (y)dy) = r −1 I q (s)dy − c −1 I q (s).Remark 11. The result (42) is quite similar to the Laplace transform for the survival and ruin probability (Gerber-Shiu functions) derived in[AU08, p. 470]-see (47), (48) below; the main difference is that in that case additional effort was needed for finding the values Ψ(a, a), Ψ(a, a).

## Proposition 3 .
3[AU08, Lem. 1, Thm. 2] (a) Consider the process (43). Let V q (x) denote the corresponding Gerber-Shiu function (45), let w Π (x) = ∞

## ∞ 0 e
0−zt t a−1 (t + 1) c−1 dt, Re[z] > 0, Re[a] > 0.

## ∞ 0 t
0a−1 e −zt dt Γ(a) = z −a .

## Example 2 .
2For the two sided exit problem on [a, b], a similar derivation yields the scale function W(x, a) derivative derivative w(x, a) = 1 K(a) w(x), where w(x) given by (64) does not depend on a.


(x, a) := −(Ψ b ) ′ (x, a)


Using the notation M = M (a, b, z), M (a+) = M (a + 1, b, z), M (+, +) = M (a + 1, b + 1, z), and so on, the Kummer and Tricomi functions satisfy the following identities: bM + (a − b)M (b+) = aM (a+) (13.4.3) 9 Conclusions and Future Work Two promising fundamental functions have been proposed for working with generalizations of Segerdahl's process: (a) the scale derivative w [CPRY17] and (b) the integrating factor I [AU08]


is the incomplete gamma function. The ruin probability is[Seg55], [PG97, ex. 2.1]:Ψ(x) =λ 
exp(µc)(µc) −λ Γ λ , µ(c + x) 

1 +λ exp(µc)(µc) −λ Γ(λ, µc) 
=λ 
e −µx (1 + x/c)λ U 1, 1 +λ, µ(c + x) 

1 +λU 1, 1 +λ, µc 

=λ 
µc 

e −µx (1 + x/c)λ U 1, 1 +λ, µ(c + x) 

U 1, 2 +λ, µc 
=λ 
Γ(λ, µ(c + x)) 
Γ(λ + 1,cµ) 
, 

§ The boundary point l may be a natural barrier, like the largest root of σ(x). Or, when σ(x) = 0 and c(x) is increasing, l may be the largest root of c(x), called absolute ruin point. Or, it can be a point below which the process is artificially killed.
This result due to Paulsen has stopped short further research for more general mixed exponential jumps, since it seems to require a separate "look-up" of hypergeometric solutions for each particular problem.
More generally, for any phase-type jumps C i with Laplace transform f C (s) = a(s) b(s) , it may be checked that Ψ q * f C = f C (D)Ψ q in the sense that b(D)Ψ q * f C = a(D)Ψ q , thus removing the convolution by applying the denominator b(D).
For some background first passage results on these processes, see for example[BN08,LP10].
See also[BS12, p. 640], where however the first formula has a typo.
We conclude by mentioning two promising numeric approaches, not discussed here. One due to[JJ07]bypasses the need to deal with high-order hypergeometric solutions by employing complex contour integral representations. The second one uses Laguerre-Erlang expansions-see[ACW96,ALR09]. Further effort of comparing their results with those of the methods discussed above seems worthwhile.U + a U (+, +) = U (b+) (13.4.17)U + (b − a − 1)U (a + 1) = zU (+, +) (13.4.18)(see corresponding equations in[AS65]).Proposition 5. The functions K i (q,λ, z) defined by (18) satisfy the identities K ′ 1 (q, n, z) = (q +λ)e −z zq +λ−1 M q,q +λ, z = (q +λ)K 1 (q − 1,λ, z) (67)q +λ + 1 M q + 2,q + 2 +λ, z = (q +λ)M q + 1,q + 1 +λ, z + z q +λ + 1 (q + 1)M q + 2,q + 2 +λ, z − (q +λ + 1)M q + 1,q + 1 +λ, z = (q +λ)M q + 1,q + 1 +λ, z − z q +λ + 1λ M q + 1,q + 2 +λ, z = (q +λ)M q + 1,q + 1 +λ, z −λ M q + 1,q + 1 +λ, z − M q,q + 1 +λ, z =qM q + 1,q + 1 +λ, z +λM q,q + 1 +λ, z .The second formula may be derived similarly using 13.4.17, or by considering the function z U (q + 1,q + 1 +λ, µ) := Γ(q + 1)K 2 (z) = ∞ z (s − z)q (s)λ −1 e −µs ds appearing in the numerator of the last form of (69). An integration by parts yields= (λ − 1) z U (q + 1,q +λ, 1) − z U (q + 1,q +λ + 1, 1), =⇒ K ′ 2 (q + 1,λ, z) = e −z zq +λ−1 (λ − 1)U (q + 1,q +λ, z) − U (q + 1,q +λ + 1, z) The third formula is obtained by the substitution y = z(t + 1).
. Hansjörg Albrecher, Sören Asmussen, World Scientific14Ruin probabilitiesHansjörg Albrecher and Sören Asmussen, Ruin probabilities, vol. 14, World Scientific, 2010.

Florin Avram, F José, Javier Cariñena, Lucas De, arXiv:1008.2625A lie systems approach for the first passage-time of piecewise deterministic processes. arXiv preprintFlorin Avram, José F Cariñena, and Javier de Lucas, A lie systems approach for the first passage-time of piecewise deterministic processes, arXiv preprint arXiv:1008.2625 (2010).

On the laguerre method for numerically inverting laplace transforms. J Abate, G L Choudhury, W Whitt, INFORMS Journal on Computing. 8J. Abate, G.L. Choudhury, and W. Whitt, On the laguerre method for nu- merically inverting laplace transforms, INFORMS Journal on Computing 8 (1996), 413-427.

A pontryaghin maximum principle approach for the optimization of dividends/consumption of spectrally negative markov processes, until a generalized drawdown time. F Avram, D Goreac, preprintF. Avram and D. Goreac, A pontryaghin maximum principle approach for the optimization of dividends/consumption of spectrally negative markov processes, until a generalized drawdown time, preprint (2019).

The W, Z scale functions kit for first passage problems of spectrally negative Lévy processes, and applications to the optimization of dividends. F Avram, D Grahovac, C Vardar-Acar, arXiv:1706.06841arXiv preprintF. Avram, D. Grahovac, and C. Vardar-Acar, The W, Z scale functions kit for first passage problems of spectrally negative Lévy processes, and applications to the optimization of dividends, arXiv preprint arXiv:1706.06841 (2017).

Exit identities for Lévy processes observed at Poisson arrival times. H Albrecher, J Ivanovs, X Zhou, Bernoulli. 223H. Albrecher, J. Ivanovs, and X. Zhou, Exit identities for Lévy processes ob- served at Poisson arrival times, Bernoulli 22 (2016), no. 3, 1364-1382.

Exit problems for spectrally negative Lévy processes and applications to (Canadized) Russian options. F Avram, A Kyprianou, M Pistorius, The Annals of Applied Probability. 141F. Avram, A. Kyprianou, and M. Pistorius, Exit problems for spectrally neg- ative Lévy processes and applications to (Canadized) Russian options, The Annals of Applied Probability 14 (2004), no. 1, 215-238.

A unified analysis of taxed draw-down spectrally negative markov processes. Florin Avram, Bin Li, Shu Li, Florin Avram, Bin Li, and Shu Li, A unified analysis of taxed draw-down spectrally negative markov processes.

Series expansions for the first passage distribution of wong-pearson jump-diffusions. Florin Avram, Nikolai Leonenko, Landy Rabehasaina, Stochastic Analysis and Applications. 274Florin Avram, Nikolai Leonenko, and Landy Rabehasaina, Series expansions for the first passage distribution of wong-pearson jump-diffusions, Stochastic Analysis and Applications 27 (2009), no. 4, 770-796.

On the optimal dividend problem for a spectrally negative Lévy process. F Avram, Z Palmowski, M R Pistorius, The Annals of Applied Probability. 171F. Avram, Z. Palmowski, and M. R. Pistorius, On the optimal dividend problem for a spectrally negative Lévy process, The Annals of Applied Probability 17 (2007), no. 1, 156-180.

Shiu functions and optimal dividend distribution for a Lévy risk process in the presence of a penalty function. On Gerber, The Annals of Applied Probability. 254, On Gerber-Shiu functions and optimal dividend distribution for a Lévy risk process in the presence of a penalty function, The Annals of Applied Probability 25 (2015), no. 4, 1868-1935.

Florin Avram, José Luis Pérez, Kazutoshi Yamazaki, arXiv:1604.01436Spectrally negative l\'evy processes with parisian reflection below and classical reflection above. arXiv preprintFlorin Avram, José Luis Pérez, and Kazutoshi Yamazaki, Spectrally negative l\'evy processes with parisian reflection below and classical reflection above, arXiv preprint arXiv:1604.01436 (2016).

M Abramowitz, I A Stegun, Handbook of mathematical functions: with formulas, graphs, and mathematical tables. Dover publications55M. Abramowitz and I.A. Stegun, Handbook of mathematical functions: with formulas, graphs, and mathematical tables, vol. 55, Dover publications, 1965.

Stationary distributions for fluid flow models with or without brownian noise. Søren Asmussen, Communications in statistics. Stochastic models. 111Søren Asmussen, Stationary distributions for fluid flow models with or without brownian noise, Communications in statistics. Stochastic models 11 (1995), no. 1, 21-49.

The gerber-shiu expected discounted penaltyreward function under an affine jump-diffusion model. Florin Avram, Miguel Usabel, Astin bulletin. 3802Florin Avram and Miguel Usabel, The gerber-shiu expected discounted penalty- reward function under an affine jump-diffusion model, Astin bulletin 38 (2008), no. 02, 461-481.

First passage problems for upwards skipfree random walks via the phi, w, z paradigm. Florin Avram, Matija Vidmar, arXiv:1708.06080arXiv preprintFlorin Avram and Matija Vidmar, First passage problems for upwards skip- free random walks via the phi, w, z paradigm, arXiv preprint arXiv:1708.06080 (2017).

On fluctuation theory for spectrally negative lévy processes with parisian reflection below, and applications. Florin Avram, Xiaowen Zhou, Theory of Probability and Mathematical Statistics. 6Florin Avram and Xiaowen Zhou, On fluctuation theory for spectrally nega- tive lévy processes with parisian reflection below, and applications, Theory of Probability and Mathematical Statistics 6 (2017).

Exponential decay and ergodicity of completely asymmetric Lévy processes in a finite interval. J Bertoin, The Annals of Applied Probability. 71J. Bertoin, Exponential decay and ergodicity of completely asymmetric Lévy processes in a finite interval, The Annals of Applied Probability 7 (1997), no. 1, 156-169.

Jean Bertoin, Lévy processes. Cambridge university press121Jean Bertoin, Lévy processes, vol. 121, Cambridge university press, 1998.

Markov processes and potential theory, Courier Corporation. Robert Mccallum Blumenthal, Ronald Kay Getoor, Robert McCallum Blumenthal and Ronald Kay Getoor, Markov processes and potential theory, Courier Corporation, 2007.

On exit times of levy-driven ornstein-uhlenbeck processes. Konstantin Borovkov, Alexander Novikov, Statistics & Probability Letters. 7812Konstantin Borovkov and Alexander Novikov, On exit times of levy-driven ornstein-uhlenbeck processes, Statistics & Probability Letters 78 (2008), no. 12, 1517-1525.

Handbook of brownian motion-facts and formulae. N Andrei, Paavo Borodin, Salminen, BirkhäuserAndrei N Borodin and Paavo Salminen, Handbook of brownian motion-facts and formulae, Birkhäuser, 2012.

Irmina Czarna, José-Luis Pérez, Tomasz Rolski, Kazutoshi Yamazaki, arXiv:1712.00050Fluctuation theory for level-dependent l\'evy risk processes. arXiv preprintIrmina Czarna, José-Luis Pérez, Tomasz Rolski, and Kazutoshi Yamazaki, Fluctuation theory for level-dependent l\'evy risk processes, arXiv preprint arXiv:1712.00050 (2017).

Su un'impostazione alternativa della teoria collettiva del rischio. B De Finetti, Transactions of the XVth international congress of Actuaries. 2B. de Finetti, Su un'impostazione alternativa della teoria collettiva del rischio, Transactions of the XVth international congress of Actuaries, vol. 2, 1957, pp. 433-443.

Occupation densities in solving exit problems for Markov additive processes and their reflections. J Ivanovs, Z Palmowski, Stochastic Processes and their Applications. 122J. Ivanovs and Z. Palmowski, Occupation densities in solving exit problems for Markov additive processes and their reflections, Stochastic Processes and their Applications 122 (2012), no. 9, 3342-3360.

Jevgenijs Ivanovs, A note on killing with applications in risk theory. 52Jevgenijs Ivanovs, A note on killing with applications in risk theory, Insurance: Mathematics and Economics 52 (2013), 29-34.

Exit times for a class of piecewise exponential markov processes with two-sided jumps, Stochastic processes and their applications. M Jacobsen, A T Jensen, 117M. Jacobsen and A.T. Jensen, Exit times for a class of piecewise exponential markov processes with two-sided jumps, Stochastic processes and their appli- cations 117 (2007), no. 9, 1330-1356.

Fluctuations of lévy processes with applications: Introductory lectures. A Kyprianou, Springer Science & Business MediaA. Kyprianou, Fluctuations of lévy processes with applications: Introductory lectures, Springer Science & Business Media, 2014.

A unified approach for drawdown (drawup) of time-homogeneous markov processes. David Landriault, Bin Li, Hongzhong Zhang, Journal of Applied Probability. 542David Landriault, Bin Li, and Hongzhong Zhang, A unified approach for draw- down (drawup) of time-homogeneous markov processes, Journal of Applied Probability 54 (2017), no. 2, 603-626.

L Ronnie, Pierre Loeffen, Patie, arXiv:1006.2712Absolute ruin in the ornstein-uhlenbeck type risk model. arXiv preprintRonnie L Loeffen and Pierre Patie, Absolute ruin in the ornstein-uhlenbeck type risk model, arXiv preprint arXiv:1006.2712 (2010).

Bo Li, Zbigniew Palmowski, arXiv:1603.07967Fluctuations of omega-killed spectrally negative l\'evy processes. arXiv preprintBo Li and Zbigniew Palmowski, Fluctuations of omega-killed spectrally negative l\'evy processes, arXiv preprint arXiv:1603.07967 (2016).

On weighted occupation times for refracted spectrally negative l\'evy processes. Bo Li, Xiaowen Zhou, arXiv:1703.05952arXiv preprintBo Li and Xiaowen Zhou, On weighted occupation times for refracted spectrally negative l\'evy processes, arXiv preprint arXiv:1703.05952 (2017).

Ruin models with investment income. Jostein Paulsen, Encyclopedia of Quantitative Finance. Jostein Paulsen, Ruin models with investment income, Encyclopedia of Quan- titative Finance (2010).

Ruin theory with stochastic return on investments. J Paulsen, H K Gjessing, Advances in Applied Probability. J. Paulsen and H.K. Gjessing, Ruin theory with stochastic return on invest- ments, Advances in Applied Probability (1997), 965-985.

When does ruin occur in the collective theory of risk?. C.-O Segerdahl, MR MR0074726. 38638C.-O. Segerdahl, When does ruin occur in the collective theory of risk?, Skand. Aktuarietidskr. 38 (1955), 22-36. MR MR0074726 (17,638c)

Problem of destruction and resolvent of a terminating process with independent increments. V N Suprun, Ukrainian Mathematical Journal. 281V. N. Suprun, Problem of destruction and resolvent of a terminating pro- cess with independent increments, Ukrainian Mathematical Journal 28 (1976), no. 1, 39-51.

Uber eine zahlentheoretische Methode zur numerischen Integration und zur Behandlung von Integralgleichungen. R Tichy, Osterreich. Akad. Wiss. Math.-Natur. Kl. Sitzungsber. II. 193R. Tichy, Uber eine zahlentheoretische Methode zur numerischen Integration und zur Behandlung von Integralgleichungen, Osterreich. Akad. Wiss. Math.- Natur. Kl. Sitzungsber. II 193 (1984), 329-358.