# Application of Near-Infrared Spectroscopy and Hyperspectral Imaging Combined with Machine Learning Algorithms for Quality Inspection of Grape: A Review

CorpusID: 255254256 - [https://www.semanticscholar.org/paper/9073795b0f6a9f08956f54c0068c44f02c75db70](https://www.semanticscholar.org/paper/9073795b0f6a9f08956f54c0068c44f02c75db70)

Fields: Agricultural And Food Sciences, Computer Science, Medicine

## (s4) Basic Principles and Signal Mode
Number of References: 9

(p4.0) Near-infrared spectroscopy (NIRS) is vibrational spectroscopy, and it covers the wavelength range of 780-2500 nm (12500-4000 cm −1 ), which presents the molecular bond vibrations, including hydrogen-containing O-H, C-H, N-H and C-O groups [14,15]. It is a commonly used technique for non-destructive quality inspection of agro-products. When radiation hits a sample, the incident radiation may be reflected, absorbed and transmitted. The relative contribution of each phenomenon depended on the sample's chemical constitution and physical parameters [16].

(p4.1) Hyperspectral imaging (HSI) is another commonly used advanced technique for the non-destructive quality inspection of agro-products, which combines spectroscopy and the conventional imaging technique. It can obtain three-dimensional (3D) data information from the sample simultaneously, including the one-dimensional (1D) spectral information and two-dimensional (2D) spatial (image) information, achieving the unity of the map and spectrum [17,18], which is helpful to obtain qualitative and quantitative information about the product.

(p4.2) In signal mode, the interaction between light and biological tissues proves to be highly complicated [19]. When the incident light hits the grape, the part of light will be reflected on the surface directly, the remaining light penetrates the tissue interior, where they are absorbed and scattered. Before the light is absorbed, light spreads out in all directions, forming transmission or diffuse reflection. Among them, light exiting from the same side (the angle between the incident light and the emergency light is less than 90 • ) is defined as diffuse reflection, and the light exiting from the other side (the angle between the incident light and the emergency light is equal to or greater than 90 • ) is called transmittance [20].

(p4.3) Generally, NIRS and HSI present the three detection modes, including reflectance, transmittance, and interactance [21,22], as shown in Figure 2. Generally, reflectance refers to diffuse reflectance, and illumination and the detector are on the same side, as is shown in Figure 2a. The full transmission mode is usually configured with the illumination and detector on opposite sides of the sample, and the illumination, detector and sample are in one line, as is shown in Figure 2b. However, regarding partial transmittance, the illumination, detector and sample are not in a line, as is shown in Figure 2c. In interactance mode, the illumination and detector are installed on the same side of the sample and parallel to each other. In addition, a light barrier is placed between the illumination and the detector to prevent interference, as is shown in Figure 2d.
## (s6) Data Acquisition
Number of References: 5

(p6.0) Near-infrared spectroscopy (NIRS) data is acquired by a near-infrared (NIR) spectrometer. Generally, it consists of four modules: A light source, detector, sample stage, and light-isolating [23]. Based on the application, NIR spectrometers can be divided into laboratory, portable, and online spectrometers [14]. In recent years, portable vis/NIR systems have been developed due to innovations in optical system design and miniaturization for their friendly use directly in the field [24]. Specific online applications include laboratory scale, semi-industrial pilot scale applications, and industrial conditions [19,25].
## (s7) Data Analysis and Processing
Number of References: 3

(p7.0) Data analysis includes qualitative and quantitative analysis. The qualitative analysis of the sample provides non-quantifiable attributes, while quantitative analysis can extract quantitative sample information from the NIRS and HSI data. Generally, the analysis processing of NIRS and HSI data is shown in Figure 3. The main steps of data processing are summarized as follows: tion for their friendly use directly in the field [24]. Specific online applications include laboratory scale, semi-industrial pilot scale applications, and industrial conditions [19,25].
## (s11) Qualitative Analysis Variety Identification
Number of References: 6

(p11.0) Grape cultivars, especially wine grapes, play an essential role in winemaking, directly affecting grape wine quality. Cheng et al. used HSI to identify varieties of six white and six red wine grapes during the ripening period. The mahalanobis distance was employed to remove outliers of the spectral data. Six different pre-treatments (MSC, S-G filter, 0-1 normalization, SNV, first derivative and second derivative) were applied. Principal Component Analysis (PCA) loading was used to select effective wavelength. SVM, Random Forest (RF), and AdaBoost models were built with effective and full wavelength as prediction models. The S-G Filter + PCA + SVM achieves the best classification result, with the accuracy of 81.09% and 90.01% for white and red grapes [43]. Xu et al. used HSI based on ensemble empirical mode decomposition discrete wavelet transform (EEMD-DWT) to identify grape varieties. EEMD-DWT, SG, DWT and EMD were applied to denoise, and Competitive Adaptive Reweighted Sampling (CARS) and Successive Projections Algorithm (SPA) was involved in extracting the feature wavelength. Finally, SVM was built to identify the varieties of grapes, with the best accuracy of 99.3125% based on a model of EEMD-DWT-CARS-SPA in Monte Carlo (MC) experiments [44]. Besides, the chemical composition of seeds changes during grape ripening, affecting the wine's sensory properties [45]. Zhao et al. used nearinfrared HSI with multivariate analysis to non-destructively and rapidly discriminate and visualize different grape seeds. The effective wavelengths were extracted by the PCA loadings of the first six PCs. SVM was applied to establish classification, with a calibration accuracy of 94.3% and a prediction accuracy of 88.7% [46]. Rodríguez-Pulido et al. used NIR hyperspectral imaging combined with multivariate analysis methods PCA and General Discriminant Analysis (GDA) to predict the variety of grape seeds. The study shows a good result, with the accuracy of 100% using full spectra and 96% using the six selected wavelengths [47]. Quijada-Morín et al. successfully divided grape seeds into seven groups through hyperspectral imaging characteristics with k-means [48]. Variety refers to grape varieties. No means the number of the sample in the research. Object means the object-wise: single berry, a bunch, grape skin and grape seed. S/I means spectra and image features, respectively. Mod means the signal mode: transmittance mode (trans), interactance mode (inter), reflectance mode (refl), diffuse reflectance (drefl), and diffuse transmittance (dtrans). Ext means the approach to extracting effective wavelength. Best result means the best perform of model in the research. Application means the main relevant research contents in this cited literature. Reference means the reference resources.      
## (s12) Maturity Identification
Number of References: 5

(p12.0) Maturity estimation is critical for determining the grapes' optimal harvest timing and storage mechanism. Study results have verified the possibility of maturity detection. Based on the spectral feature, Costa et al. used Linear discriminant analysis (LDA), Quadratic discriminant analysis (QDA), LDA_Mahalanobis and PLS-DA classification models to identify the three maturation stages of grapes (green, véraison, and ripe). PLS-DA performed best, with an accuracy of 93.15% [53]. Ribera-Fonseca et al. divided four different maturity clusters according to an Index of Absorbance Difference (I AD ) of visible and near-infrared (VIS/NIR) spectroscopy (Cherry-Meter) by PCA, increasing level of maturity defined using technological parameters and anthocyanins concentration [55]. Virginia et al. collected white and red grapes in six stages according to the time. They divided them into three groups according to reducing-sugar content: Insufficiently ripe (1), optimally ripe (2 and 6), and overripe (3, 4 and 5) for white grape, and three groups: Young red wines (1), vintage reds (2, 5 and 6) and even sweet reds (3 and 4), respectively. PLS-DA was built for classification, and the percentage of correctly classified samples by the group was greater than 83% in all groups, except for the third stage in red grapes (79%) [56]. Baca-Bocanegra et al. used the NIRS technique combined with LDA, Discriminant partial least square (DPLS), and Pearson's similarity index to predict the level of phenolic, flavanolic and anthocyanic compounds (divided into two classes by the extractable pyhsical-chemistry content). However, the study shows unremarkable results except for internal validation in 2017 season (especially for LDA, with an average accuracy of over 87%) [52]. Xiao et al. used VIS/NIR spectroscopy combined with SVM-DA based on the full and effective wavelengths (CARS and SPA) to discriminate five stages (green, pre-veraison, veraison, post-veraison, ripe). The SSC-based CARS-SVM-DA model showed classification accuracies of 90% and 100% for 'Manicure Finger' and 'Ugni Blanc' [54].
## (s20) Quantitative Analysis
Number of References: 8

(p20.0) For quantitative analysis, most researchers also used spectra information to assess grape quality, but image features were also applied to prediction. Firmness is the primary textural attribute of fruit and is commonly used to predict the quality of the grape. Based on the NIRS technology, Kanchanomai et al. used NIRS combined with PLSR to predict firmness, and different preprocessing methods were used for comparison. The best model the Savitzky-Golay first derivative (SGD1) for firmness, with the R 2 result of 0.7427 and 0.7804 in the laboratory and field, respectively [49]. Xiao et al. used VIR/NIR spectroscopy to predict the L*, a*, b*, SSC and TP, and LS-SVM performed best, and all results were satisfactory [54]. Ribera-Fonseca et al. used a portable VIS/NIR spectroscopy device combined with Pearson correlation to evaluate firmness, and the R 2 result of 0.89 was obtained [55]. Beghi et al. used a VIS/NIR spectroscopy combined with PLSR to monitor grape withering by measuring firmness, TSS and weight loss. The R 2 and RPD results of 0.56 and 1.79 were obtained for firmness [73]. Color is a combination of visible light reflected or emitted from an object, influencing consumer preference. Xiao et al. used visible-near spectroscopy to grade for Manicure Finger and Ugni Blanc, and color space CIELAB was explored [51]. Besides, sensory parameters were explored. Raúl et al. used NIRS to evaluate sensory parameters, including firmness and color, and the study showed considerable potential for predicting the above sensory attributes [72]. Besides, based on the HSI, Baiano et al. applied HSI to predict the physico-chemical indices (seven grape varieties) and sensory. Sensory data was evaluated by a series of professional panels. To compare a hyperspectral image and RGB image, PLSR was also built using a combination of only red, green, and blue wavelengths and full wavelengths. For spectra data, the average R 2 of all results was over 0.80. However, considering the selected three wavelengths, the correlation between sensory data and spectra information was poor. The research showed that HSI could predict physico-chemical indices, while it could not predict sensory data [91]. Min et al. used visible near-infrared HSI with deep learning, based on a regression approach to predict the PH and firmness. Stacked auto-encoders (SAE) was conducted to extract deep spectral features combined with pixel-level and mean spectra. PLS and LSSVM were established to predict firmness and PH. The best model is SAE-LSSVM, with the R 2 p of 0.923. The study showed that SAE could be an alternative for dimensionality reduction and could predict the grape quality combined with HSI technology [92].
## (s21) Conclusions
Number of References: 12

(p21.0) Image feature has not drawn much interest in quality assessment compared to spectral feature. Regarding data preprocessing, in addition to the methods mentioned in Section 3.1, detrend was used [72], and SGD1 performed the best in Kanchanomai et al. [49]. Apart from the use in Section 3.1.3, PCA was conducted to research the latent structure of spectra data to identify the differences between the sample, and was behind the architecture of many food analysis devices through the analysis of reduced data [54]. In those studies, SPA [54,92], CARS [54,92], and VMD-RC [80] have also been applied to select characteristic wavelength and dimension reduction. Stacked auto-encoders (SAE) [92] has been used to extract the sample's deep spectral features and obtained a satisfactory result. Similarly, for the calibration model, traditional ML methods, including PLS-DA [51], PLSR [49], and Pearson correlation [55], are used to analyze data and compare the performance between image features and spectral features. The comparison indicates the difficulty of only evaluating internally by image features due to the poor ability to characterize features about the internal information of fruit, while the corresponding spectral data model shows better results.
## (s23) Qualitative Analysis
Number of References: 2

(p23.0) Data fusion strategies are performed as low-level, mid-level and high-level data fusion [94]. Low-level fusion is a direct concatenation of raw data from different sources. Mid-level fusion is a splice for features extracted from raw data. High-level fusion is the concatenation of the results from the built model [95]. Based on HSI, data fusion strategies have been used in the field. Here, we mainly discuss the fusion of a similar spectrum or the fusion of a map and spectrum.
## (s24) Quantitative Analysis
Number of References: 3

(p24.0) Concerning quantitative analysis, In Gao [90], GA, CARS, SPA, UVE and CARS-SPA, UVE-SPA were used to reduce dimensionality and extract the optimal wavelengths. The Grey-level co-occurrence matrix (GLCM) was applied to extract the texture feature and integrated it with image information (R, G, B, H, S, V, L, a, b). The result showed that SPA-PLSR combined with the fusion of image and spectra information (mid-level fusion) had the best detection, with the R 2 of 0.9775 and 0.9762 for the calibration and prediction set [90]. In that study, the PLSR model using HSI technology obtained good results in the SSC determination of grape with the highest R 2 P of 0.9763 based on fusion information in red globe grape. Besides, Orlandi et al. used low-level and mid-level data fusion strategies to condense the information obtained by an electronic eye (EE) and an electronic tongue (ET) sensing system for assessing grape ripening, and PLSR was used. The results showed the models using mid-level fusion performed better than that using EE and ET separately [96]. The studies here show that fusion data perform better than singe feature.
