# A Review of Formulations, Boundary Value Problems and Solutions for Numerical Computation of Transcranial Magnetic Stimulation Fields

CorpusID: 260393813 - [https://www.semanticscholar.org/paper/4f5c9f4234fcf8fec117417467df4602abe718be](https://www.semanticscholar.org/paper/4f5c9f4234fcf8fec117417467df4602abe718be)

Fields: Engineering, Medicine

## (s0) Introduction
(p0.0) Transcranial magnetic stimulation (TMS) is a method that modulates brain activity using an electric field induced in the brain by potent magnetic field pulses [1][2][3][4].This method is based on the application of magnetic field pulses to the brain cortex using coils, inducing electric fields oriented along certain paths to stimulate or inhibit brain activity in these areas.Several works [5][6][7][8][9] have shown that after TMS treatments, patients show improvement in their conditions, such as depression [5], mania, obsessive-compulsive disorder, post-traumatic stress disorder and schizophrenia [6][7][8][9].TMS in combination with EEG methods [10,11] can also be used as a tool too study brain functions.However, the efficacy of TMS for treatments is highly influenced by factors such as the efficiency [12,13], focality [14][15][16][17][18][19] and convenient distribution [15] of the induced electric fields.Furthermore, these factors are determined by several parameters, such as the quantity, [16,20], arrangement [16,17,20] and geometric parameters of excitation coils [16,18,21,22]; coil distance and orientation with respect to the brain [20,23,24]; excitation current waveform [25][26][27][28][29]; and electric properties of the brain tissues [30][31][32][33][34], among others.
## (s1) Scope and Contributions
(p1.0) The TMS formulations analyzed in the present work correspond to the Maxwell equation potential representations and their quasistatic approximations, which are solved using numerical methods [1][2][3][4][5][6][7][8][9].Other methods such as the impedance method [99] and neural network methods [59] are not considered in this review.The methods that start from Maxwell equations but derive non-differential equation representations such as dipole-based methods [100] are also not considered in the present analysis.

(p1.1) The objective of this study is to serve as a comprehensive guide for the numerical computation of TMS fields by reviewing previous works in this field.To achieve this, a series of deductions leading to various quasistatic approximations for the computation of TMS fields are presented, followed by a review of works that have utilized these approximations.Furthermore, the numerical solutions using finite difference and finite element methods are discussed in detail, drawing upon existing methods proposed in the literature.Additionally, this study deduces methods not found in the consulted literature, such as finite difference for quasistatic magnetic A-φ and Darwin models and finite element for quasistatic magnetic A-φ and Darwin models using the Galerkin method, as well as their implementation of boundary conditions applied to TMS fields.

(p1.2) The papers included in this review pertaining to field simulations in TMS were systematically chosen in a chronological manner, with emphasis placed on commencing with highly impactful publications based on their citation count.Additionally, works that cited these influential papers while introducing novel variants of formulations and numerical methods were also considered.It is essential to acknowledge that not all the works encompassing TMS field simulations propose new formulations or numerical methods.In fact, a significant portion of the TMS field simulation literature references the original works that introduced these methods, with their contributions primarily concentrated in the domain of applications.Every effort was made to incorporate as many of these application-oriented works as feasible.
## (s12) Solutions Using FEM
(p12.0) The FEM usually requires much less computational time than the FDM but can be more tricky to implement.The Poisson MQS-φ BVP can be solved with FEM using different approaches: the direct minimization of energy functional and the weighted residuals or the Galerkin method .For example, Weiping Wang and Solomon R. Eisenber [95] considered the following energy functional:
## (s17) Analytical and Semianalytical Solutions
(p17.0) It is clear that it is very difficult-if not impossible-to obtain an analytic solution of the TMS field formulations on realistic brain cortex geometries.However, it is possible to obtain analytic solutions considering simplified geometric models of the excitation coil and the brain.The advantage of these solutions is that they serve as a calibration reference for numerical simulations.Esselle et al. [49] computed the electric field produced by an arbitrarily shaped coil above half-space tissue with a planar interface with the air.The formulation corresponds to the Laplace MQS-φ formulation:
## (s20) Overview of Some of the Main TMS Simulation Results
(p20.0) The effectiveness and applications of TMS depend on several parameters of the coilbrain system, as mentioned in the Introduction.Some analyses using simulation methods have revealed how these parameters influence the electric field acting on the nerves.The use of different formulations, brain models and levels of numerical method precision can also influence the accuracy of estimating the field.A brief overview of some of these results is presented below.

(p20.1) Although it is difficult to establish a level of priority of elements that influence the electric field induced in the brain by TMS and the computation of the actual field distribution in the brain, there seems to be a consensus among works [16,18,[20][21][22][23][24] related to the simulation of the electric field induced by TMS, which analyzed the influence of the coil parameters (geometry, positioning, current waveform, etc.).Their main conclusion is that the adequate selection of these parameters is crucial for inducing the value of the electric field.In other words, the excitation parameters are the most fundamental elements for achieving the necessary value and distribution of the electric field in the brain, and the smallest variation of these parameters could have a significant impact on the excitation field.

(p20.2) Research conducted by Mills [20] demonstrated that the utilization of single coils for the purpose of stimulating long nerves is not advantageous.This is attributed to the presence of "hot spots" within the induced electric field generated by such coils, which possess both positive and negative fields.These hot spots can elicit contradictory effects on the nerve.Additionally, through the simulation of various coil geometries and configurations, Deng [17] established that figure-8-type coils exhibit greater focal properties compared than circular-type coils.None of the simulated coil configurations surpassed the figure-8-type coils in terms of achieving a tradeoff between depth of penetration and focal precision.Furthermore, Deng's research [17] indicated that an increase in the number of coil turns (N) amplifies coil inductance and peak voltage while reducing the necessary peak current.Theoretically, augmenting N enhances the accuracy of field replication, although this is constrained by the coil's dimensional requirements.

(p20.3) The impact of TMS is heavily influenced by the parameters employed for excitation.Specifically, the electric field distribution, which crucial for effective stimulation, may not always achieve the desired level of focus due to the configuration of the excitation coil in TMS.Consequently, achieving highly localized stimulation through the appropriate selection and arrangement of coils can prove challenging for specific applications.In this regard, a novel emerging technique called transcranial ultrasound stimulation (TUS) [101,102] offers several advantages, including the ability to provide highly focused excitation using an ultrasonic transducer.Moreover, the utilization of ultrasonic waves allows for deeper penetration of the stimulus into the brain, enabling access to central brain regions.Nevertheless, despite being considered a safe technique, further research is necessary to establish the long-term safety and potential risks associated with TUS.Additionally, the use of coupling gel is required for excitation in TUS.Furthermore, the indirect mechanism by which ultrasound stimulates neural activity through mechanical oscillations is more intricate compared to the direct electrical stimulation employed by TMS.

(p20.4) In reference to the precision of the estimation of the induced electric field, the accuracy of the coil and current parameters used in the model is very important, as well as an adequate formulation and BVP [20,23,24].In order of significance, the correct assignment of electric conductivity to each point in the brain model [30][31][32][33][34] and the selection of an appropriate numerical method for the simulations [73,90] are the subsequent key factors to be considered.Lastly, there are the details of brain model geometry, provided the use of a basic brain model including most of the fundamental parts (gyrus and sulcus) of the brain is used, although there is no clear consensus about the importance of the later.In this review , the effect of the shape and length of neurons and nerves, [103][104][105] which is also of fundamental importance, is not considered.

(p20.5) Petrov's study [58] reported that in the specific region where neurostimulation is typically performed, spiral wire coil models exhibited higher precision (RE < 5%) in predicting the actual induced field compared to a single circular wire coil model, which deviated from field measurements by up to 10% RE.These findings emphasize the necessity of employing a spiral winding-turns model to accurately approximate the induced field of a typical TMS coil [58].Moreover, the utilization of realistic magnetic resonance imaging (MRI)-derived head models demonstrated that differences in tissue conductivities had a negligible impact on the magnitudes of the electric field (E-field).However, the position and orientation of the coil, as well as the size of the brain, exerted significant effects on the magnitude of the E-field [24].Notably, substantial deviations in E-field magnitude were observed with respect to coil placement when considering the evaluation of effects over a 2 cm range in each direction of a two-dimensional plane of the TMS coil [24].This estimation may be regarded as conservative when assessing the disparity between the scalp location and the intended cortical target.The results highlight the extensive cortical area that may be affected when accounting for this level of positioning uncertainty, encompassing a significant portion of the dorsolateral prefrontal cortex [24].Certainly, it is feasible to reduce this uncertainty within an individual patient by developing reliable coil placement procedures combined with neuronavigation techniques [24,58].

(p20.6) On the other hand, in a recent study [83], it was discovered that the standard deviations in maximum electric field values resulting from uncertainties in tissue conductivities accounted for approximately 5% of the mean value in TMS.Tissue conductivity emerged as the primary factor determining the magnitudes of current density when the displacement current was insignificant [83].Conversely, with the presence of displacement currents, the permittivity became the principal determinant of current density magnitude.Furthermore, the study revealed that the existence of displacement currents could potentially increase the maximum cortical current density by an order of magnitude, assuming the extreme permittivity values reported by certain researchers prove to be accurate [83].Notably, all solutions exhibited currents that were perpendicular to the cortical interface, challenging models that propose preferential stimulation of tangentially oriented neurons based on the assumption that fields normal to the interface are negligible.Consequently, these models warrant re-examination [83].
