# Perfect graphs: a survey

CorpusID: 13143367 - [https://www.semanticscholar.org/paper/407e12ce49a1fe176cf610eef9469fe68f3a953e](https://www.semanticscholar.org/paper/407e12ce49a1fe176cf610eef9469fe68f3a953e)

Fields: Mathematics, Computer Science

## (s1) Terminology
(p1.0) By the SPGT, perfect graphs and Berge graphs form the same class. Still, we use Berge when we mostly rely on excluding holes and antiholes, and perfect when we mostly rely on colourings. Anyway, this distinction has to be kept when we sketch the proof of the SPGT. A minimally imperfect graph is an imperfect graph every proper induced subgraph of which is perfect. A restatement of the SPGT is that minimally imperfect graphs are precisely the odd holes and antiholes. Many statements about minimal imperfect graphs are therefore trivial to check by using the SPGT, but when proving the SPGT, it is essential to prove them by other means. Observe that a minimal (or minimum) counter-example to the SPGT has to be a Berge minimally imperfect graph.

(p1.1) We mostly follow the terminology from [20] that is sometimes not fully standard. Since all this theory deals with induced subgraphs, we write G contains H to mean that H is an induced subgraph of G. We simply write path instead of chordless path or induced path. When a and b are vertices of a path P , we denote by aP b the subpath of P whose ends are a and b. A subset A of V (G) is complete to a subset B of V (G) if A and B are disjoint and every vertex of A is adjacent to every vertex of B (we also say that B is A-complete).

(p1.2) We use the prefix anti to mean a property or a structure of the complement (like in holes and antiholes). For instance, an antipath in G is a path in G; A is anticomplete to B means that no edge of G has an end in A and the other one in B; a graph G is anticonnected if its complement is connected. By C(A) we mean the set of all A-complete vertices in G and by C(A) the set of all A-anticomplete vertices.
## (s11) Further reading
(p11.0) In [20], the global strategy of the proof is well explained at the beginning. More about the strategy is to be found in [92] and [19]. How structural methods can be used generally for classes closed under taking induced subgraphs is discussed in Chudnovsky and Seymour [23] and in Vušković [97]. To make a start on Question 6.2, the first step is the detection in polynomial time of the structures that are used in the proof (line graphs of a bipartite subdivision of K 4 , even prism and odd prism). Apart from wheels (that are NP-complete to detect as mentioned at the end of Section 5), they all can be detected in polynomial time in Berge graph, see Maffray and Trotignon [74].
## (s12) The Roussel-Rubio lemma
(p12.0) We are now ready to invistigate some technicalities of the proof of the SPGT. A lemma due to Roussel and Rubio [86] is used at many steps in [20]. In fact, the authors of [20] rediscovered it (in joint work with Thomassen) and initially named it the wonderful lemma because of its many applications.

(p12.1) The Roussel-Rubio lemma states that, in a sense, any anticonnected set of vertices of a Berge graph behaves like a single vertex. How does a vertex v 'behave' in a Berge graph? If a path of odd length (at least 3) has both ends adjacent to v, then v must have other neighbors in the path, for otherwise there is an odd hole. The lemma states roughly that an anticonnected set T of vertices behaves similarly: if a path of odd length (at least 3) has both ends complete to T , then at least one internal vertex of the path is also complete to T . In fact, there are two situations where this statement fails (outcomes (iii) and (iv) below), and for the sake of induction, it is convenient to give similar properties for a path of even length. All this results in a more complicated statement. A T -edge is an edge whose ends are T -complete. When P = xx . . . y y is a path of length at least 3, a leap for P is a pair of non-adjacent vertices u, v such that N (u) ∩ V (P ) = {x, x , y} and N (v) ∩ V (P ) = {x, y , y}. Observe that if u, v is a leap for P , then V (P ) ∪ {u, v} induces a prism. We denote by P * the interior of a path P . If P is a path, vertex-disjoint from T and whose ends are T -complete, then one the following holds.
## (s14) Further reading
(p14.0) Another proof of the Roussel-Rubio lemma is given in Maffray and Trotignon [75], where some applications are also presented. The proof given here in the case when T is a stable set is due to Kapoor, Vušković and Zambelli, see [95] where several very simple applications are presented.
## (s15) Book from the Proof
(p15.0) The goal of this section is to present a self-contained lemma of [20] in order to give some taste of the technicalities. Let us replace this lemma in its context by stating informally how line graphs are handled.

(p15.1) A line graph K of a bipartite graph is formed of a bunch of cliques, and a bunch of paths linking them. If K is contained in a Berge graph G, a vertex v ∈ V (G \ K) is major if it has many (here at least 2) neighbors in each of the cliques, and minor if it has neighbors in at most one of the paths, or in at most one of the cliques. An important result is that every vertex is major or minor, or allows one to obtain a larger line graph. This is not fully true (Fig. 4 contains counter-examples), but vertices that are neither major nor minor can be considered as part of some of the paths in what is called a generalized line graph. Therefore, when the generalized line graphs are properly defined, it is true that every vertex is major or minor w.r.t. a maximal generalized line graph. A next step is to prove that connected (sometimes anticonnected) components of vertices of G\K behave in fact as a vertex. A reader wanting to know more details for components can read the proof of 10.1 in [20] and we deal with anticomponents below.

(p15.2) If there are no major vertices, the graph is formed of the line graph, and possibly a bunch of minor components. If some of these components attach to a clique, then there is a balanced skew partition, and if some attach to a path, there is a 2-join. If there are major vertices, then it can be proved that an anticomponent of these is formed of vertices that all major in the same way, meaning that they all attach to exactly the same vertices of the cliques. Therefore, an anticomponent of major vertices is complete to its attachment, and forms a skew cutset separating parts of the line graph. The next lemma (it is a variant of 7.3 from [20]) proves a statement of this form. It illustrates another breakthrough made in [20]: how the Roussel-Rubio lemma can be used to find skew partitions. Lemma 8.1 In a Berge graph G, let K be a prism with triangles a 1 a 2 a 3 and b 1 b 2 b 3 and paths P i = a i . . . b i , i = 1, 2, 3. Suppose that for i = 1, 2, 3, P i has length at least 2. Let Y be an anticonnected set of vertices such that each of them have at least two neighbors in {a 1 , a 2 , a 3 } and at least two neighbors in {b 1 , b 2 , b 3 } (so Y is disjoint from K). Then at least two members of {a 1 , a 2 , a 3 } and at least two members of {b 1 , b 2 

(p15.3) Proof. Suppose not; then there is an antipath with interior in Y joining two vertices both in {a 1 , a 2 , a 3 } or both in {b 1 , b 2 , b 3 }. Let Q be a shortest such antipath. Suppose up to symmetry that Q is from a 1 to a 2 . Every vertex in Y is adjacent to either a 1 or a 2 , so Q has length at least 3. From the minimality of Q, a 3 is Q * -complete, and so is at least one of {b 1 , b 2 , b 3 }, say b i . Since Q can be completed to an antihole via a 1 b i a 2 , it follows that Q has even length, therefore at least 4. We set Q = a 1 q 1 . . . q n a 2 . Let a i be the neighbor of a i in P i , i = 1, 2 and P = a 1 P 1 b 1 b 2 P 2 a 2 .

(p15.4) (1) At least one internal vertex of P is (Q * \ q 1 )-complete and at least one internal vertex of P is (Q * \ q n )-complete.

(p15.5) If one of b 1 or b 2 is Q * -complete, the claim is obviously true. Otherwise, none of b 1 , b 2 is Q * -complete so there exists a antipath from b 1 to b 2 whose interior in Q * , and from the minimality of Q this antipath has the same interior as Q. It follows that one of b 1 , b 2 is complete to Q * \ q 1 and the other one is complete to Q * \ q n . This proves (1).

(p15.6) (2) If an internal vertex of P is (Q * \ q 1 )-complete or (Q * \ q n )-complete, then it is Q * -complete. If a 1 is (Q * \ q 1 )-complete, then it is Q * -complete.

(p15.7) If an internal vertex v of P is (Q * \ q n )-complete, then it is Q * -complete for otherwise, vq n Qa 1 v is an odd antihole. If v is a 1 or is an internal vertex of P , and v is (Q * \q 1 )-complete, then v is Q * -complete, for otherwise, vq 1 Qa 2 v is an odd antihole. This proves (2).

(p15.8) If both a 1 , a 2 are Q * -complete, then Q can be completed to an odd antihole via a 1 a 2 a 1 a 2 , a contradiction. So, up to symmetry, we suppose from here on that a 1 is not Q * -complete. It follows by (2) that a 1 is not Q * \ q 1 complete. Call x the Q \ q 1 complete vertex of P closest to a 1 along P . By (1), x exists and is an internal vertex of P . By (2), x is in fact Q * -complete.

(p15.9) If a 1 a 1 P x has odd length, then by Corollary 7.3 applied to a 1 a 1 P x and Q * \ q 1 , there is a contradiction because a 3 is (Q * \ q 1 )-complete and has no neighbor in the interior a 1 P x. So a 1 P x has even length. It follows that xP a 2 a 2 has odd length. By Corollary 7.3 applied to xP a 2 a 2 and Q * \ q n , and because of a 3 , there must be an internal vertex v of xP a 2 a 2 that is (Q * \ q n )-complete. By (2), v is in fact Q * -complete. But then, a 3 a 1 a 1 P x is odd, its ends are Q * -complete, but none of its internal vertex is Q * -complete. This contradicts Corollary 7.3 because of v.

(p15.10) The lemma above shows how the Roussel-Rubio lemma 'generates' antiholes to provide contradictions. Maybe it can be used to invistigate the structure of several subclasses of Berge graphs, for instance the next one. 
## (s16) Further reading
(p16.0) About technicalities, the best reading is of course Chudnovsky, Robertson, Seymour and Thomas [20]. The paper is very well organized: the first four sections are devoted to technical lemmas that are used extensively in the sequel. But as a result of this wise organization, it is very hard to extract a meaningful part: it is difficult to feel how useful the technical lemmas are without knowing the sequel, and the sequel is difficult to understand without mastering the technicalities of the lemmas. A reader seeking the easiest parts from [20] should try 15.1, Section 15 or Section 16. Section 10 is devoted to the even prism and is a self-contained chunk that has fewer technicalities than the rest of the paper (but still relies a lot on technical lemmas of the previous sections).
## (s17) Recognizing perfect graphs
(p17.0) From here on, we investigate works on perfect graphs that were done after the proof of the SPGT. Soon after the proof of the SPGT, another open question was solved. Chudnovsky, Cornuéjols, Liu, Seymour and Vušković [17] found a polynomial time algorithm that decides whether an input graph is Berge. Observe that this algorithm is independent from the SPGT. It takes any graph G as an input and outputs in time O(n 9 ) an odd hole-orantihole of G (if any). We give here a brief outline (that is a copy from the introduction of [17]). In what follows, G is the input graph of the algorithm.

(p17.1) [. . . ] we would like to decide either that G is not Berge, or that G contains no odd hole. (To test Bergeness, we just run this algorithm on G and then again on the complement of G.) If there is an odd hole in G, then there is a shortest one, say C. A vertex of the remainder of G is C-major if its set of neighbours in C is not a subset of the vertex set of any 3-vertex path of C; and C is clean (in G) if there are no C-major vertices in G. If there happens to be a clean shortest odd hole in G, then it stands out and can be detected relatively easily; and that essentially is the first step of our algorithm, a routine to test whether there is a clean shortest odd hole. The remainder of the algorithm consists of reducing the general problem to the 'clean' case that was just handled. If C is a shortest odd hole in G, let us say a subset X of V (G) is a cleaner for C if X ∩ V (C) = ∅ and every C-major vertex belongs to X. Thus if X is a cleaner for C then C is a clean hole in G \ X. The idea of the remainder of the algorithm is to generate polynomially many subsets of V (G), such that if there is a shortest odd hole C in G, then one of the subsets will be a cleaner for C. If we can do that, then we delete each of these subsets in turn, thereby generating polynomially many induced subgraphs; and we know that there is an odd hole in G if and only if in one of these subgraphs there is a clean shortest odd hole. Thus we can decide whether G has an odd hole by testing whether any of these subgraphs has a clean shortest odd hole. Let us now explain briefly the two steps from the sketch above. The second step relies on a powerful technique discovered by Conforti and Rao [35], called cleaning, which consists in 'guessing' a cleaner. Here, the way to guess the cleaner comes from Roussel-Rubio like lemmas, saying that the set X of vertices vertices to be 'guessed', that are all major vertices of some possible smallest odd hole, are all common neighbors of some set S (of size bounded by constant) of neighbors. Therefore, one can enumerate all possible S's by brute-force, and for each of them nominate X as the set of S-complete vertices.

(p17.2) The first step relies on the shortest path detector, a method designed by Chudnovsky and Seymour [17] that is used twice in the algorithm: once to detect a clean odd hole, and once to detect a pyramid. Detecting a pyramid is needed in a preprocessing step that we omitted to explain in the sketch above. It consists in the detection of several substructures certifying that the graph is not Berge, and one of them is the pyramid (that contains an odd hole).

(p17.3) To explain the shortest path detector, we give here a simpler algorithm that detects prisms in graphs with no pyramids (recall that in general graphs, the problem is NP-complete). This algorithm is not published because a faster one exists, see [74]. A shortest path detector always relies on a lemma stating in the smallest substructure of the kind that we are looking for, a path linking two particular vertices of the substructure can be replaced by any shortest path.

(p17.4) Lemma 9.2 Let G be a graph with no pyramid. Let K be a smallest prism in G. Suppose that K is formed by paths P 1 , P 2 , P 3 , with triangles {a 1 , a 2 , a 3 } and {b 1 , b 2 , b 3 }, so that, for i = 1, 2, 3, path P i is from a i to b i . Then:

(p17.5) If R i is any shortest path from a i to b i whose interior vertices are not adjacent to a i+1 , a i+2 , b i+1 or b i+2 , then R i , P i+1 , P i+2 form a prism on |V (K)| vertices in G, with triangles {a 1 , a 2 , a 3 } and {b 1 , b 2 , b 3 } (the addition of subscripts is taken modulo 3).

(p17.6) Proof. Suppose that the lemma fails for say i = 1. So, some interior vertex of R has neighbors in the interior of P 2 or P 3 . Let x be such a vertex, closest to a 1 along R. Let a 2 (resp. a 3 ) be the neighbor of a 2 (resp. a 3 ) along P 2 (resp. P 3 ). Let Q = a 2 P 2 b 2 b 3 P 3 a 3 . Let y (resp. z) be the neighbor of x closest to a 2 (resp. a 3 ) along Q.

(p17.7) If y = z then yxRa 1 , yQa 2 a 2 and yQa 3 a 3 form a pyramid, a contradiction. If y = z and yz / ∈ E(G) then xRa 1 , xyQa 2 a 2 and xzQa 3 a 3 form a pyramid, a contradiction. If yz ∈ E(G) then xRa 1 , yQa 2 a 2 and zQa 3 a 3 form a prism on less vertices than K, a contradiction. Now detecting a prism in a graph with no pyramid can be performed as follows. For all 6-tuples (a 1 , a 2 , a 3 , b 1 , b 2 

(p17.8) form a prism, and if so output it. If no triple of paths forms a prism, output that the graph contains no prism. If the algorithm outputs a prism, this is obviously a correct answer: the graph contains a prism. Suppose conversely that the graph contains a prism. Then it contains a smallest prism with triangles {a 1 , a 2 , a 3 } and {b 1 , b 2 , b 3 }. At some step, the algorithm will check this 6-tuple (unless a prism is discovered before, but then the correctness is proved anyway). By three applications of Lemma 9.2, we see that the three paths R 1 , R 2 , R 3 form a prism that is output. All this take time O(n 8 ).
## (s20) Berge trigraphs
(p20.0) An obvious question about Theorem 6.1 is whether it is best possible. Is each outcome necessary? Are there outcomes that can be made more precise? A careful reader of [20] might notice that the outcome 'homogeneous pair' is obtained only once in the whole proof, and might therefore wonder whether it is really necessary. Chudnovsky proved it is not. Let us explain how. A way to proceed is to consider a smallest Berge graph G such that the homogeneous pair is the only outcome satisfied by G in Theorem 6.1, and to look for a contradiction. A natural idea is then to 'contract' a homogeneous pair (A, B) in order to find a smaller Berge graph G . Then, apply Theorem 6.1 to G , and prove that any outcome of Theorem 6.1 in G yields an outcome in G (because G and G are very similar). From the initial assumption, G therefore satisfies no outcome of Theorem 6.1, and this provides a contradiction. We call this method bootstrap, because it improves structural theorems somehow for free. The natural way to 'contract' a homogeneous pair (A, B) of G is to replace A (resp. B) by a vertex a (resp. b) complete to C(A) (resp. C(B)) and anticomplete to C(A) (resp. C(B)). The bootstrap method is hard to implement in this context. The problem is with ab: should it be an edge or an antiedge of G ? Both choices lead to difficult technicalities: if ab is chosen to be an antiedge, it could be that that some skew cutset separates a from b in G , while A and B are linked in G. If a is chosen to be adjacent to b, it could be that the same phenomenon happens in the complement. No neat example of these bad phenomena can be given, because as we will see, it is true that the outcome 'homogeneous pair' is not necessary in Theorem 6.1. But any attempt of proof will face this issue and is likely to fail.

(p20.1) The idea of Chudnovsky is to leave undecided the adjacency between a and b in G . To this purpose, she defines trigraphs as graphs with edges, antiedges, and a third kind of adjacency: switchable pair. For every pair of distinct vertices x and y, xy is an edge, an antiedge or a switchable pair. A realization G of a trigraph T is any graph on V (T ) such that all edges (resp. antiedges) of T are edges (resp. antiedges) of G (so, every switchable pair is transformed into an edge or an antiedge). A trigraph is Berge if every realization is Berge. We do not give the long list of definitions that translates naturally the vocabulary of graphs to trigraphs. The key point is in the definitions of the decompositions: all the 'important' edges in definitions of decompositions are not allowed to be switchable pairs. For instance, if (X, Y ) is a 2-join of a trigraph T , no switchable pair of T is from X to Y . If (X, Y ) is a skew partition of a trigraph T , it must be that X is partitioned into X 1 and X 2 such that no edge and no switchable pair exists between X 1 and X 2 , and it must be that Y is partitioned into Y 1 and Y 2 such that no antiedge and no switchable pair exists between Y 1 and Y 2 . It is easy to guess how useful this requirement is: for instance, when building G from G as in the paragraph above, ab is defined to be a switchable pair. So, the problem that we mentioned with the skew cutset separating a from b does not exists anymore.
## (s24) Even pairs: a shorter proof of the SPGT
(p24.0) An even pair in a graph is a pair {x, y} of vertices such that every path between them has even length. This notion is involved in algorithmic aspects of perfect graphs and allows to significantly shorten the proof of the SPGT. Meyniel [77] proved the following.

(p24.1) Theorem 11.1 (Meyniel 1987) A minimally imperfect graph has no even pair. Therefore, even pairs could be an ingredient of a useful decomposition theorem for Berge graphs. Given two vertices x, y in a graph G, the operation of contracting them means removing x and y and adding one vertex with edges to every vertex of G \ {x, y} that is adjacent in G to at least one of x, y; we denote by G/xy the graph that results from this operation. Fonlupt and Uhry [46] proved that if G is a perfect graph and {x, y} is an even pair in G, then the graph G/xy is perfect and has the same chromatic number as G. In particular, given a χ(G/xy)-colouring c of the vertices of G/xy, one can easily obtain a χ(G)-colouring of the vertices of G as follows: keep the colour for every vertex different from x, y; assign to x and y the colour assigned by c to the contracted vertex. This idea could be the basis for a conceptually simple colouring algorithm for Berge graphs: as long as the graph has an even pair, contract any such pair; when there is no even pair find a colouring c of the contracted graph and, applying the procedure above repeatedly, derive from c a colouring of the original graph. The algorithm for recognizing Berge graphs mentioned at the end of the preceding paragraph can be used to detect an even pair in a Berge graph G; indeed, it is easy to see that two non-adjacent vertices a, b form an even pair in G if and only if the graph obtained by adding a vertex adjacent only to a and b is Berge. Thus, given a Berge graph G, one can try to colour its vertices by keeping contracting even pairs until none can be found. Then some questions arise: what are the Berge graphs with no even pair? What are, on the contrary, the graphs for which a sequence of even-pair contractions leads to graphs that are trivially easy to colour?

(p24.2) Bertschi [8] proposed the following definitions. A graph G is even contractile if either G is a clique or there exists a sequence G 0 , . . . , G k of graphs such that G = G 0 , for i = 0, . . . , k − 1 the graph G i has an even pair {x i , y i } such that G i+1 = G i /x i y i , and G k is a clique. A graph G is perfectly contractile if every induced subgraph of G is even contractile.
## (s25) Theorem 11.2 (Maffray and Trotignon 2005) Every Artemis graph is perfectly contractile.
(p25.0) This theorem can be transformed into a colouring algorithm [65] that generalizes several well known algorithms for colouring classes of perfect graphs, such as Meyniel graphs and weakly chordal graphs. It yields a combinatorial polynomial time colouring algorithm for perfectly orderable graphs (none was known before). The proof of the next theorem from [24] uses some technics of the proof of Theorem 11.3, is very readable, and as we will see saves about 50 pages in the proof of the SPGT. An odd wheel (C, T ) in a graph G consists of a hole C of length at least six, and a nonempty anticonnected subset T ⊆ V (G) \ V (C), such that at least three vertices of C are T -complete, and there is a path P of C with odd length at least 3, such that its ends are not T -complete and all its internal vertices are T -complete. A long prism is a prism such that at least one the paths has length at least 2. Let us say that G is impoverished if G is Berge, and G and G both contain no odd wheel, long prism or double diamond. A dominant pair in G is a pair (x, y) of nonadjacent vertices such that every other vertex of G is adjacent to at least one of x, y.

(p25.1) Theorem 11.4 (Chudnovsky and Seymour, 2009) If G is impoverished, then either G admits a star cutset or an even pair or a dominant pair, or G is a complete graph.

(p25.2) It is not very difficult to prove that a minimally imperfect graph has no dominant pair (see [24]), so it follows easily by Theorem 11.1 and Lemma 4.1 that every impoverished graph is perfect. Since the last 55 pages of the proof of the SPGT are devoted to finding a skew partition in an impoverished graph, they are no longer necessary and can be replaced by the 8 pages needed to prove Theorem 11.4.
## (s26) Conjecture 11.5 (Everett and Reed) Every Grenoble graph is perfectly contractile.
(p26.0) To prove perfection for a class C, a statement of the following form is enough: every graph in C has an even pair, or its complement has an even pair. Note that this does not hold for all Berge graphs as shown by L(K 3,3 \ e) (see Fig. 5). It seems that the only known theorem of this form is the following from [39]. The bull is the graph obtained from the triangle by adding two pending edges at different vertices.

(p26.1) Theorem 11.6 (de Figueiredo, Maffray and Porto, 1997) If G is a bull-free Berge graph with at least two vertices then at least one of G or G has an even pair.

(p26.2) A graph G is bipartisan if it is Berge and contains no L(K 3,3 \ e), no double diamond, and none of G, G contains a long prism (a prism is long when at least one of three paths of the prism has length at least 2). Observe that every bull-free Berge graph is bipartisan. An intermediate result of [20] is that a bipartisan graph is bipartite, complement of bipartite, or has a balanced skew partition. A direct proof of the following conjecture (published in [12] and [24]) would generalize Theorem 11.6 and could shorten the proof of the SPGT.
