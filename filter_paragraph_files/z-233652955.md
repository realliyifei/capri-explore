# Variable Speed Limit and Ramp Metering for Mixed Traffic Flows: A Review and Open Questions

CorpusID: 233652955 - [https://www.semanticscholar.org/paper/4ed73f71e9c2d976159a06f79b534e9add6257fe](https://www.semanticscholar.org/paper/4ed73f71e9c2d976159a06f79b534e9add6257fe)

Fields: Engineering, Computer Science, Environmental Science

## (s1) Application of VSL and RM Control in HDV Traffic Flows
(p1.0) The VSL control system application with timely and appropriate speed limits can control the incoming flow of the vehicles approaching the bottleneck by adjusting it to a lower level, i.e., to the amount of capacity of the bottleneck [6]. This prevents the capacity from dropping further and allows the congestion to be resolved more quickly and achieve traffic flow values less than or equal to the maximum capacity in the bottleneck area. The preventive effect of VSL is manifested in delaying the occurrence of the capacity drop, which prevents the activation of bottlenecks by timely control of the incoming traffic flow. The application of VSL leads to smaller speed deviations between vehicles and lanes, thus reducing the risk of accidents [27][28][29][30].

(p1.1) RM systems control the inflow of on-ramp motorway vehicles. For this purpose, the feedback system detectors required for operation are usually placed downstream of the on-ramp where vehicle merging takes place [31]. The most common RM algorithm, ALINEA [32], uses the output of the previous control step interval as input for the current iteration. Thus, the ALINEA inputs used are the previous control step interval metering rate and downstream occupancy. Some of the extensions to ALINEA that have been developed to improve performance are FL-ALINEA, UP-ALINEA, UF-ALINEA, AD-ALINEA, X-ALINEA/Q, and PI-ALINEA [19].

(p1.2) In the following subsections, the VSL and RM algorithms for HDV flows are analyzed, and grouped by the applied processing methods (rule-based, open-loop, feedback loop, and RL). Different metrics have been used as indicators of algorithm performance in different simulation scenarios. Thus, it is difficult to say which is the best method without indepth simulation analysis using the same scenario, which is out of the scope of this paperespecially since each of them has a different optimization objective, such as minimizing emissions, improving safety, and improving chosen macroscopic traffic parameters. Thus, only a comment about the effectiveness of the respective method group is given using the metric results published in the surveyed literature.
## (s3) Rule-Based Reactive VSL
(p3.0) This category of VSL systems bases its logic for calculating speed limits on predefined thresholds for a given traffic flow state. Based on the measured values of traffic parameters (flow q expressed in veh/h, density ρ expressed in veh/km, or mean speed v expressed in km/h) on a given motorway segment, a predefined speed limit is activated, as shown in Figure 1 [33][34][35][36]. VSL activation can be based on measured flow rate or standard deviations of density, as analyzed in [37]. Another approach is a reactive VSL system with the aim of informing the drivers about a possible disruption in the traffic flow (traffic accident, congestion). As a result, the speed of the incoming vehicle flow is gradually reduced and adapted to the new traffic situation. Such VSL systems can also have a weather-based activation logic (related to fog, ice, strong wind, etc.) [38]. The final decision on the speed limit output is made by the operations staff of the traffic control center based on the proposed speed limit and the assessment of the traffic situation gained from experience. 
## (s4) Open-Loop Based VSL
(p4.0) This category includes VSL controllers whose logic is based on the open-loop optimization process [7,[39][40][41]. A non-feedback control system requires an accurate traffic model with the ability to predict the movement of traffic flow parameters on a given motorway segment. Such a predictive model is difficult to achieve due to the stochastic traffic behavior. Most often, predictive models are based on a general macroscopic model of traffic flow. Other approaches, such as the Kalman filter [41], are used for better prediction of traffic flow to improve the optimization process.
## (s5) VSL Based on Negative Feedback Loop
(p5.0) The strategy of feedback VSL controllers is also based on collecting current traffic data on the congested motorway segment as shown in Figure 1, but with the objective of maintaining the controlled motorway segment at a defined set point such as the critical density ρ c . Such strategies do not require predictive traffic flow models. In [42], a simple VSL with integration action (so-called I-controller) for VSL control was proposed. It controls the flow of vehicles on the motorway segment before the problematic bottleneck occurence area. The working principle of the controller is based on the ALINEA algorithm [32]. Instead of a traffic light at the on-ramp controlling the flow of vehicles entering the urban motorway, VSL reduces the mainline speed limit. Similar to RM, VSL also controls the flow of vehicles by reducing the mainline speed. This achieves the effect of a "virtual ramp" on the motorway segment under VSL, which controls the output flow of the controlled segment or the inflow to the next adjacent problematic segment of the urban motorway. In [43], a distributed VSL controller based on control feedback adapted to eliminate shock waves was tested. The VSL on each controlled segment is operated by a separate controller (cumulatively 10 controllers). Such a VSL control system has proven to be successful in preventing the generation of shock waves, which cause minor disruptions to traffic flow. By applying VSL, TTS was reduced by 20% compared to the uncontrolled case in [43]. In [44], a comprehensive feedback control strategy was proposed for mainline traffic flow control enabled via VSLs, considering multiple bottleneck locations. The feedback control results were compared with the optimal control results to evaluate the performance of the proposed strategy, and it was able to come close to the optimal control results.
## (s6) RL-Based VSL
(p6.0) In [45], the Q-Learning (QL) algorithm was applied to VSL to optimize traffic flow on motorways taking traffic predictions into account. The environment was described by a vector of six normalized variables representing the current and previous posted speed limit, speed, and density on the controlled urban motorway. The reward function was modeled as the proportional negative TTS measured between the two control time steps. Oscillations between consecutive speed limit changes were prevented by restricting them to 20 km/h. A QL-based VSL (QL-VSL) control approach was also proposed in [46] to reduce TTT at motorway bottlenecks. The QL-VSL approach significantly outperformed the feedback-based VSL strategy based on the obtained results. In [47], the Reinforcement-Markov Average Reward Technique (R-MART) approach was proposed for VSL. The longterm middle rewards are utilized in the R-MART algorithm opposed to QL algorithm deferred rewards. The application of the R-MART VSL controller was able to reduce TTS by 18% and almost 20% less CO 2 emissions compared to the case without VSL. In our previous study [48], we proposed a deep QL-based VSL algorithm including a customized learning process and a complex reward function consisting of three separate objectives. The proposed algorithm aims to increase the throughput of the motorway by increasing the average mainline speed, increase safety by decreasing the difference between measured speed and posted speed limit, and minimize speed limit fluctuations in successive control step intervals. The proposed algorithm managed to increase the average mainline speed and reduce traffic density. The oscillations between the posted speed limits and the measured speeds were prevented.

(p6.1) The QL-VSL strategy was found to be most effective in reducing system TTT in both stable traffic demand scenario and fluctuating traffic demand scenario. Improvements larger than 20% can be expected depending on the respective traffic situation.
## (s8) RL-Based RM
(p8.0) An RM framework that uses RL as a robust and nonparametric generic optimization scheme that allows controlling of discretized partial differential equations was presented in [54]. An algorithm that enables experience sharing between agents and specialization of each agent due to multi-task learning to train Neural Networks (NNs), that was denoted from Mutual Weights Regularization (MWR), was also tested. MWR is an NN training approach that allows RL to learn a policy in a multi-agent environment without the curse of dimensionality due to the number of agents. Applied to RM's actual traffic control problem, a model-free approach achieves a comparable control level to the currently used model-dependent implementation of the ALINEA algorithm. The results show that the average speed is globally increased while the total number of vehicles on the motorway is decreased. The MWR approach resulted in a significant performance improvement, almost reaching the performance of the ALINEA algorithm in both cases.

(p8.1) In [55], an algorithm based on the k-Nearest Neighbor Temporal Difference (kNN-TD) was developed and tested on a microscopic traffic simulation model, which was used as a replica of the real world and a test environment for evaluating three scenarios: do-nothing (no metering), ALINEA controller, and kNN-TD controller. The results show that the ALINEA controller reduced TTT by 27%, while kNN-TD reduced TTT by 44% compared to the no control scenario. The average queue length was reduced to 112 vehicles in the proposed method compared to 231 vehicles in the case of ALINEA controller.

(p8.2) In [56], an RL-based density Control Agent (RLCA) was proposed. The RLCA objective function is to optimize the mainline motorway density to minimize TTT and maximize traffic flow. RLCA was tested with two different traffic network architectures and demand scenarios. In the first case study with a 6 km long mainline, the proposed RLCA guaranteed satisfactory performance by retaining the flow close to the motorway operational capacity. The simple QL algorithm managed to keep the mainline density close to 80 veh/km/2lanes, compared to the no control case where the density surpassed 110 veh/km/2lanes. The optimal control policy was determined based on two reference points: motorway capacity and ρ c . In the second case study with a 500 m long mainline, RLCA always performed the optimal action.

(p8.3) In [57], a network-level RM framework was proposed based on modeling by the collaborative Markov Decision Process (MDP) and an associated cooperative QL algorithm based on a payoff propagation algorithm under the coordination graph framework. Three design strategies were analyzed. The first design was independent learning, where the greedy policy for agents was implemented, and an action was chosen to maximize its local reward. The second network-level design was fully distributed and based on the collaborative MDP and cooperative QL algorithm based on the payoff propagation algorithm. In this design, the actions were coordinated between the control agent and its neighboring agents. The cooperative Q-function was updated globally. The third design is a centralized cooperative multi-agent system that can be considered as a single large agent. The cooperative Q-function was updated with a single Q-function. The first design reduced the TTT by 0.5%, the second by 6.5%, and the third by 6.9%.

(p8.4) The multi-agent Deep RL (DRL) RM algorithm, based on loop detectors data, was proposed in [58]. A multi-agent DRL framework is used to generate an appropriate RM scheme for each RM in real time to improve the operational efficiency of the urban motorway. Multi-agent proximal policy optimization architecture is introduced to solve the RM problem. The proposed algorithm was compared with no control, fixed-time control and ALINEA. Three traffic demand scenarios were tested which include constant demand, flat peak demand and sharp peak demand for both on-ramp and mainline traffic. The proposed algorithm increased the speed on the mainline by 43%, 29.7% and 11.5% for constant demand, flat peak demand and sharp peak demand scenarios, respectively. It can be seen that ALINEA achieved better results in the constant demand scenario, with a speed of 57.3 km/h on the mainline compared to 55.2 km/h for the DRL RM algorithm.

(p8.5) The kNN-TD method was able to achieve the best results, reducing the TTT by 44% compared to the no control scenario, while the DRL RM algorithm increased the speed on the mainline by up to 43%. This emphasizes the motivation of using ML-based methods with the caveat that the increase in the effectiveness depends on the respective simulation scenario.
## (s16) Impact of AVs and CAVs on the Fundamental Diagram
(p16.0) As mentioned, Table 1 summarizes obtained research results on the impact of AVs and CAVs on fundamental diagram without control algorithms. In [76], an evaluation of the impact of AVs on an existing motorway, national road network, and urban network (Dublin city center) was presented. AVs were formulated as Society of Automotive Engineers (SAE) level of automation 2, and CAVs were formulated as SAE level of automation 4 with Cooperative Adaptive Cruise Control (CACC). Tested scenarios included penetration rates from 0% to 70% with mixed SAE levels of automation. CAVs showcased gradual improvement in safety and efficiency. Satisfactory and realistic results were observed at penetration rates of around 20% to 40%. The motorway scenario proved to be the one most affected by CAVs. At low CAV penetration rates, traffic congestion and conflict situations were increased in some regions of the motorway networks.

(p16.1) In [77], the flow-density relation, Time-to-Collision (TTC), acceleration rate distributions, and speed difference distributions were analyzed under different penetration rates of CAVs from 0% to 100% and with two different time headways. The total number of incidental situations in the mixed traffic flow under different CAV penetration rates was reduced. The traffic flow was significantly increased by about 2000 veh/h in the case of the desired time headway of 0.5 s, while in the case of 1.1 s, the increase was measured to be close to 500 veh/h. The results of acceleration rate distributions and speed difference distributions of the mixed traffic flow indicate that the increase in penetration rates of CAVs smoothed both acceleration and speed significantly.

(p16.2) In [78], lane capacity was analyzed for different AV and CAV penetration rates. Lane capacity was increased by 8.6% when the AV penetration was increased from 0% to 100%. When the CAV penetration rate was increased from 0% to 100%, lane capacity was increased by 188.2%. When the mixed traffic flow consists of CAVs and HDVs, the lane capacity increases approximately linearly from 2046 veh/h/lane to 6450 veh/h/lane as the CAV penetration rate increased from 0% to 100%.

(p16.3) In [79], the influence of AVs in mixed traffic flow and the influence of autonomous driving levels on the fundamental diagram were analyzed. The results show that as the AV penetration rate increased with higher automation level, the capacity of the overall network increased and the ρ c value on a single road was higher. The ρ c value was increased by almost 48% from no AVs to 100% AVs in mixed traffic flow.

(p16.4) In [80], Cellular Automata (CA) model was used to analyze the impact of CAVs on the fundamental diagram on a single-lane road. CA was used to partition the road into cells, where a vehicle may or may not be present in a cell. The results show that with 70% of CAVs, the ρ c value was increased by about 37%, while the capacity under the ρ c was increased by about 42%.

(p16.5) In [81], the impact of AVs with different penetration rates on the fundamental diagram was analyzed. As the AV penetration rate increased, the speed-density curve shifted to the right, resulting in a higher ρ c value. Therefore, increasing the AV penetration rate increased the mean speed at the same density, thus increasing the traffic flow. The free-flow speed was increased by about 34% with 100% AV penetration rate, while the increase in capacity under ρ c was measured to approximately 30%.

(p16.6) In [82], the impact on traffic flow and density of Connected Vehicles (CVs) and AVs was analyzed under different penetration rates from 0% to 100% and three scenarios. In the first scenario, the effect of CV penetration rate was tested. The mainline flow was set to 1800 veh/h/lane in the first and second set of simulations. The throughput was increased as the CV and AV penetration rates increased. At low penetration rates of 0% to 50%, the results on the relationship between flow and density were inconsistent. At higher penetration rates, no breakdown or scatter was observed in the flow-density relationship. The second scenario analyzed the effects of AVs on throughput and scatter in the flowdensity relationship. The results were similar to the first scenario, with the exception of a smaller scatter at 50% and 70% AV penetration rates. The third scenario analyzed the simultaneous effects of AVs and CVs on throughput and scatter in flow-density relation. Six combinations of different penetration rates of CVs and AVs were analyzed. The mainline flow was set to 2200 veh/h/lane. The scatter in flow-density relationship was increased once the number of CVs surpassed the number of AVs, except in the scenario with a high CV penetration rate.

(p16.7) In [83], another analysis of the impact of AVs on fundamental parameters (q, ρ and v) was performed. According to [83], the standard capacity values for a single lane of 2200 veh/h could increase traffic capacity to about 3900 veh/h in an 100% AV penetration rate scenario. This conclusion was made based on the changed headway time gap parameter for the following vehicle to 0.5 s. According to the authors [83], this very short following distance already occurs in up to 20% of all following distances, depending on the traffic conditions. Table 2 demonstrates that VSL in mixed traffic flow scenarios has been broadly studied. In this subsection, we provide an overview of each study, starting with the earliest ones. To facilitate the evaluation of the surveyed methods, we grouped them according to their working concepts (optimization, rule-based, RL and others).
## (s18) Optimization-Based Methods for VSL
(p18.0) An integrated VSL and Lane Change (LC) control framework for motorway bottlenecks with mixed traffic flows was proposed in [85]. The Model Predictive Control (MPC)-based framework considers the interaction between VSL and LC to maximize traffic efficiency. An improved multiclass Cell-Transmission Model (CTM) that considers the effects of LC behavior was proposed to predict the traffic state. The Genetic Algorithm (GA)-based method was used to find the optimal values of VSL and LC settings simultaneously. The simulations were performed under three different traffic demand values, 1000 veh/h/2lanes, 2000 veh/h/2lanes, and 3000 veh/h/2lanes with 100% CAV penetration rate. The proposed control method significantly reduced TTS by 23.86% to 44.62%, outperforming the VSL-only control, which reduced TTS by 6.43% to 13.84% compared to the no control scenario.

(p18.1) The problem of controlling the speed of a number of AVs before entering a speed reduction zone on a motorway was analyzed in [87]. The problem of deriving the optimal acceleration and deceleration of each AV was solved by the proposed optimal control method applying Hamiltonian analysis. The main objective was to minimize the acceleration or deceleration for each vehicle entering the controlled segment until the specified time. By minimizing the acceleration or deceleration of each vehicle, fuel consumption and emissions were reduced. The effectiveness of this approach was evaluated using three different traffic demand levels. It was compared to the no control HDV scenario, VSL algorithm (using shock wave theory proposed in [105]), and a modified vehicular-based SPeeD HARMonization (SPD-HARM) algorithm proposed in [106]. Fuel consumption for each vehicle was reduced by 19% to 22% compared to the no control HDV scenario, by 12% to 17% compared to the VSL algorithm, and by 18% to 34% compared to the SPD-HARM algorithm. TT was improved by 26% to 30% compared to the baseline scenario, by 3% to 19% compared to the VSL algorithm, and 31% to 39% compared to the vehicular-based SPD-HARM algorithm.

(p18.2) In [88], the authors proposed an optimal VSL strategy in a CAV environment for a motorway corridor with multiple bottlenecks using an extended CTM that takes into account capacity drop and mixed traffic flow, including HDVs, heavy vehicles, and AVs. The GA optimization process for the developed VSL control strategy was conducted in four steps. The first step involves the collection of motorway detector-based data in each cell, including traffic flow, speed, and density. The second step refers to the traffic state prediction in the selected motorway cells during the next control horizon based on the collected traffic data. The third step is the optimization process, which computes the objective function according to the predicted traffic data. The objective function value of each individual in the population is evaluated, and a new population is generated using the mutation and crossover operators. Two stopping criteria were used for the GA, including a maximum number of generations and the average relative change between the best objective function value at the current iteration and the values achieved up to the current iteration. The proposed VSL control with V2V, V2I, and I2V communication outperforms the VSL-only control. Better performance was achieved with increasing CAV penetration rate. Seven different simulation scenarios were compared with a scenario with 100% HDVs and no VSL control. The scenario with 10% CAVs, I2V, V2I, VSL control, and the extended CTM showed the best results, reducing TTT, delays, number of stops, and emissions by 35.6%, 67.9%, 65.9% and 7.6%, respectively.
## (s19) Rule-Based VSL
(p19.0) In [89], a comprehensive evaluation of the potential impacts of AVs on an existing motorway system was analyzed in various motorway operational scenarios, including heavily congested traffic (>95% of motorway capacity), lightly congested traffic (≈70% of motorway capacity), free-flow traffic (≈50% of motorway capacity), and future traffic (three times more than heavily congested traffic volume) conditions. A number of MoEs were measured to reflect the changes in mobility, safety, fuel consumption and emissions caused by the deployment of AVs [89]. The rule-based VSL approach was modified to mixed traffic flow conditions and also tested in different AV penetration rates. These conditions were classified as either free-flow, light congestion, or heavy congestion. The VSL control step time was set to 5 min. The minimum time-gap was set to 0.5 s for AVs and 1.1 s for HDVs. The driver imperfection was set to 0% and 50% for AVs and HDVs, respectively. The acceptance factor for speed limits was set at 1% for AVs and 15% for HDVs. For all traffic congestion scenarios, AVs showed improvements for all MoEs, as did VSL in mixed traffic flow scenarios. For heavy traffic congestion scenario, VSL improved MTT by 14% to 26% at AV penetration rates ranging from 0% to 70%. AVs improved MTT by 43% at AV penetration rates from 0% to 100% in the no control scenario. Fuel consumption was improved by 5% to 44% in the no control scenario at AV penetration rates from 0% to 100%. The case with VSL improved fuel consumption by 10% to 31% at AV penetration rates from 0% to 70%.

(p19.1) The combination of Adaptive Cruise Control (ACC) equipped SAE level 2 of driving automation AVs and VSL on the safety on s congested motorway was analyzed in [91]. The car-following Intelligent Driver Model (IDM) was calibrated for the simulation framework. The tested segment was 10 km long and contained 10 evenly spaced loop detectors. The mainline traffic demand was set to 1600 veh/h/lane, and a bottleneck was set to occur after 10 min between two consecutive detectors. TET and TIT parameters were used to assess the safety performance of the proposed method. TIT was decreased by 57.6% to 79.9% from 0% to 100% AVs in the CACC and VSL model compared with ACC-only and VSL-only model which decreased it by 34% to 76.6% and 28.8%, respectively. TET was decreased by 48.1% to 77.4% from 0% to 100% AVs in the CACC and VSL model compared to ACC-only and VSL-only models that decreased it by 39.7% to 67.8% and by 27.1%, respectively.
## (s20) RL-Based VSL
(p20.0) In [84], a DRL model was proposed for Differential Variable Speed Limit (DVSL) control where dynamic and distinct speed limits can be imposed among lanes. It is based on the Actor-Critic (AC) architecture to learn a large number of discrete speed limits in the continuous action space. Four reward scenarios were tested. The reward scenarios r 1 and r 4 are based on several factors such as on-ramp inflow and off-ramp outflow. The reward scenario r 2 was the average speed in the downstream bottleneck. The reward scenario r 3 was computed by the total number of emerging braking vehicles in the controlled section. DVSL-r 1 , DVSL-r 2 , and DVSL-r 4 methods showed Average Travel Time (ATT) reduction of 1.08%, 4.1%, and 2.94%, respectively, while DVSL-r 3 showed an increase in ATT of 6.2%. DVSL-r 2 had the best emission reduction in HC and No x , while DVSL-r 4 showed the best emission reduction in CO and PMx. The AC-based DVSL agent was compared to the baseline scenario with no control, and baseline scenarios with AC and Deep Q-Network (DQN)-based VSL controllers. The DVSL improved ATT by 8.1% in scenarios with incidents and 5.8% in scenarios without incidents, while the VSL-DQN improved ATT by 1.7% and 2.9%, respectively. The VSL-DQN and QL performed better than the VSL-AC by a very slight margin.

(p20.1) In [90], a traffic flow control system was tested that includes AVs whose speeds are controlled by a centralized agent based on deep learning. The learning structure is based on Recurrent Neural Networks (RNNs), where the Gated Recurrent Unit (GRU) algorithm solves the vanishing gradient problem that occurs when learning a classical RNN network. Introducing 10% AVs into the traffic flow enables better control of the traffic flow in a structure where each AV is a mobile actuator of the control system. The state of the agent's environment is determined by the density and average speed of the HDVs and the AVs.

(p20.2) In both cases, the data are measured for each lane on each model segment. The value of the outflow measured at the exit of the bottleneck was also taken into account to describe the state. The actions were defined by the speed selection for AV vehicles. The goal of the agent is to maximize the outflow from the bottleneck. Therefore, the reward function is formulated as the output flow from the bottleneck area, measured at intervals of 20 s. Compared to the case without control, the results showed that the AV controller for medium traffic demand (inflow ≥ 1800 veh/h) achieves a ≈25% higher outflow. For the lower traffic demand scenario, the case without control showed a better result. The results compared to the case where the mainline is controlled by RM (control feedback) showed that the AV controller provides approximately the same outflow from the bottleneck for increased traffic demand (inflow ≥ 1800 veh/h) as RM. The case with RM showed a much better result for lower traffic demands.
## (s21) Other VSL Approaches
(p21.0) In [86], the flow-density relationship of moving bottlenecks with mixed traffic flow was analyzed under the influence of VSL based on the trapezoidal flow-density relationship aimed at reducing energy consumption. The algorithm was tested using CTM. The results show that in a demand scenario of 1800 veh/h, the total energy savings increased as the compliant vehicles' penetration rate increased. VSL reduced the energy consumption of compliant vehicles by up to 33% and by up to 8% for non-compliant vehicles. The total energy savings are more significant in a low demand scenario with a demand of 1800 veh/h. The results indicate that the free-flow speed does not have substantial effects on the percentage of energy savings.

(p21.1) In [102], the influence of Infrastructure-to-Vehicle (I2V) communication, AV control, and individualized speed limits for VSL by proposing a C-VSL extension was analyzed and compared with the classical VSL strategy. The I2V communication, AV control and individualized speed limits contributed to the harmonization of traffic flow and the reduction in exhaust emissions. C-VSL was implemented as VMSs functioning as roadside units, sending individual speed limit information to vehicles via I2V communication. Speed limits were calculated based on the distance between the VMS and the vehicle, the current speed of the vehicle, and the reference speed displayed on the VMS. Speed harmonization was achieved by giving individual speed limits to each vehicle at predefined time intervals. The proposed C-VSL narrowed the acceleration rate distribution and reduced NO x and HC emissions. In the scenario with a C-VSL penetration rate of 30%, an increase in average speed was shown compared to a penetration rate of 100%.

(p21.2) In [103], CAVs were utilized as an alternative data source for a VSL control system. An interval type 2 fuzzy logic-based VSL system was proposed that employs CAVs to collect traffic data without the need for a fixed-point sensor. The performance of the proposed VSL system was evaluated and modeled in the microscopic simulator using a real motorway section located in Auckland, New Zealand. The results show that the proposed VSL system has similar performance to the detector-based system when more than 10% of CAVs are deployed. However, it is noted that VSL may become obsolete at very high CAV penetration rates. Table 3 have shown that merging control approaches have also been extensively studied in mixed traffic flow scenarios. The majority of papers that analyzed merging control approaches evaluated the proposed algorithms in terms of macroscopic traffic parameters, such as speed, throughput, delay, on-ramp queue length, TTT, and ATT [94][95][96][97][98][99][100][101]107]. On the other hand, a few papers analyzed in this review evaluated the success of the proposed merging control approaches without considering the impact on the traffic flow macroscopic parameters [108][109][110]. In this subsection, an overview of each study is provided. Again, all surveyed studies are grouped according to the applied methods (optimization, car-following and trajectory planning, RL, and others).
## (s24) Optimization-Based Methods for Merging Control
(p24.0) The problem of optimal coordination of CAVs at merging roadways formulated as an unconstrained optimal control problem by applying the Hamiltonian analysis to derive an analytical, closed-form solution was analyzed in [100]. Different scenarios were tested regarding mainline and on-ramp speed and density. The overall cumulative fuel consumption with imposed control was improved by 48.1% for the case with different initial speeds for each road compared to the baseline scenario. The TTT was also improved by 13.5%.

(p24.1) In [101], the authors proposed an optimization framework and an analytical closedform solution for online coordination of CAVs at on-ramp merging zones formulated as a nonlinear optimization problem. At a distance of 250 m to 500 m before the merging area, the optimized acceleration information for each vehicle is sent back to the related vehicles at the next decision interval (10 s intervals), which strictly apply the given information. This approach was compared with the gradual speed limit by reducing the speeds to 50 km/h and 70 km/h at 0-250 m and 250-500 m before the merging area, and with no control scenario. Low (300 veh/h), medium (500 veh/h), and high (700 veh/h) demand scenarios for on-ramp and mainline flow were tested. The proposed approach reduced the average delay time per vehicle to almost 0 s and increased the average speed up to 95 km/h. For gradual speed limit and no control scenarios, the average delay time per vehicle under high on-ramp demand was measured to be up to 225 s and 255 s, respectively. The average speed was measured close to 15 km/h for both scenarios.

(p24.2) In [107], a hybrid approach was developed combining the hierarchical and distributed approaches for merging control. A Road Side Unit (RSU) was placed at the slot selection point and acted as a proxy between the mainline vehicles and the on-ramp vehicles. The RSU was utilized to locate the mainline vehicles and coordinate with them via V2V communication to determine suitable merging slots. These slots are marked as occupied for the vehicles and thus stored as a determined merging slot. Once the slot becomes free, the RSU distributes the slot information to the merging vehicle. The proposed approach does not suffer from system overload at very high traffic demand. Under medium mainline traffic conditions of 3600 veh/h, the slot-based approach with cooperation achieved a 106% increase in throughput compared to HDV-only flows. Under heavy mainline traffic conditions of 4700 veh/h, a throughput increase of 452% was measured for the slot-based driving with cooperation.

(p24.3) In [109], an MPC-based path planner was proposed to automatically decide the mode of maneuvers under a unified optimization framework for AVs in structured driving environments. A convex relaxation approach was used to determine the LC and lane-keeping maneuvers. Various simulation scenarios were tested in a simulation, including LC, lane keeping, ramp merging, and intersection crossing. The proposed path planner performance was effective in generating a safe and comfortable path for AVs in all tested scenarios.

(p24.4) In [110], a learning-based method for estimating vehicle intentions in ramp merging scenarios without over-the-air communication between vehicles was presented. The intention estimation is generated from a Probabilistic Graphical Model (PGM) that organizes historical data and latent intentions and determines predictions of real driving trajectories to learn transition models. The PGM-based intention estimation is augmented with ACC model to generate appropriate acceleration and deceleration behavior. The proposed method performance was evaluated on real merging data as well as with a designed merging control in simulation. The proposed method had the lowest failure rate and improved intention estimation in the merging control. It is computationally efficient and does not require acceleration information about other vehicles.
## (s25) Car-Following and Trajectory-Planning-Based Merging Control Methods
(p25.0) Authors in [95] developed a vehicle trajectory planning method for CAV coordination at on-ramps, formulating the planning tasks of the ramp vehicle and the mainline vehicle as two related distributed optimal problems. One simulation scenario with only three CAVs was used. Results show that all the three facilitating vehicles entering through on-ramp were able to develop a suitable gap under the influence of their respective leading vehicles whose speeds are constantly changing. All three merging vehicles could maneuver to the desired merge locations with the desired merge-in speeds.

(p25.1) The traffic flow strategy with vehicles using an optimized look-ahead cruise control method for merging control was proposed in [97]. A balance was achieved between reducing the energy demand of traffic flow and simultaneously reducing the queue length in the controlled lanes. It was found that the proposed method has several advantages, such as simple implementation, handling system nonlinearities, and considering parameter dependencies [97].

(p25.2) In [99], the authors used the Cooperative IDM (CIDM) to examine the system performance under different AV penetration rates for motorway merging control. A proposed CIDM-based controller determines the acceleration and deceleration rate of AVs in response to the actions of surrounding vehicles to improve road capacity and stability. The results imply that CIDM-based AVs can eliminate or alleviate speed oscillations on the motorway. The results show that with increasing AV penetration rate and under different safe time gaps in the IDM with values 0.4, 0.6, 0.8., 1, and 1.2 s, the speed oscillations were reduced by 46.1%, 53.9%, 54.8%, 69.7%, and 72.3%, respectively. For the safe time gaps of 0.4, 0.6, and 0.8 s, ATT was reduced by 15.4%, 12.3%, and 12%, respectively, while for the other cases, ATT was increased by 3.9% and 5.12%, respectively.
## (s26) RL-Based Merging Control
(p26.0) In [108], a merging control method was presented that allows AVs to merge into congested motorways using Multi-Policy Decision Making (MPDM) with passive Actor-Critic (pAC). The method does not require forward simulation as it uses estimated state values learned with pAC. The pAC uses the 3-vehicle systems to learn the merging control policy. Therefore, the ego-vehicle cannot always handle the condition changes due to the maneuvers for the adjacent vehicles. This approach was compared with quadratic programming and Z-learning. The pAC with the NN achieved a 97% success rate by combining an approximate nearest neighbor to mitigate the imbalance and sparsity of the data. The combined MPDM with pAC achieved a success rate of 92%, which is comparable to a real HDV merging decisions.

(p26.1) In [111], a DRL architecture for learning an on-ramp merging control policy was proposed. The long short-term memory architecture was implemented in the driving environment to account for the influence of historical and interactive driving behaviors. In the use case of ramp merging, the driver can selectively provide control inputs while the automated driving system tries to maximize the reward and achieve an effective merging maneuver [111].
## (s27) Other Merging Control Approaches
(p27.0) In [98], the motorway on-ramp merging control system was proposed to take advantage of V2X communication. CAVs share information in a vehicular ad-hoc network through dedicated short-range communication. It is assumed that all vehicles are CAVs. The vehicle sequencing protocol is designed to arrange vehicles in a predefined sequence to cooperate with each other before merging, thus avoiding high collision risks and excessive energy consumption and pollutant emissions when reaching the merging area [98]. The merging control approach was divided into three procedures. The first procedure calculated the maximum possible speed of on-ramp vehicles, the second procedure calculated the estimated arrival time, and the third procedure assigned vehicle sequence identification. The proposed protocol improved the ATT and average speed by 5.3% and 3.4%, respectively, compared to the no control scenario.

(p27.1) A two-level LC control strategy utilizing capabilities of AVs to improve the traffic flow on motorways in the scenario of active bottlenecks at on-ramps and lane drops was analyzed in [96]. The first-level centralized control optimized traffic density across lanes to balance traffic flow among lanes and reduced the number of LCs near the merge area. Second-level decentralized control mitigated merging conflicts due to localized LC. This strategy was designed to eliminate merging conflicts between AVs on the mainline and vehicles on the on-ramp and generate safe gaps for targeted LC for AVs. The proposed strategy improved traffic flow compared to the baseline scenario and ALINEA RM and reduced TTT and TT variations among vehicles traveling on the mainline and on-ramps. The proposed control outperformed ALINEA for base demand level and minor increases in demand, thereby increasing the operational capacity of the motorway.

(p27.2) In [94], an online merging control system for multi-lane motorway merging areas for a traffic flow with a 100% CAV penetration rate was presented, based on the optimization of the LCs and the trajectories of the following vehicles. A rule-based LC decision was used to balance the lane flow distribution before the merging area. A Cooperative LC Control (CLCC) optimization model was proposed to ensure safe and smooth LCs. Cooperative Merging Control (CMC) model was used for merging control near the merging area. A dynamic method with moving boundary point was proposed to coordinate the consecutive execution of the CLCC and CMC models. The CLCC model was based on a discrete-time linear system control model that optimized the longitudinal LC acceleration with the objective of maximizing the average speed. The CMC model assigned a merging sequence to each vehicle entering the cooperative merging area, and vehicle speeds were optimized. The simulations were conducted under four demand levels with three lane demand scenarios. The integrated CLCC and CMC results show a reduction in total delay time of 27% to 94.8% depending on the demand scenario. An increase in average speed was measured ranging from 2.7% to 52.2% depending on the demand scenario.
## (s28) Discussion
(p28.0) The focus of the paper was on the description of VSL and merging controllers and proposed control algorithms in mixed traffic flow scenarios. We have identified several potential research directions to address the limitations of existing methods. The limitations are the need for an accurately estimated fundamental diagram and the implementation of cooperative VSL and merging control system in mixed traffic flows.

(p28.1) The main drawback of the efficiency of classical VSL algorithms in mixed traffic flows is their inability to adapt their control policy to a new traffic situation, in which they perform sub-optimally. In the last five years, according to Table 2, there has been an increase in the number of studies focused on improving and proposing new VSL control algorithms for mixed traffic flows.

(p28.2) The drawback of both VSL and merging control approaches in mixed traffic flows is the assumption that the communication network is error free and that there is no delay or loss of information sent to the vehicles. Although AVs and CAVs are still at an early stage of development, a comprehensive study that includes both the control approach and the communication network influence analysis is yet to be made.

(p28.3) In [80], an analysis of mixed traffic flow was performed with CA model on a road segment divided into 3000 cells. The length of each vehicle was set to 1 cell and the maximum desired speed was set to 5 cells/s. The model could be improved by adjusting the vehicle length and maximum desired speed, which would lead to more realistic scenarios and results by keeping the definition of cell lengths in mind. A successful DRL model for DVSL control, where dynamic and distinct speed limits can be imposed between lanes, was implemented in [84]. Four learning reward scenarios were tested. Even though the results are promising, a safety analysis on incidents and crash risk or collision rate should also be considered. Due to differential speed limits, LCs could potentially lead to unwanted incidents in real-world scenarios.

(p28.4) In [99], it was stated that CIDM system performance under different proportions of AVs for motorway merging should consider safety aspect for low safe time gaps. For mixed traffic flows, HDVs, unlike AVs, cannot maintain low safe time gaps, where HDVs could potentially have no space to perform safe LC when needed.

(p28.5) In [85], the authors successfully used GA to solve the MPC formulated problem of VSL and LC. Using the CAVs' information about their average speed, density, and flow rate in each cell, GA repeatedly generates a population of individual solutions. These individual solutions are evaluated based on the objective function value in the next prediction horizon according to the modified multi-class CTM with these collected data.

(p28.6) Most researches on merging control approaches in mixed traffic flows disregard the classical RM approaches. Instead of the classical RM control, which uses a traffic signal with real-time traffic data to determine the rate at which vehicles should enter the motorway, merging control approaches are proposed to resolve interactions and conflicts between vehicles in merging areas [95,[98][99][100][101]. These strategies can be achieved by assuming that all vehicles are CAVs.

(p28.7) One of the major shortcomings of VSL and RM control algorithms for mixed traffic flows is that they can become obsolete at very high penetration rates. The advantages of AVs and CAVs in future mixed traffic flows at any penetration rate are pronounced in improving the macroscopic traffic parameters of urban motorways reducing the need for separate control.

(p28.8) The major shortcoming in the application of RL is the lack of a precise explanation of the learning process. The question of why the agent learned a particular strategy of action could not be answered accurately. Another issue that needs to be addressed is the cooperation of VSL and merging controllers in mixed traffic flows by applying control algorithms to improve MoEs and LoS.

(p28.9) In [94,95,98,100,101], the analyses of merging control approaches were performed under the assumption that all vehicles are CAVs. The analysis of different AV and CAV penetration rates and scenarios with mixed traffic flows would be beneficial since traffic is stochastic in nature. Additionally, it is more likely in the near future that there will be large variations and variances in AV and CAV penetration rates in mixed traffic flows. Therefore, the analyses of more realistic traffic scenarios would be useful.
