# SURVEY OF FEDERATED LEARNING MODELS FOR SPATIAL-TEMPORAL MOBILITY APPLICATIONS A PREPRINT

CorpusID: 258564828 - [https://www.semanticscholar.org/paper/1bd8cb97f207dee598c54ea40fd65b3ab7c140d5](https://www.semanticscholar.org/paper/1bd8cb97f207dee598c54ea40fd65b3ab7c140d5)

Fields: Engineering, Computer Science

## (s3) Applications
(p3.0) Mobility Prediction Mobility prediction can be defined as algorithms and techniques to estimate the future locations of users. Predicting the next location of users can help with a range of applications including networking (e.g., handover management), pandemic management (e.g., contact tracing), etc. This type of prediction is performed on individual users' traces where the historical trend of the user's visited locations can help in predicting the likelihood of their next location.

(p3.1) Transportation With the rising availability of transportation data collected from various sensors like road cameras, GPS probes, and IoT devices, there is an enormous opportunity for city planners to leverage these types of data to facilitate various tasks such as traffic flow prediction. Different from trajectory data that records a sequence of locations and time in each trip, crowd flow data only have the start and end locations of a trip, and how many people flow in and out of a particular region can be counted. Indeed, traffic flow prediction using spatial-temporal data has been one of the main focuses of the research community (See comprehensive survey [44]). In the context of transportation, this problem is often considered as forecasting which is to predict traffic speed or traffic flow of regions or road segments based on historical aggregated mobility data.
## (s4) Approaches
(p4.0) In this section we summarize federated learning spatial-temporal approaches in three main categories of i) trajectory predictive approaches which focus on the next-point prediction of user's trajectories, ii) flow-based approaches, and iii) clustering approaches. For each approach, we discuss the architecture of the model, the dataset used for evaluation, and FL strategies. Table 3 provides an overview of these works.  [25] 2019 Transfer-learning Private Mobile Phone Traces CD PMF [27] 2020 Foursquare [99], DenseGPS [26], Twitter [105] CD, Attack-resilient STSAN [56] 2020 ST Attention Layer Foursquare [99], Twitter [106] CD Yelp [65] Adaptive Model Fusion Ezequiel et al. [24] 2022 GRU-Spatial and Flashback
## (s8) Data sparsity and heterogeneity in trajectory prediction tasks
(p8.0) Mobility literature defines the highest potential accuracy of predictability of any individual, termed as "maximum predictability" (Î  max ) [67]. Maximum predictability is defined by the entropy of information of a person's trajectory (frequency, sequence of location visits, etc.). We adopt this measure to compute the non-iid property of the mobility traces. We use Shannon's Entropy H(x) to get a sense of both the sparsity and non-iidness of several check-in datasets.

(p8.1) In this process, we adjust the metric proposed by [84] to extend the individual entropy of users (i.e., horizontal) with an individual entropy of point-of-interests (i.e., vertical). We argue that having these two dimensions for the entropy is necessary to draw conclusions w.r.t to sparsity and heterogeneity. To quantify this relationship, we first measure the horizontal entropy in the following manner:

(p8.2) Where n is the number of POIs and is the size of the probability vector. P u (x i ) is the probability of an individual user u visiting location x i considering exclusively spatial pattern.
## (s9) Federated Trajectory Predictive Approaches
(p9.0) The challenges of trajectory predictive approaches in decentralized learning are different. Firstly, the unique properties of people's mobility [20] lead to a non-iid distribution of the data amongst clients. Second and as a result of the first challenge, creating a global model for predicting the next location of users that works equally well for all the users becomes an extremely challenging task. That is one must decide to what extent should clients adopt the global model and when to opt-in for a purely personalized model. In this section we review the existing works in this domain, review how they account for the mentioned challenge, and compare their performances in Table 5 against centralized predictive approaches namely ST-RNN [60], MCARNN [59], DeepMove [26], and VANext [33]. Fan et al. [25] proposed a decentralized attention-based personalized human mobility prediction. They apply a few-shot learning human mobility predictor that makes personalized predictions based on a few records for each user using an attention-based model. Furthermore, they take advantage of pre-training strategies where the predictor is trained on another smaller mobility dataset to accelerate the FL training on devices. However, even with the pre-training and attention-based strategy, the model requires over 1000 rounds of data communication rounds and is not sufficiently robust for the irregular nature of the human movement.
## (s10) STSAN [56]
(p10.0) Li et al. in 2020 proposed a cross-silo personalized next point prediction model named STSAN (Spatial-Temporal Self-Attention Network) which integrates AMF (Adaptive Model Fusion Federated Learning) for offering a mixture of a local and global model. The spatial attention layer allows for capturing the user's preference for geographic location, and temporal attention captures the user's temporal activity preference. To overcome the non-iid challenge, the AMF function enables the algorithm to learn specific personalization at each aggregation step on the FL server. The approach is evaluated on Foursquare, Twitter, and Yelp datasets. Table 3 reports its performance on the Foursquare dataset against centralized prediction approaches and shows the superior performance of 99% APR and 6% increase in Acc1 compared to VANext [33] .

(p10.1) PMF [27] Feng et al. proposed PMF, a privacy-preserving mobility prediction framework that uses FL to train general mobility models in a privacy-aware manner. In PMF, every participating device trains locally a representation of the global (centralized) model by using only the locally available dataset at each device. The framework also accounts for attack cases in the mobility prediction task and uses a group optimization algorithm on mobile devices to tackle these attacks. In the group optimization procedure, the whole model is divided into the risky group trained with protected data and the secure group trained with normal data. Furthermore, an efficient aggregation strategy based on robust convergence and an effective polling schema for fair client selection in the centralized server. The results of this model on DenseGPS and Twitter dataset show similar top-1 performance to DeepMove [26] but on Foursquare Tokyo it performs poorer than centralized baselines and other FL approaches.
## (s11) STLPF [93]
(p11.0) Wang et al. proposed a spatial-temporal location prediction framework (STLPF) where the next point prediction algorithm is trained based on a self-attention layer that enables information to be learned between long sequences in both local and global models. Furthermore, as part of the framework, the authors propose an approach that enables clients to cooperatively train their models in the absence of a global model. Their evaluation shows marginal improvement in the accuracy of next point prediction (APR) on the Foursquare dataset when compared to the centralized approaches, and their approach performs similarly to STSAN [56] (See Table 5).
## (s12) Flow Prediction Approaches
(p12.0) Accurate Traffic Flow Prediction is an extremely useful to mitigate traffic congestion and as a result, air pollution, travel time, and driving experience. Approaches in predicting the traffic patterns range from classical approaches to time-series analysis (such as ARIMA) to more advanced models such as those based on Recurrent Neural Networks and Graph Neural Networks. For a comprehensive survey of deep learning models for traffic predictions in centralized settings refer to [44]. Given that this type of data in real world could be be collected by various entities and organizations, Cross Silo Federated Learning is a promising paradigm for ensuring that the records are not shared outside of each organization. Flow prediction approaches require slightly different settings in FL than trajectory prediction. Unlike individual predictive approaches where each client is assumed to correspond to an individual with their mobility traces as the non-iid data, in flow predictive approaches, the clients are often considered to be entities or organizations that are maintaining their flow data private. When different organizations use data collected by sensors to predict traffic flow, the collected dataoften cannot not be shared due to regulatory reasons. This cross-silo configuration of FL reduces some of non-iid problems but imposes challenges regarding vertical FL.

(p12.1) Current works in Federated Traffic Flow Prediction can be grouped into two groups of grid-based (such as recurrent neural networks, etc.) and graph-based approaches. We first review the metrics and datasets used for these tasks and then review the current literature.
## (s15) Grid based Approaches
(p15.0) In grid-based approaches, the input data into the model is a sequence of locations over time. These approaches mainly focus on deep neural models such as RNN, GRU and LSTM to capture past historical traffic information as a predictor for future instances.   MVFF [23] proposes a vertical federated learning framework for mobility data forecasting for cross-silo applications where each organization holds a partial subset of data. Using a local learning model, each organization extracts the embedded spatio-temporal correlation between its locations. To account for global learning, a global model synchronizes with the local models to incorporate the correlation between all the organizations' locations.

(p15.1) Fed-NTP [86] proposed an LSTM model implemented in FL to predict network traffic based on the most influential features of network traffic flow in the Vehicular Ad-Hoc Network (VANET). Even though this work is not aiming in predicting vehicle traffic and focuses on network flow, it has some relevance with the existing models such as FedGRU [64]. Fed-NTP shows to outperform FedGRU on the same V2V dataset. Other similar works that have focused on network traffic prediction such as FedDA [104] exist in the literature. However, as they solely focus on network traffic problems and are not intended for mobility applications, we do not review them in the survey. We encourage the reader to refer to [45] for a full survey of network traffic prediction techniques in FL.
