# A comprehensive overview and evaluation of circular RNA detection tools

CorpusID: 3743666 - [https://www.semanticscholar.org/paper/d4d5bf837c57154c2ffd4a7de6590c580db1c57c](https://www.semanticscholar.org/paper/d4d5bf837c57154c2ffd4a7de6590c580db1c57c)

Fields: Computer Science, Medicine, Biology

## (s5) Evaluation with the real datasets
(p5.0) For the real datasets, we found that the number of circRNA candidates detected correlated with the types of candidates they were able to detect. Generally, methods that were able to detect exonic, intronic, and intergenic circRNAs reported more candidates than tools that were limited to detect exonic and intronic circRNAs, but the tools that could detect exonic and intronic circRNAs predicted more candidates than tools that only reported exonic circRNAs, with the exception that KNIFE and PTESFinder tended to be sensitive at detecting exonic cir-cRNAs (Table 3). Since we had no information about the true or false circRNA candidates detected in these samples, we mainly assessed each method's performance from 4 perspectives:  Counts of candidates and true positives were calculated at increasing thresholds for the number of supporting reads, and the First, we calculated and compared the percentage of circRNA candidates detected by each method that were not depleted after RNase R treatment; though true circRNAs may not be enriched after RNase R treatment, we assumed that the higher the percentage a method achieves, the more reliable the method is. Second, for a specific sample, we calculated the proportions of circRNA candidates detected by a particular method that were also detected by every other method. Third, we assessed the sensitivity of each method at reads level, i.e., the number of backspliced junction reads per circRNA each method can recover. Fourth, we manually compiled a list of 282 circRNAs validated from 17 studies and checked how many of these verified circRNAs were detected by each method.

(p5.1) Percentage of circRNA candidates that were not depleted after RNase R treatment. After filtering for circRNA candidates with !2 supporting read counts, we normalized the backspliced junction read counts by sequencing depth [28,39]. Similar to Hansen et al. [37], the ratio of normalized read counts between RNase R-treated and untreated samples was calculated. As shown in Table 3, with approximately equal sequencing depth, RNase R treatment indeed enabled the detection of many more candidates on the Hs68 samples. This is also confirmed on the HeLa samples. Although less than half the sequencing depth of the RNase Runtreated sample, a much larger number of candidates were detected by all the tools except PTESFinder, Segemehl, and UROBORUS on the HeLa RNase R-treated sample. In addition, we found that, on both HeLa and Hs68 samples, while MapSplice was capable of recovering the largest proportion of "not depleted" candidates, CIRI was much more sensitive to detecting such candidates and ranked second regarding the proportion of "not depleted" candidates. CIRCexplorer also exhibited decent performance and was ranked third in this analysis. When precision-recall results for each tool were further computed and depicted in the figures above. (a) Positive dataset (Inset: precision above 0.99 was detailed). (b) Mixed dataset (Inset: precision above 0.97 was detailed).

(p5.2) https://doi.org/10.1371/journal.pcbi.1005420.g001 we focused on the top 100 most highly expressed candidates, as in Hansen et al. [37], we found that, while find_circ, UROBORUS, and Segemehl exhibited a relatively poor performance, most tools performed similarly, with a close percentage of "not depleted" candidates detected on HeLa (65%*75%) and Hs68 (72%*80%) samples. Proportions of circRNA candidates detected by a specific method that were also detected by every other method. Mathematically, for all the methods M, 8 i,j 2 M, if we assume N i and N j as the total number of candidates detected by method i and j, respectively, and C(i,j) as the common candidates detected by both methods, then for method i, the proportion of common candidates is P(i,j) = C(i,j)/N i , while for method j, the proportion of common candidates is P(j,i) = C(i,j)/N j . If a large proportion of candidates detected by one method are often detected by the other methods (i.e., 9 i 2 M, 8 j 2 M\{i}, we have P(i,j) ! P threshold , e.g., P threshold = 0.5), then the method would tend to have high precision. On the other hand, if candidates detected by one method frequently overlap with a large proportion of candidates detected by the other methods (i.e., 9 i 2 M, 8 j 2 M\{i}, we have P(j,i) ! P threshold , e.g., P threshold = 0.5), then the method is sensitive and probably includes many true positives. After filtering for candidates with !2 backspliced junction reads on HeLa and Hs68 RNase R-treated sample data, we assessed the proportion of candidates detected by a specific method that were also detected by We found that NCLScan was a conservative method in that a high proportion of candidates detected by this method were frequently detected by other methods, while CIRI and Segemehl were sensitive methods in that a large percentage of candidates detected by other methods were frequently detected by these 2 methods, but Segemehl tended to sacrifice much more precision, because a relatively large portion of candidates detected by this method were frequently missed by the other methods. In the case of UROBORUS, its behavior seemed to depend on the dataset. The number of candidates detected on the Hs68 RNase R-treated sample by this method was markedly smaller than by the other methods; as a consequence, a large proportion of candidates detected by the other methods were left out by this method.

(p5.3) Sensitivity at reads level. CircRNAs that are relatively abundant at a specific condition or developmental stage may possess important functions, and the number of backspliced junction reads is often used to quantify the expression level of circRNAs [3,24,27,[34][35][36]38]. Therefore, the tools that are able to recover more of such reads will better serve this purpose. Of special note, for paired-end data, when both mates from a read pair span the same backspliced junction, which can be the case for small circRNAs, different tools undertake different counting methods. To our knowledge, CIRI, circRNA_finder, CIRCexplorer, KNIFE, DCC, and NCLScan take it once, while find_circ, MapSplice, PTESFinder, Segemehl, and UROBORUS count them twice. In our analysis, we focused on circRNA candidates detected from RNase Rtreated samples. As shown in Fig 4A and 4B, consistent results were achieved on these 2 samples. Basically, these tools can be clustered into 4 groups according to their sensitivity. MapSplice, CIRI, and PTESFinder were in the most sensitive group, followed by the group of KNIFE, find_circ, and Segemehl. While CIRCexplorer, circRNA_finder, DCC (all of which Having obtained candidates with !2 supporting reads, we normalized the supporting read counts with sequencing depth and defined a candidate as "not depleted" or "significantly enriched" if its normalized read counts were not reduced or had !5 folds of enrichment after RNase R treatment, respectively. The percentage of "not depleted" candidates in the RNase R-untreated sample is provided. Among the top 10 and top 100 most highly expressed candidates, the number of candidates "significantly enriched" or "not depleted" after RNase R treatment are also provided. In this  are based on the STAR aligner), and NCLscan formed the third group, followed by the outlier of UROBORUS. In addition, the result was corroborated by similar analysis on the positive dataset ( Fig 4C). Of note, probably due to the relatively high error rate (1%) introduced into the synthetic reads on the positive dataset and the strict filtering step applied by PTESFinder (no mismatches or indels within "n" nucleotides either side of the junction position, n = 10 in this case), the performance of PTESFinder on this dataset was not as sensitive as suggested from the real datasets. This indicates that its performance was vulnerable to sequencing error and depended on the sequencing depth. Sensitivity for compiled experimentally validated circRNAs. We performed a broad survey of the published circRNA-related articles, from which we compiled a total of 282 experimentally verified circRNAs from 17 studies. Notably, they included circRNAs detected in various tissues or cell lines at different developmental stages, so many of them may not be expressed in HeLa or Hs68 samples. The detection of these validated circRNAs by each method on HeLa and Hs68 RNase R-treated samples is shown in Fig 5. It shows that varying numbers of validated circRNAs were lost upon filtering for candidates with !2 supporting reads. In addition, CIRI was found to be the most sensitive method when we only considered circRNA candidates with !2 supporting backspliced junction reads. 
## (s6) Computational cost overview
(p6.0) We evaluated the computational efficiency of each software package using the metrics of runtime, RAM consumption, and physical disk space. We found that the computational cost not only correlated with the sequencing depth, but was also affected by the abundance of circRNA candidates detected in each sample. As Fig 6A shows, when running on large datasets (i.e., Hs68_RNaseR− and Hs68_RNaseR+) with an equal number of 3 threads allocated, only CIR-Cexplorer, circRNA_finder, DCC, CIRI, and find_circ could finish within a day or so, while MapSplice took an incredibly long time of about 13 days and a month to finish Hs68_RNaseR − and Hs68_RNaseR+, respectively. The relative long runtime of MapSplice was also confirmed by the study of Hansen et al. [37]. For Central Processing Unit (CPU)-intensive tools such as MapSplice, we recommend users to run these tools on servers with adequate processors allocated to reduce running time. Regarding memory consumption, only UROBORUS and find_circ were capable of processing large datasets on a standard PC equipped with 8 gigabytes (GB) of RAM. NCLScan consistently required approximately 10 GB, while CIRCexplorer, cir-cRNA_finder, and DCC needed about 27 GB to run the underlying STAR aligner. Also, Segemehl was the least efficient, demanding about 50 GB to run all the time. For other software packages, moderate or sharp increase of memory consumption was observed when the dataset shifted from moderate to large size ( Fig 6B). In addition, MapSplice, PTESFinder, KNIFE, Segemehl, CIRI, and NCLScan were found to be the 6 least efficient software packages regarding physical disk space usage (Fig 6C), indicating that users should prepare adequate computational resources before running these pipelines on large datasets.
## (s7) Discussion
(p7.0) The global and accurate identification of circRNAs from RNA-Seq data serves as a fundamental step towards revealing their biogenesis and functions. Here, we provided an improved and easy-to-use circRNA read simulator that we believe will benefit the circRNA research community. Besides, we performed a comprehensive evaluation of 11 circRNA detection tools using synthetic and real datasets based on multiple metrics such as sensitivity, precision, F1 measure, AUC, RAM consumption, running time, and physical disk space used.

(p7.1) Taken together, we observed concordant results on the synthetic and real datasets. Generally, CIRI, CIRCexplorer, and KNIFE, which achieved better balanced performance between their precision and sensitivity, compared favorably to the other methods, whereas NCLScan and MapSplice were conservative methods with comparable precision but less favorable sensitivity. Conversely, Segemehl was sensitive but suffered with the presence of many false positives in the output. Together with find_circ and UROBORUS, these 3 methods exhibited the worst precision based on our comparisons with the background and real datasets. The performance of PTESFinder was noticeable on the synthetic dataset but less pronounced on the real datasets. Its performance tended to be variable depending on the dataset. Also, we found that CIRI and MapSplice were the most sensitive methods to recover backspliced junction reads for candidates detected. For the positive dataset used, it should be noted that we might have introduced bias into this dataset when we generated backspliced junction reads for candidates deposited in CircBase. Specifically, the HeLa circRNAs used were reported in the Salzman 2013 study [36], thus potential favor may be with KNIFE. But the high recall rate achieved by KNIFE on this dataset could also be attributed to its high sensitivity, as demonstrated in Szabo et al. [33]. For KNIFE, it also should be pointed out that the output from its de novo module was not incorporated in our study, thus the sensitivity of this tool may be underestimated in our analysis on real datasets. In addition to the performance factor, practical issues may also affect the choice of an optimal tool. For instance, Hansen et al. failed to run KNIFE and Segemehl in their study [37]. In our experience, generally, the installation process would be more complicated for tools with more dependencies (Table 4). Also, great differences in computational cost were observed among these tools (Fig 6); practitioners need to pay attention to this when analyzing large datasets. Finally, a comprehensive manual and user-friendly output would be beneficial to the users. Though most tools included detailed user guides, some only provided limited descriptions (e.g., circRNA_finder and PTESFinder). Besides, the backspliced junction reads provided critical information for further scrutinizing the authenticity of a candidate of interest; however, only some of the tools (e.g., CIRI and KNIFE) included the identifiers of such reads in the output.

(p7.2) Of all the methods evaluated here, no single tool dominates on all the metrics used, and there is still much space for further improvement regarding methods for the global detection of these noncollinear molecules from RNA-Seq data. For example, all of them were originally designed to identify circRNAs originating from the same gene locus, but a recent report [45] pointed out that circRNAs could derive from gene fusion events and potentially play a critical role in cancer pathogenesis. These fusion circRNAs are overlooked by the current methods, underscoring the complexity of the RNA world and the need to refine the existing methods or develop new ones for circRNA detection.  
## (s10) Datasets used
(p10.0) Positive dataset. The positive dataset contains a total of 1,071,113 pairs of synthetic reads, with the sequence length of 101 bp and insert size of 350 bp. These synthetic data encompass a total of 14,689 circRNA species. The number of backspliced junction read pairs supporting each circRNA ranges from 2 to 24, while the size of circRNAs varies from 51 to 846,530 bp. This simulated positive dataset was generated by an improved circRNA read simulation tool named CIRI-simulator [39], which was originally released with CIRI. To accurately generate mimicking circRNA reads, we overhauled this circRNA simulation tool. It now supports generating circRNAs deposited in CircBase, which are far more appropriate circRNA candidates than those generated from the joining of 2 randomly chosen out-of-order exons. A total of 14,689 circRNA species were produced from those reportedly detected in HeLa cells. This accurate and easy-to-use simulation tool, which we believe will benefit the circRNA research community, can be accessed at: https://github.com/linatbeishan/circRNA_detection_review. Background dataset. Simulated paired-end RNA-Seq data were generated with a widely used read simulator ART [55]. Briefly, the RefSeq mRNA sequences were downloaded from the UCSC Genome Browser first, then the simulator was executed using the downloaded sequences as input database. Indel and substitution variants were introduced into the generated reads. Specifically, to take the influence of poor sequencing quality into consideration, we shifted down the quality score of reads to increase substitution sequencing errors. Finally, a large negative dataset with sequencing length of 101 bp and insert size of 350 ± 10 bp was generated (the command used: art_illumina -ss HS25 -d simulate -na -i refMrna.fa -o simulate -l 101 -f 200 -p -m 350 -s 10 -sp -rs 20160830 -qs -13 -qs2-13).
