# Deep learning and machine vision for food processing: A survey

CorpusID: 232417802 - [https://www.semanticscholar.org/paper/59ee991e56a1894c2f50b2428ba92d4748e06a49](https://www.semanticscholar.org/paper/59ee991e56a1894c2f50b2428ba92d4748e06a49)

Fields: Computer Science, Medicine, Agricultural And Food Sciences

## (s1) Image acquisition
(p1.0) An MVS can acquire images in real-time through photos, videos and other 3-dimensional (3D) technologies. The images can be transmitted to the processing unit by cable connection, Internet/Ethernet, radiofrequency identifications, and even wireless sensor networks (Bouzembrak et al., 2019). There are a number of ways to obtain high-quality images in the food processing field, as described in the following sub-sections.
## (s2) Stereo systems
(p2.0) Stereo systems refer to a set of cameras that can measure the distance (depth) from an object to the camera. Compared with the traditional 2dimensional (2D) camera, the stereo system increases the depth of one dimension, with the goal of improving its representation of the real world (Sing Bing Kang et al., 1995). With the increasingly widespread use of machine vision, it has become more common to use stereo systems to collect depth information of the environment and then perform object recognition and environment modelling. A stereo camera prototype is used to capture a pair of images, which are utilized to estimate the dimensions of the target food (Subhi et al., 2018). Other grading techniques based on depth images have also been proposed (Su et al., 2018). For instance, a depth camera was used to obtain 3D features of potatoes such as bumps, divots, and bent shapes. The length, width, and thickness information were processed to calculate the volume and the mass of the potatoes, based on which the grading task according to mass was achieved. Subsequently, the 2D and 3D surface data were integrated to detect the irregular shape, hump, and hollow defect of potatoes. The grading accuracy of the potatoes' appearance was 88%. The acquired information was also used to rebuild a virtual reality potato model, which may be useful for food packaging research.
## (s5) X-ray
(p5.0) X-ray equipment generates X-rays and uses them to detect either metal foreign objects in food products or non-metallic foreign objects with higher density than the surrounding matrix. Therefore, X-ray technology offers a tool to detect contaminants in food. It can identify foreign objects such as metal, glass, calcified bone, stone, and highdensity plastic, thereby ensuring food safety. Grating-based X-ray imaging was used to acquire images of food products and detect foreign objects in food products (Einarsd ottir et al., 2016). Purohit et al. adopted X-ray diffraction to analyze the quality of certain food such as grains, pulses, oilseeds, and derived products (Purohit et al., 2019).
## (s6) Thermal imaging
(p6.0) Thermal imaging is a technique that detects infrared energy (heat) without contact and converts it into an electrical signal, to generate a thermal image of objects and determine their temperature. Thermal imaging has various applications in the food industry (Vadivambal et al., 2011). It can monitor and control the temperature of food during pre-treatment, pre-heating, and disinfection. It can also detect damage to fresh produce, as was for instance demonstrated for guava fruit, under different temperatures conditions where damage to guava was detected based on infrared (IR) thermography data (Gonçalves et al., 2016).
## (s7) Magnetic resonance imaging (MRI)
(p7.0) MRI is a non-destructive imaging method based on nuclear magnetic resonance (Ebrahimnejad et al., 2018). This method enables determining the characteristics of objects of interest (including food), by tracking proton motion within them with good spatial resolution (Ebrahimnejad et al., 2018). Since many raw and processed foods are heterogeneous systems, traditional research methods cannot estimate heat transfer, moisture migration, and temperature distribution within the food (Ebrahimnejad et al., 2018). MRI has also been successfully used to determine the texture of foods, such as pork meat (Caballero et al., 2017). 
## (s11) Image processing
(p11.0) Image processing is used to generate new images based on existing images, with the goal of extracting or improving the characterization of a region of interest (ROI). This process can be seen as digital signal processing and does not involve interpreting the content or meaning of the image. Image processing contains low level processing, intermediate level processing, and high level processing. The different levels of the image processing process are shown in Fig. 2 (Brosnan et al., 2004).
## (s12) Low level processing
(p12.0) Low level processing is used to pre-process images (Senni et al., 2014). When imaging objects, different imaging and sensing devices can be simultaneously used to acquire images of samples and convert them into digital forms, which can be read by a computer. The images acquired can be imperfect because of diverse reasons, including insufficient lighting, long-distance or low resolution of the imaging device, unstable viewfinder, and other interferences. Therefore, it is usually necessary to pre-process the original image to improve the final image analysis. Common image pre-processing methods include image enhancement, such as adjusting the brightness or colours of the images, cropping the images to focus on the ROI, and removing noise or digital artifacts from low light levels. Senni (2014) proposed an on-line Thermography Non-Destructive Testing method to detect whether biscuits were contaminated with foreign objects. An off-line step was designed to analyze the decay curves of foreign objects and biscuits with an infrared camera positioned at the exit of the oven when the biscuits were cooling down. Later an online system was installed with the Thermo camera located at a 75 cm distance above the conveyor belt, which had a 3m distance from the oven exit. During the image pre-processing step, the authors applied a 2D low pass-filter, a focusing filter, and a 2D Wiener filter in the frequency domain to reduce the Additive White Gaussian Noise, image blurring, and drag effects problems in the raw images.
## (s14) High level processing
(p14.0) High level processing includes image recognition and image interpretation. In this step, statistical methods or deep learning methods are commonly used to classify the target, based on the application of interest. The results of the analysis determine the processing required in the subsequent steps. Algorithms such as K-nearest neighbour (KNN), Fig. 2. Different levels in image processing process. Support Vector Machine (SVM), neural network, fuzzy logic, and a genetic algorithm can help interpret the information obtained from the image. Neural networks and fuzzy logic methods have been successfully applied to MVS in the food industry. Kashyapa (2016) proposed a machine vision-based system to remove the calyx from strawberries. All strawberries on the conveyor were first photographed and then were oriented and positioned correctly, enabling calyx removal using waterjets, before strawberries were either further processed or packaged. Misimi (2016) developed a robot called "GRIBBOT" to move chicken fillets. The robot was equipped with a gripper resembling the curved beak of vultures, called "gribb" in Northern Europe (hence the robot's name). A robot with a multi-functional gripper tool was developed to realize the objective. An image processing algorithm was designed to locate the chicken fillets and the robot provided the 3D coordinates to its gripper. The average accuracy in pixels of the camera calibration was 0.2468 (root mean squared error, RMSE). Siswantoro (2013) predicted the volume of an irregular shape food product, by extracting the silhouettes of the targets from five different aspects and utilizing the Monte Carlo method to compute the volume of the target. The author used a bounding box with a real-world coordinate system to cover the object, and subsequently generated 3D random points in the bounding box. The Monte Carlo method was used to calculate the volume via the coordinates of those 3D points.
## (s18) Foreign object detection
(p18.0) Foreign objects contamination is one of the main reasons for food recalls and rejection by consumers (Soon et al., 2020) This type of contamination harms customers and leads to loss of brand loyalty, in addition to causing large recall costs. Examples of foreign objects are insects, glass, metal, or rubber. These objects may inadvertently enter the food or package during any step of food processing. For example, small gravel or stone, insects, and twigs may enter at any step of harvesting, processing, handling, or preparation. Although the degree of danger of foreign objects depends on the size, type, hardness and clarity of the object, the ingestion of food containing foreign objects can cause choking or other diseases (Mohd Khairi et al., 2018).

(p18.1) As the food industry continues to improve the safety and quality of food products, the frequency of foreign objects in food is decreasing. At the same time, consumers are less accustomed to carefully checking for the presence of foreign objects in food and less prone to tolerating them. Detection of foreign objects with the naked eye is difficult. In contrast, emerging technologies and recognition methods can now easily detect foreign objects. Examples of such technologies include X-ray, ultrasound, thermal imaging (Mohd Khairi et al., 2018). For example, the acoustic impedance difference between meat and foreign objects enables foreign  Siswantoro et al. (2013) object detection in meat using ultrasound imaging (Xiong et al., 2017). This technique is precise and non-destructive, rendering its use promising in the food industry.
## (s21) Algorithms
(p21.0) Support Vector Machine (SVM). SVM belongs to supervised learning and classifies data by finding a hyperplane that meets the classification requirements and renders the samples in the training set as far from the hyperplane as possible (Cortes et al., 1995). Based on this principle, the classification task is converted to a convex quadratic programming problem that requires maximizing the interval, and it is also equivalent to the minimization problem of a regularized hinge loss function (Fig. 5(a)). However, the data which need to be processed are not always linearly separable. Consequently, it is arduous to find the hyperplane that satisfies the condition. Therefore, the approach is to choose a kernel function for the SVM to solve nonlinear problems. The kernel function is applied to map the input in the low-dimensional space to the high-dimensional space. Subsequently, the optimal separating hyperplane is created in the high-dimensional space to separate the nonlinear data, as shown in Fig. 5(b).
## (s24) Traditional ML in foreign object detecting
(p24.0) Lorente (2015) used a laser-light backscattering imaging system to detect the decay due to fungi in citrus fruit and achieved a maximum overall classification accuracy of 93.4%, using a Gaussian-Lorentzian cross product distribution function. Coelho (2016) adopted a binary decision tree to analyze and classify clam images captured by a transillumination technique. This online MVS was able to flatten the clam thickness and detect parasites in clams. A self-generated spatial reference system was used to classify the parasites, locate them and determine their shape. The grating-based X-ray imaging proposed by (Einarsd ottir et al., 2016) offers three modalities to detect objects (such as wood chips and insects) the textures of which cannot be detected by the classic X-ray method. Images of seven different food products containing foreign objects (such as hairs, staples, and metal pieces) were evaluated by determine the Mahalanobis distance from food models. The food models were created by fitting the food images alone or with texture features to a Gaussian Mixture Model (GMM), a linear combination of multiple Gaussian distribution functions. Einarsson (2017) proposed the Sparse Linear Discriminant Analysis (SDA) to detect foreign objects. SDA is a supervised statistical learning method and is a sparse version of the LDA (Clemmensen et al., 2011). They used two data sets, obtained using spring rolls and minced meat with foreign objects, and obtained X-ray images. Then the authors divided each image into several sub-regions, and SDA was used to classify regions containing contain foreign objects and regions which did not contain them. Dutta (2015) proposed a novel non-destructive technique to detect a neurotoxin substance called acrylamide from potato chips. This technique extracted the statistical features from the images in the spatial domain, and then used an SVM classifier to predict the presence of acrylamide in the food. The accuracy and sensitivity of the predictions were 94% and 96%, respectively. The summary of the applications of MVS with traditional machine learning methods in food processing is shown in Table 4.
## (s25) Deep learning methods
(p25.0) Deep learning, also known as a deep neural network, is a learning method for building a deep architecture and generating a model by iterating functions in multiple layers. This method was proposed by in (Hinton et al., 2006). The learning effectiveness of deep learning is superior to traditional machine learning methods, although the interpretability is not as good as traditional learning methods.
## (s27) Deep learning in food safety and quality evaluation
(p27.0) Pan (2016) utilized a technique based on the hyperspectral imaging method to detect cold injury of peach, and utilized ANN to predict quality parameters. Poonnoy (2014) adopted ANN to classify the shapes of boiled shrimps based on the Relative Internal Distance (RID) values. The four shapes considered included 'regular', 'no tails', 'one tail', and 'broken body', and the RIDs were calculated by segmenting the shrimp images and drawing the co-related lines on the segmented contour. The overall prediction accuracy of the ANN classifier was 99.80%. Shafiee (2014) used MVS to capture and perform the colour transformation of the images of honey, while they used the ANN to predict key quality indices of honey (ash content, AC, antioxidant activity, AA, and total phenolic content, TPC). Zareiforoush (2015) proposed a computer vision and metaheuristic techniques to classify milled rice grains. Their method extracted the shape and size features, texture features, and colour features to build a primary feature vector, and selected the most important features based on the "greedy hill-climbing" and backtracking algorithm. The final feature vector was then used to train the ANN, SVM, Decision Trees (DT), and BN independently. The results indicated that the deep learning architecture -ANN was the best classifier. Wan (2018) designed an MVS to acquire tomato images, and the ROIs were segmented from the whole images. Finally, a Back-Propagation Neural Network (BPNN) was used to classify the maturity level of Roma tomato and pear tomato. Huang (2016) used computer vision and NIR spectroscopy methods to obtain information about the organoleptic and structural changes of fish based on fish images. The PCA was employed to extract the most critical features from the data set, and a BackPropagation Artificial Neural Network (BP-ANN) was built to predict the fish freshness by training the algorithm to assess the extracted features.

(p27.1) Khulal (2016) compared ACO (Ant Colony Optimization)-BPANN to PCA-BPANN when extracting six textural features and predict chicken quality by quantifying the total volatile essential nitrogen content in chicken. The results showed that the performance of ACO-BPANN achieved RMSEp ¼ 6.3834 mg/100g and R ¼ 0.7542, which surpassed the performance of PCA-BPANN. Zhu (2020) developed a two-layer system to grade bananas and detect the defective spots on banana peels, with an overall accuracy of 96.4%. The first layer in their system is a SVM classifier and the second layer is a YOLOv3 (You Only Look Once Version 3) model. The YOLO model is a real-time object detection model, which is capable of detecting and locating small object locations with a high speed.  obtained pork images via a hyperspectral imaging system in the 400-1000 nm VIS-NIR range and calibrated the images with dark and white reference images. Then, the pork muscle was segmented from the background. A variable selection method called Uninformative Variable Elimination and Successive Projections Algorithm (UVE-SPA) was adopted to find the major wavelengths with co-relations with raw spectral patterns pork categories. Histogram Statistics (HS), Gray Level Co-occurrence Matrix (GLCM), and Gray Level-Gradient Co-occurrence Matrix (GLGCM) were used to extract textural features separately, and Probabilistic Neural Network (PNN) was trained to predict the fresh and frozen-thawed level of the pork. PNN is a branch of radial basis network, which is a form of a feedforward network. It belongs to a supervised network classifier based on the Bayesian minimum risk criterion. Wu (2018) also developed a method to grade rice. The authors developed a Deep-Rice system by modifying the softmax loss function in a multi-view CNN and applied the CNN model to extract the discriminative features from several angles of the rice. Additionally, the authors built a data set of rice -FIST-Rice. With 30,000 rice kernel samples, this data set can be used to research food security.
## (s29) Deep learning in foreign object detecting
(p29.0) Pujari (2013) proposed a system to detect and classify fungi contamination on commercial crops. The authors applied Discrete Wavelet Transform (DWT) and PCA to extract significant features from crops images and feed them to Mahalanobis distance and PNN classifiers. The final prediction accuracy of these two classifiers was 83.17% and 86.48%, respectively. Ma (2017) carried out a method to segment greenhouse vegetables with foliar disease spots in the real field. The authors adopted Comprehensive Color Feature (CCF), including colour information Excess Red Index (ExR), H component of HSV colour space and b* component of L*a*b* colour space, as well as region growing, to segment disease spots from clutter backgrounds. This method overcame the issues of uneven illumination and clutter background encountered in the real field. The CCF were then sent to a CNN architecture to classify the spots. The precision of this algorithm achieved an accuracy of 97.29%. Dos Santos Ferreira (2017) developed software to segment and detect weeds growing among soybean crops. This software classification function is based on a CNN trained with crop images captured in real fields by three professional drones. The system adopted the superpixel segmentation algorithm -Simple Linear Iterative Clustering (SLIC), which groups the pixels into atomic regions to replace the pixel grid, and to segment the undesirable weeds from soil and soybean crops. Ebrahimi (2014) proposed a system to distinguish wheat grains from weed seeds, with the goal of determining the purity and grade of the wheat seeds. The authors used a hybrid of Imperialist Competitive Algorithm (ICA) (which is used for optimization problems) and ANN as classifier, to identify the optimal characteristic parameters. Al-Sarayreh (2019) proposed a foreign object detection system for meat products. This system used real-time hyperspectral imaging to extract both spectral and spatial features of the target food, integrating it with a sequential deep-learning framework that is composed of region-proposal networks (RPNs) and 3D-CNNs. Rong (2019) developed two CNNs. These two models can detect foreign objects such as flesh leaf debris and metal parts in walnuts and segment the foreign objects. The accuracy of segmentation and classification are 99.5% and 95%, respectively. Table 5 summarizes recent deep learning methods applied in the field of food processing.
