# Control strategies for active lower extremity prosthetics and orthotics: a review Tucker et al. Control strategies for active lower extremity prosthetics and orthotics: a review

CorpusID: 255962315 - [https://www.semanticscholar.org/paper/a8625ac3f5d642095e8990be170a1017612aa621](https://www.semanticscholar.org/paper/a8625ac3f5d642095e8990be170a1017612aa621)

Fields: Engineering, Medicine

## (s0) Definitions, scope and prior work
(p0.0) Adopting the terminology provided by the review of Herr [10], the term exoskeleton is used to describe a device that enhances the physical capabilities of an able-bodied user, whereas the term orthosis is used to describe a device used to assist a person with an impairment of the limbs. Though exceptions exist, orthoses and exoskeletons typically act in parallel with the limb. A prosthesis is a device which supplants a missing limb, and therefore acts in series with the residual limb. http://www.jneuroengrehab.com/content/12/1/1 Several related review papers have been published in recent years that comprehensively establish the state-ofthe-art in portable and active lower limb prosthetics, orthotics and exoskeletons, mostly in terms of the design and hardware realization [10][11][12][13][14][15]. While these reviews do touch on some of the implemented control strategies, the holistic descriptions of the considered devices often do not leave room to ruminate on this particular subject. Chapters 4 and 5 of [16] provide a nice depth of theory regarding cognitive and physical human-robot interaction, which complements the breadth of practical examples provided herein.

(p0.1) Controllers for robotic prosthetic, orthotic and exoskeletal systems for the ankle were recently reviewed by Jimenez-Fabian and Verlinden [17]. The present work extends their review by considering controllers for the hip, knee and ankle, with special emphasis on P/O devices. The discussion and classification of controllers herein is structured and enhanced by the provision of a generalized control framework. Furthermore, this architecture is also proposed as a template for the development of the next generation of multifunctional controllers for active lower limb P/O devices.

(p0.2) This review also considers modalities for artificial sensory substitution and feedback. Though much of the work in this field is relatively nascent in the context of robotic lower limb P/Os, this is seen as a promising and necessary future avenue of research for the seamless integration of the device's controller with that of the human user.

(p0.3) It is duly noted that the power output characteristics vary substantially between the hip, knee, and ankle during a given activity [18]. Additionally, the nature of the physical assistance required of a prosthesis is substantially different than that of an orthosis for the corresponding joint. Though these differences fundamentally preclude the direct translation of control paradigms between devices, there are also many concepts that can be applied universally.

(p0.4) This review excludes explicit consideration of controllers for energetically net-passive devices and powered exoskeletons intended exclusively for performance augmentation of able-bodied users. Attention is only given to devices which are wearable and portable in nature, or in principle could be made as such in the near-future. This would exclude treadmill-based gait training orthoses such as the LOPES [19] and the Lokomat (Hocoma AG, Volketswil, Switzerland), which were among the classes of devices discussed in the review of Marchal-Crespo and Reinkensmeyer [20]. Furthermore, this excludes consideration of studies involving purely stimulatory devices that act in the absence of external mechanical assistance (e.g. functional electrical stimulation (FES)), which were reviewed in [21][22][23].

(p0.5) Adopting the terminology provided by the review of Herr [10], the term exoskeleton is used to describe a device that enhances the physical capabilities of an able-bodied user, whereas the term orthosis is used to describe a device used to assist a person with an impairment of the limbs. Though exceptions exist, orthoses and exoskeletons typically act in parallel with the limb. A prosthesis is a device which supplants a missing limb, and therefore acts in series with the residual limb. http://www.jneuroengrehab.com/content/12/1/1 Several related review papers have been published in recent years that comprehensively establish the state-ofthe-art in portable and active lower limb prosthetics, orthotics and exoskeletons, mostly in terms of the design and hardware realization [10][11][12][13][14][15]. While these reviews do touch on some of the implemented control strategies, the holistic descriptions of the considered devices often do not leave room to ruminate on this particular subject. Chapters 4 and 5 of [16] provide a nice depth of theory regarding cognitive and physical human-robot interaction, which complements the breadth of practical examples provided herein.

(p0.6) Controllers for robotic prosthetic, orthotic and exoskeletal systems for the ankle were recently reviewed by Jimenez-Fabian and Verlinden [17]. The present work extends their review by considering controllers for the hip, knee and ankle, with special emphasis on P/O devices. The discussion and classification of controllers herein is structured and enhanced by the provision of a generalized control framework. Furthermore, this architecture is also proposed as a template for the development of the next generation of multifunctional controllers for active lower limb P/O devices.

(p0.7) This review also considers modalities for artificial sensory substitution and feedback. Though much of the work in this field is relatively nascent in the context of robotic lower limb P/Os, this is seen as a promising and necessary future avenue of research for the seamless integration of the device's controller with that of the human user.

(p0.8) It is duly noted that the power output characteristics vary substantially between the hip, knee, and ankle during a given activity [18]. Additionally, the nature of the physical assistance required of a prosthesis is substantially different than that of an orthosis for the corresponding joint. Though these differences fundamentally preclude the direct translation of control paradigms between devices, there are also many concepts that can be applied universally.

(p0.9) This review excludes explicit consideration of controllers for energetically net-passive devices and powered exoskeletons intended exclusively for performance augmentation of able-bodied users. Attention is only given to devices which are wearable and portable in nature, or in principle could be made as such in the near-future. This would exclude treadmill-based gait training orthoses such as the LOPES [19] and the Lokomat (Hocoma AG, Volketswil, Switzerland), which were among the classes of devices discussed in the review of Marchal-Crespo and Reinkensmeyer [20]. Furthermore, this excludes consideration of studies involving purely stimulatory devices that act in the absence of external mechanical assistance (e.g. functional electrical stimulation (FES)), which were reviewed in [21][22][23].
## (s1) Generalized control framework
(p1.0) To structure the classification and discussion of the various control approaches for active lower limb P/Os, we propose the generalized framework of Figure 1. This framework was inspired by and extended from that of Varol et al. 2010 [24] to be applied to a wider range of devices (i.e. prostheses and orthoses) and joints (i.e. hip, knee and ankle). The diagram reflects the physical interaction and signal-level feedback loops underlying powered assistive devices during practical use. The major subsystems include a hierarchical control structure, the user of the P/O device, the environment through which he ambulates, and the device itself. The framework has been generalized to describe "what" each component of the hierarchical controller should do rather than "how" it should be done. Safety layers have been included to emphasize the importance of safe human-robot interaction, especially considering the amount of power such devices can generate. Furthermore, the structure of the rest of the paper follows that of this framework, which provides a holistic consideration of the challenges facing P/O control developments today.

(p1.1) Motion intentions originate with the user, whose physiological state and desires must be discerned and interpreted. In this context, the user's state refers to the pose (i.e. position and orientation) and velocity of the head, trunk and limbs, as well as the existence and status of physical interactions between the user and the environment or the user and the P/O device.

(p1.2) Motion intention estimation requires an understanding of how locomotion is nominally controlled in humans and how the user's state and intent can be sensed. The terrain features and surface conditions of the environment (i.e. the environmental state) constrain the type of movements that can be carried out, and if perceived by the controller can be taken into account. Interaction forces exist between the device, the user, and the environment, which can also be sensed as an input to the controller.

(p1.3) At the high level, the controller must perceive the user's locomotive intent. Activity mode recognition identifies the current locomotive task, such as standing, level walking and stair descent. Direct volitional control allows the user to voluntarily manipulate the device's state, i.e. joint positions, velocities and torques. It is possible to combine both of these, where the volitional control modulates the device's behavior within a particular activity.

(p1.4) The mid-level controller translates the user's motion intentions from the high level to desired device states for the low-level controller to track. It is at this level of control that the user's state within the gait cycle is determined and a control law applied. It may have the form of a position/velocity, torque, impedance, or admittance controller. http://www.jneuroengrehab.com/content/12/1/1 Figure 1 Generalized control framework for active lower limb prostheses and orthoses. The proposed framework illustrates the physical and signal-level interactions between a powered lower limb prosthetic or orthotic (P/O) device, a user, and his environment. The arrows indicate the exchange of power and information between the various components of the P/O ecosystem. A hierarchical control structure is implemented, with the estimation of the user's locomotive intent taking place at the high level, translation of the user's intent to a desired device state at the mid level, and a device-specific controller responsible for realizing the desired device state at the low level. Safety mechanisms underly all aspects of P/O design, including those which are mechanically passive and those which are actively controlled. Adapted from Varol et al. 2010 [24].

(p1.5) The desired device state is passed to the low-level controller, which computes the error with respect to the current state. It then sends commands to the actuator(s) in an effort to reduce the error. This can be achieved through feedforward or feedback control, and typically accounts for the kinematic and kinetic properties of the device.

(p1.6) Finally, the P/O device is actuated to execute these commands, and thus the control loop is closed. The device may also provide artificial sensory feedback to the user for full integration with the physiological control system.

(p1.7) Given that a robotic P/O device is likely capable of generating substantial output forces and is to be placed in close physical contact with the user, both passive and active safety mechanisms are of paramount importance and must underly all aspects of device hardware and software design. Therefore, safety considerations are intended to be implicit to all subsystems of the generalized control architecture, despite the lack of explicit connections.

(p1.8) Each subsystem within the generalized control architecture can be defined by a set of physical and signal-level inputs, by a set of processes that operate on those inputs to control the exchange of power through the subsystem, and by a set of outputs that transmit power and signals to connected subsystems. In the following sections, each of these subsystems will be discussed with regard to the roles that they play in the proposed generalized control architecture for actively assisted locomotion with mobile lower limb P/O devices.

(p1.9) To structure the classification and discussion of the various control approaches for active lower limb P/Os, we propose the generalized framework of Figure 1. This framework was inspired by and extended from that of Varol et al. 2010 [24] to be applied to a wider range of devices (i.e. prostheses and orthoses) and joints (i.e. hip, knee and ankle). The diagram reflects the physical interaction and signal-level feedback loops underlying powered assistive devices during practical use. The major subsystems include a hierarchical control structure, the user of the P/O device, the environment through which he ambulates, and the device itself. The framework has been generalized to describe "what" each component of the hierarchical controller should do rather than "how" it should be done. Safety layers have been included to emphasize the importance of safe human-robot interaction, especially considering the amount of power such devices can generate. Furthermore, the structure of the rest of the paper follows that of this framework, which provides a holistic consideration of the challenges facing P/O control developments today.

(p1.10) Motion intentions originate with the user, whose physiological state and desires must be discerned and interpreted. In this context, the user's state refers to the pose (i.e. position and orientation) and velocity of the head, trunk and limbs, as well as the existence and status of physical interactions between the user and the environment or the user and the P/O device.

(p1.11) Motion intention estimation requires an understanding of how locomotion is nominally controlled in humans and how the user's state and intent can be sensed. The terrain features and surface conditions of the environment (i.e. the environmental state) constrain the type of movements that can be carried out, and if perceived by the controller can be taken into account. Interaction forces exist between the device, the user, and the environment, which can also be sensed as an input to the controller.

(p1.12) At the high level, the controller must perceive the user's locomotive intent. Activity mode recognition identifies the current locomotive task, such as standing, level walking and stair descent. Direct volitional control allows the user to voluntarily manipulate the device's state, i.e. joint positions, velocities and torques. It is possible to combine both of these, where the volitional control modulates the device's behavior within a particular activity.

(p1.13) The mid-level controller translates the user's motion intentions from the high level to desired device states for the low-level controller to track. It is at this level of control that the user's state within the gait cycle is determined and a control law applied. It may have the form of a position/velocity, torque, impedance, or admittance controller. http://www.jneuroengrehab.com/content/12/1/1 Figure 1 Generalized control framework for active lower limb prostheses and orthoses. The proposed framework illustrates the physical and signal-level interactions between a powered lower limb prosthetic or orthotic (P/O) device, a user, and his environment. The arrows indicate the exchange of power and information between the various components of the P/O ecosystem. A hierarchical control structure is implemented, with the estimation of the user's locomotive intent taking place at the high level, translation of the user's intent to a desired device state at the mid level, and a device-specific controller responsible for realizing the desired device state at the low level. Safety mechanisms underly all aspects of P/O design, including those which are mechanically passive and those which are actively controlled. Adapted from Varol et al. 2010 [24].

(p1.14) The desired device state is passed to the low-level controller, which computes the error with respect to the current state. It then sends commands to the actuator(s) in an effort to reduce the error. This can be achieved through feedforward or feedback control, and typically accounts for the kinematic and kinetic properties of the device.

(p1.15) Finally, the P/O device is actuated to execute these commands, and thus the control loop is closed. The device may also provide artificial sensory feedback to the user for full integration with the physiological control system.

(p1.16) Given that a robotic P/O device is likely capable of generating substantial output forces and is to be placed in close physical contact with the user, both passive and active safety mechanisms are of paramount importance and must underly all aspects of device hardware and software design. Therefore, safety considerations are intended to be implicit to all subsystems of the generalized control architecture, despite the lack of explicit connections.

(p1.17) Each subsystem within the generalized control architecture can be defined by a set of physical and signal-level inputs, by a set of processes that operate on those inputs to control the exchange of power through the subsystem, and by a set of outputs that transmit power and signals to connected subsystems. In the following sections, each of these subsystems will be discussed with regard to the roles that they play in the proposed generalized control architecture for actively assisted locomotion with mobile lower limb P/O devices.
## (s4) Compensatory and assisted control of locomotion
(p4.0) In the wake of a neurologic injury or limb amputation, parts of the sensory-motor control loop responsible for locomotion may be disrupted and would need to be assisted or even taken over by a P/O device. Stemming from the inherent adaptability and plasticity of the CNS, compensatory mechanisms may arise to counteract the loss of structure and function post-disease or injury. These are typically manifested as a gait abnormality and may range from a simple limp to a total inability to walk, any of which may be considered to be the optimal outcome for a given condition [32]. Thus, the P/O controller must be robust enough to accommodate gait patterns that are potentially far-removed from the nominal condition.

(p4.1) Pathological gait has also been linked to numerous secondary conditions, including increased energy expenditure [37], increased risk and fear of falling [38,39], and degenerative bone and joint disorders (e.g. osteoarthritis, osteopenia/osteoporosis, and back pain). These will not only involve the affected limb, but also the unaffected limb and others involved in compensatory movements [15,40].

(p4.2) The purpose of a powered assistive device is to interface with the residual neuromusculoskeletal structures such that the support, control and actuation loops are reconnected. This provides the immediate benefit of reenabling locomotive ADL, and potentially the long-term benefit of rehabilitating and retraining physiological gait patterns over time. This may result in a "spiral of adaptation" as the user adapts to the new conditions imposed by the use of a P/O device, and that the device itself may need to adapt to the evolving needs of the user [41].

(p4.3) Based on the review of Marchal-Crespo and Reinkensmeyer [20], most training paradigms for gait rehabilitation can be classified into two groups. An assistive controller directly helps the user in moving their affected limbs in accordance with the desired movement. A challengebased controller could be used to provoke motor plasticity within the user by making movements more difficult through, for example, error amplification. While there remains some debate regarding which of these strategies would provide the most lasting rehabilitative benefit to the user when employed during a dedicated therapy session [42], intuition indicates that an assistive controller would provide the most utility in the performance of ADL in a real-world setting. This may at least partially explain why, within the scope of the devices covered in this review, no examples of challenge-based controllers were found.

(p4.4) It is left as an open question whether one of the control objectives of the device should be to minimize the user's exhibition of compensatory mechanisms or whether restoration of functional ADLs is sufficient. In either case, an oft-cited hypothesis motivating the development of active P/Os is that only an actuated device would be capable of providing the full power-output capabilities of the corresponding physiological joints, and could thus enable gait patterns resembling those of unaffected persons across a wide variety of activities and terrain [15,43]. The corollary is that the aforementioned secondary conditions could be prevented -providing a direct benefit for the user and a potential incentive for health care and insurance providers to opt for an active device as opposed to a passive one.

(p4.5) The take-away message is that a practical P/O controller must take into account the individual user's capabilities and physiological constraints in order to realize functional outcomes. These can be achieved both through assistance and rehabilitation, either of which may dramatically improve the mobility and quality of life for the user.

(p4.6) In the wake of a neurologic injury or limb amputation, parts of the sensory-motor control loop responsible for locomotion may be disrupted and would need to be assisted or even taken over by a P/O device. Stemming from the inherent adaptability and plasticity of the CNS, compensatory mechanisms may arise to counteract the loss of structure and function post-disease or injury. These are typically manifested as a gait abnormality and may range from a simple limp to a total inability to walk, any of which may be considered to be the optimal outcome for a given condition [32]. Thus, the P/O controller must be robust enough to accommodate gait patterns that are potentially far-removed from the nominal condition.

(p4.7) Pathological gait has also been linked to numerous secondary conditions, including increased energy expenditure [37], increased risk and fear of falling [38,39], and degenerative bone and joint disorders (e.g. osteoarthritis, osteopenia/osteoporosis, and back pain). These will not only involve the affected limb, but also the unaffected limb and others involved in compensatory movements [15,40].

(p4.8) The purpose of a powered assistive device is to interface with the residual neuromusculoskeletal structures such that the support, control and actuation loops are reconnected. This provides the immediate benefit of reenabling locomotive ADL, and potentially the long-term benefit of rehabilitating and retraining physiological gait patterns over time. This may result in a "spiral of adaptation" as the user adapts to the new conditions imposed by the use of a P/O device, and that the device itself may need to adapt to the evolving needs of the user [41].

(p4.9) Based on the review of Marchal-Crespo and Reinkensmeyer [20], most training paradigms for gait rehabilitation can be classified into two groups. An assistive controller directly helps the user in moving their affected limbs in accordance with the desired movement. A challengebased controller could be used to provoke motor plasticity within the user by making movements more difficult through, for example, error amplification. While there remains some debate regarding which of these strategies would provide the most lasting rehabilitative benefit to the user when employed during a dedicated therapy session [42], intuition indicates that an assistive controller would provide the most utility in the performance of ADL in a real-world setting. This may at least partially explain why, within the scope of the devices covered in this review, no examples of challenge-based controllers were found.

(p4.10) It is left as an open question whether one of the control objectives of the device should be to minimize the user's exhibition of compensatory mechanisms or whether restoration of functional ADLs is sufficient. In either case, an oft-cited hypothesis motivating the development of active P/Os is that only an actuated device would be capable of providing the full power-output capabilities of the corresponding physiological joints, and could thus enable gait patterns resembling those of unaffected persons across a wide variety of activities and terrain [15,43]. The corollary is that the aforementioned secondary conditions could be prevented -providing a direct benefit for the user and a potential incentive for health care and insurance providers to opt for an active device as opposed to a passive one.

(p4.11) The take-away message is that a practical P/O controller must take into account the individual user's capabilities and physiological constraints in order to realize functional outcomes. These can be achieved both through assistance and rehabilitation, either of which may dramatically improve the mobility and quality of life for the user.
## (s5) Sensor modalities for motion intention estimation
(p5.0) The intention of a user to execute a movement can be estimated through the sensing of cortical and neuromuscular activity, posture, locomotive state, and physical http://www.jneuroengrehab.com/content/12/1/1 interaction with the environment and the P/O device. The sensor modalities corresponding to each of these differ widely in terms of their relative invasiveness and the richness of the provided information [15]. Here, invasiveness is intended to indicate the relative ease (in time, effort, and risk) with which a sensor may be applied and removed. These range from completely noninvasive (e.g. fully embedded within the device) to highly invasive (e.g. surgically implanting electrode arrays in the motor cortex) [15]. The richness of information is related to both the variety of discernible activities and the specificity of motion intention obtainable through a given modality.

(p5.1) The optimization to be performed is to maximize the richness of information while minimizing the invasiveness of the required instrumentation. From a practical standpoint, the error threshold for correctly identifying the user's motion intentions needs to be such that he neither gets frustrated (or potentially injured) by incorrect estimates, nor feels like a Christmas tree due to the "decoration" of one's self with a multitude of sensors with each donning and doffing of the device. The level of invasiveness required must also correspond to the severity of the morbidities stemming from the underlying condition. Societal acceptance and cosmesis are also critical practicality issues [44].

(p5.2) Here, a summary is provided exclusively for the sensor modalities that have been documented in the literature in the context of lower limb P/O control, organized by the level at which the user's intentions are sensed.

(p5.3) The intention of a user to execute a movement can be estimated through the sensing of cortical and neuromuscular activity, posture, locomotive state, and physical http://www.jneuroengrehab.com/content/12/1/1 interaction with the environment and the P/O device. The sensor modalities corresponding to each of these differ widely in terms of their relative invasiveness and the richness of the provided information [15]. Here, invasiveness is intended to indicate the relative ease (in time, effort, and risk) with which a sensor may be applied and removed. These range from completely noninvasive (e.g. fully embedded within the device) to highly invasive (e.g. surgically implanting electrode arrays in the motor cortex) [15]. The richness of information is related to both the variety of discernible activities and the specificity of motion intention obtainable through a given modality.

(p5.4) The optimization to be performed is to maximize the richness of information while minimizing the invasiveness of the required instrumentation. From a practical standpoint, the error threshold for correctly identifying the user's motion intentions needs to be such that he neither gets frustrated (or potentially injured) by incorrect estimates, nor feels like a Christmas tree due to the "decoration" of one's self with a multitude of sensors with each donning and doffing of the device. The level of invasiveness required must also correspond to the severity of the morbidities stemming from the underlying condition. Societal acceptance and cosmesis are also critical practicality issues [44].

(p5.5) Here, a summary is provided exclusively for the sensor modalities that have been documented in the literature in the context of lower limb P/O control, organized by the level at which the user's intentions are sensed.
## (s6) Supraspinal neural activity
(p6.0) Recalling that motor intentions originate at the cortical level, several groups have investigated methods for triggering the device to provide assistance through Brain-Computer Interfaces (BCI) [45]. Recording of activity at this level has the potential to allow for a wide-variety of volitional movements, however, these may be difficult to decipher given that the brain is concurrently responsible for a multitude of tasks, including the control of the other limbs. In addition, many of the control loops responsible for physiological locomotion take place at the spinal level via reflex arcs (Figure 2), which may fundamentally preclude the use of neural activity to directly control the legs while maintaining balance during a dynamic task. However, there may still be utility in using brain activity to provide high-level commands to the device, which it will then execute (as in the shared control context promoted in [45][46][47] and demonstrated in [48,49]).

(p6.1) Functional near-infrared spectroscopy (fNIRS) uses optical light emitters and receivers placed on the scalp to sense the haemodynamic response of the brain, which correlates with brain activity. This modality is subject to non-specific brain activity, motion artifacts, significant haemodynamic delay, and requires that optodes be worn on the head. Even so, a recent pilot study investigated the use of an fNIRS-BCI to detect the preparation for movement of the hip in seated stroke subjects, which may indicate its suitability in shared control with severely impaired subjects [50].

(p6.2) Electroencephalography (EEG) uses an array of surface electrodes to non-invasively record the electrical activity of the brain as evident on the scalp [45]. The EEG electrode arrays typically used in research are built into a snug-fitting skull cap that can be extremely difficult and time-consuming to put on by oneself, especially for the patient groups whose injuries would necessitate direct cortical input to the P/O controller. This supposedly could be countered with advancements in self-contained EEG headsets designed for consumer use. The electrodes can be either dry or wet, depending on whether an electrically conductive gel is required. Signals recorded via EEG can encode a wide variety of movements with high temporal resolution.

(p6.3) In practice, the use of EEG signals demands a high level of focus and concentration from the user and is susceptible to movement artifacts, autonomic neural activity and electrical noise. Use in real-world environments is further complicated by the presence of distractions and the performance of tasks that are unrelated to locomotion. However, EEG signals could be combined with other sensory inputs in the framework of the so-called hybrid BCIs [51,52] in order to decode user's high-level commands more reliably.

(p6.4) Environmental sensing (see section below) can add an additional layer of safety in the context of shared control with BCIs, as the controller may prevent certain movements due to the presence of obstacles [47]. For example, prior to executing a high-level command (e.g. go forward, turn left), the controller would check first whether there are any terrain features in the way. Similarly, the execution of the high-level command "sit down" would not require the user to align perfectly with the chair, but would rely on the controller's ability to compensate for the misalignment. As these examples illustrate, shared control reduces cognitive workload, as the user does not need to care about the mid-to-low-level execution over long periods of time or during critical operations.

(p6.5) Implanted electrode arrays within the motor cortex enable measurements which may encode a wide variety of movements, with the noted downside of requiring a highly invasive (and still experimental) surgical procedure [15,53,54]. Such an interface may also be used to provide sensory feedback to the user, thus closing the sensory-motor control loop [54]. Intracortical electrode arrays have been successfully demonstrated to allow control of multi-degree-of-freedom reach and grasp movements with robotic arms in tetraplegic subjects [55,56], http://www.jneuroengrehab.com/content/12/1/1 though to date there are no known examples of corticallyimplanted electrodes being used to control a lower limb device in humans. Similar experiments have been done, however, in rhesus macaques to demonstrate the prediction of leg movements to control of bipedal gait in a humanoid robot [57]. It remains to be demonstrated how well this technique would translate to the control of a wearable P/O device.

(p6.6) Recalling that motor intentions originate at the cortical level, several groups have investigated methods for triggering the device to provide assistance through Brain-Computer Interfaces (BCI) [45]. Recording of activity at this level has the potential to allow for a wide-variety of volitional movements, however, these may be difficult to decipher given that the brain is concurrently responsible for a multitude of tasks, including the control of the other limbs. In addition, many of the control loops responsible for physiological locomotion take place at the spinal level via reflex arcs (Figure 2), which may fundamentally preclude the use of neural activity to directly control the legs while maintaining balance during a dynamic task. However, there may still be utility in using brain activity to provide high-level commands to the device, which it will then execute (as in the shared control context promoted in [45][46][47] and demonstrated in [48,49]).

(p6.7) Functional near-infrared spectroscopy (fNIRS) uses optical light emitters and receivers placed on the scalp to sense the haemodynamic response of the brain, which correlates with brain activity. This modality is subject to non-specific brain activity, motion artifacts, significant haemodynamic delay, and requires that optodes be worn on the head. Even so, a recent pilot study investigated the use of an fNIRS-BCI to detect the preparation for movement of the hip in seated stroke subjects, which may indicate its suitability in shared control with severely impaired subjects [50].

(p6.8) Electroencephalography (EEG) uses an array of surface electrodes to non-invasively record the electrical activity of the brain as evident on the scalp [45]. The EEG electrode arrays typically used in research are built into a snug-fitting skull cap that can be extremely difficult and time-consuming to put on by oneself, especially for the patient groups whose injuries would necessitate direct cortical input to the P/O controller. This supposedly could be countered with advancements in self-contained EEG headsets designed for consumer use. The electrodes can be either dry or wet, depending on whether an electrically conductive gel is required. Signals recorded via EEG can encode a wide variety of movements with high temporal resolution.

(p6.9) In practice, the use of EEG signals demands a high level of focus and concentration from the user and is susceptible to movement artifacts, autonomic neural activity and electrical noise. Use in real-world environments is further complicated by the presence of distractions and the performance of tasks that are unrelated to locomotion. However, EEG signals could be combined with other sensory inputs in the framework of the so-called hybrid BCIs [51,52] in order to decode user's high-level commands more reliably.

(p6.10) Environmental sensing (see section below) can add an additional layer of safety in the context of shared control with BCIs, as the controller may prevent certain movements due to the presence of obstacles [47]. For example, prior to executing a high-level command (e.g. go forward, turn left), the controller would check first whether there are any terrain features in the way. Similarly, the execution of the high-level command "sit down" would not require the user to align perfectly with the chair, but would rely on the controller's ability to compensate for the misalignment. As these examples illustrate, shared control reduces cognitive workload, as the user does not need to care about the mid-to-low-level execution over long periods of time or during critical operations.

(p6.11) Implanted electrode arrays within the motor cortex enable measurements which may encode a wide variety of movements, with the noted downside of requiring a highly invasive (and still experimental) surgical procedure [15,53,54]. Such an interface may also be used to provide sensory feedback to the user, thus closing the sensory-motor control loop [54]. Intracortical electrode arrays have been successfully demonstrated to allow control of multi-degree-of-freedom reach and grasp movements with robotic arms in tetraplegic subjects [55,56], http://www.jneuroengrehab.com/content/12/1/1 though to date there are no known examples of corticallyimplanted electrodes being used to control a lower limb device in humans. Similar experiments have been done, however, in rhesus macaques to demonstrate the prediction of leg movements to control of bipedal gait in a humanoid robot [57]. It remains to be demonstrated how well this technique would translate to the control of a wearable P/O device.
## (s7) Peripheral neural activity
(p7.0) The closer that neural activity can be recorded to the innervated muscle, the more specific the motor commands become. Also interesting is the electromechanical delay between the motor commands and the generation of force in the muscle on the order of 10s of milliseconds [58], which would provide a significant head-start to a controller based on muscle activity over one based on mechanical feedback alone [59]. This delay, however, may also be a source of instability when a device with a faster control loop is coupled to the user to provide high levels of assistance [60].
## (s8) Joint torques and positions
(p8.0) Mechanomyography (MMG) can be used to estimate the force production in muscle by measuring the sound or vibrations evident on the surface of the skin using microphones or accelerometers [68]. A potential advantage of MMG over EMG is that the muscle force estimated through MMG is less sensitive to fatigue [69]. Force production can also be estimated via changes in muscle hardness [70,71] and the volume of the muscle [72,73]. A substantial downside to all of these approaches is their high sensitivity to motion artifacts, which may be significant given the nature of the physical coupling at the user-device interface.

(p8.1) Joint torques can be estimated via inverse dynamics provided measurements of the joint positions and external forces being applied to the limbs. Wearable sensors for estimating joint positions or limb segment orientations are summarized in [74] and include goniometers, inclinometers, accelerometers, gyroscopes, magnetometers, and inertial measurement units (IMUs). Ground reaction forces can be sensed using instrumented insoles worn under the foot (reviewed in [75]) or e.g. by measuring the load in the shank of a prosthesis. A variety of foot switches can also be used to deliver binary ground contact information, for example using force-sensitive resistors, sensed air pressure in a sealed tube under the foot, or a physical switch.
## (s10) Artificial sensory feedback and substitution
(p10.0) In the nominal sensory-motor system, sensory feedback from proprioceptors, exteroceptors, and the vestibular and visual systems close the physiological control loop, allowing stable and efficient locomotion, while http://www.jneuroengrehab.com/content/12/1/1 also triggering supportive reflexes. Following neurological pathologies or amputation, this sensory feedback may be diminished or disrupted.

(p10.1) While it is possible to restore locomotive functionality without this information, artificial sensory feedback is necessary for the seamless integration of the P/O with the impaired sensory-motor system [81]. Feedback modalities may be either invasive or non-invasive, devices are stationary or portable, with the latter being more relevant for every-day use in combination with a P/O. A recent review has summarized the clinical impacts of wearable sensing and feedback technologies for normal and pathological gait [74], though the scope does not include their application to P/O devices.

(p10.2) Artificial feedback can be used for sensory substitution or augmentation. Sensory substitution replaces a lost sensor modality with another modality, e.g. by providing a sense of touch after amputation of the upper [82,83] or lower [84] extremity. Sensory augmentation complements attenuated information using the same or a different sensor modality, e.g. visual feedback about the movement of a passively guided or prosthetic limb. Both sensory substitution and augmentation exploit brain plasticity, and different sensory modalities can be used to convey information and thereby restore function.
## (s11) Environmental interaction
(p11.0) The environment provides the reaction forces responsible for the balance, support, and propulsion of the P/O user. These forces are a function of the ground contact surface condition, the slope, and the elevation of the terrain. Other forces arise due to the physical properties of the environment, such as gravity and fluid dynamic drag.

(p11.1) Obstacles are terrain features that impede motion in a particular direction, thus forcing the user to circumnavigate or to perform a compensatory motion to negotiate. Each of these environmental properties have a great influence on the stability, balance, and energy consumption of the device and of the user [18] and thus should be considered in the overall control scheme.

(p11.2) The state of the environment can be indirectly inferred based on the states of the user and of the device or directly estimated using sensors explicitly for this purpose. This provides contextual information that can be used for the strategic implementation of control policies over a time window of several steps, as well as tactical information that can directly influence the control behavior within the current step.

(p11.3) The environment provides the reaction forces responsible for the balance, support, and propulsion of the P/O user. These forces are a function of the ground contact surface condition, the slope, and the elevation of the terrain. Other forces arise due to the physical properties of the environment, such as gravity and fluid dynamic drag.

(p11.4) Obstacles are terrain features that impede motion in a particular direction, thus forcing the user to circumnavigate or to perform a compensatory motion to negotiate. Each of these environmental properties have a great influence on the stability, balance, and energy consumption of the device and of the user [18] and thus should be considered in the overall control scheme.

(p11.5) The state of the environment can be indirectly inferred based on the states of the user and of the device or directly estimated using sensors explicitly for this purpose. This provides contextual information that can be used for the strategic implementation of control policies over a time window of several steps, as well as tactical information that can directly influence the control behavior within the current step.
## (s13) Explicit environmental sensing
(p13.0) Scandaroli et al. presented a method using gyroscopes and infrared sensors [112] for estimation of the ground slope and elevation of the foot above the ground. In this application, two single-axis gyroscopes and four distancemeasuring infrared sensors were mounted underneath a prosthetic foot. So far, only bench-top test results have been presented. Zhang et al. presented a "Terrain Recognition System" comprised of a body-worn laser distance sensor and IMUs fixed to the limbs [113]. The system estimates the height and slope of the terrain and was tested using an unassisted, able-bodied user with the laser sensor attached to the waist. An array of sonar sensors and digital video cameras was used to detect obtacles, which was used in the shared control context allow/disallow user commands with a brain-controlled wheelchair [47]. This approach could easily be extended to P/O devices.

(p13.1) Relatively few examples were found regarding active lower limb P/O devices that include explicit environmental sensing and adaptation, which is likely attributable to several factors. One is that many of the documented devices are still confined to well-defined and controlled environments as imposed by hardware and experimental constraints. Another is that much of the controller development has so far focused on the mastery of executing a particular task in a particular setting. Also possible is that sensors appropriate for environmental sensing have only recently become available and practical for use in a portable device. As each of these aspects attain sufficient technological maturity to provide generalized assistance that is responsive to real-world settings, it is expected that sensing of the environmental state and its physical and signal-level influence on the user, the device and the controller will gain higher priority.

(p13.2) Scandaroli et al. presented a method using gyroscopes and infrared sensors [112] for estimation of the ground slope and elevation of the foot above the ground. In this application, two single-axis gyroscopes and four distancemeasuring infrared sensors were mounted underneath a prosthetic foot. So far, only bench-top test results have been presented. Zhang et al. presented a "Terrain Recognition System" comprised of a body-worn laser distance sensor and IMUs fixed to the limbs [113]. The system estimates the height and slope of the terrain and was tested using an unassisted, able-bodied user with the laser sensor attached to the waist. An array of sonar sensors and digital video cameras was used to detect obtacles, which was used in the shared control context allow/disallow user commands with a brain-controlled wheelchair [47]. This approach could easily be extended to P/O devices.

(p13.3) Relatively few examples were found regarding active lower limb P/O devices that include explicit environmental sensing and adaptation, which is likely attributable to several factors. One is that many of the documented devices are still confined to well-defined and controlled environments as imposed by hardware and experimental constraints. Another is that much of the controller development has so far focused on the mastery of executing a particular task in a particular setting. Also possible is that sensors appropriate for environmental sensing have only recently become available and practical for use in a portable device. As each of these aspects attain sufficient technological maturity to provide generalized assistance that is responsive to real-world settings, it is expected that sensing of the environmental state and its physical and signal-level influence on the user, the device and the controller will gain higher priority.
## (s16) High-level control
(p16.0) The purpose of the high-level controller is to perceive the locomotive intent of the user through a combination of activity mode detection and direct volitional control. Depending on the user's underlying pathology, the ability to generate, transmit, and execute appropriate locomotor commands may be impaired at some level. Therefore, once the user has provided a high-level command, the device should be responsible for the execution of movement via the mid-and low-level controllers. This shared control approach limits the cognitive burden imposed on the user [45,46].

(p16.1) The desired high-level control output allows for the device to autonomously switch between different locomotive activities, ideally without imposing any conscious inputs from the user. Activity mode recognition can be coupled with direct volitional control to provide the user the ability to modulate the device's behavior within a particular activity [120]. It is also possible to provide direct volitional control of the device in the absence of activity mode recognition.

(p16.2) The purpose of the high-level controller is to perceive the locomotive intent of the user through a combination of activity mode detection and direct volitional control. Depending on the user's underlying pathology, the ability to generate, transmit, and execute appropriate locomotor commands may be impaired at some level. Therefore, once the user has provided a high-level command, the device should be responsible for the execution of movement via the mid-and low-level controllers. This shared control approach limits the cognitive burden imposed on the user [45,46].

(p16.3) The desired high-level control output allows for the device to autonomously switch between different locomotive activities, ideally without imposing any conscious inputs from the user. Activity mode recognition can be coupled with direct volitional control to provide the user the ability to modulate the device's behavior within a particular activity [120]. It is also possible to provide direct volitional control of the device in the absence of activity mode recognition.
## (s17) Activity mode recognition
(p17.0) Activity mode recognition is what enables the high-level controller to switch between mid-level controllers that are appropriate for different locomotive tasks, such as level walking, stair ascent, and standing. The cyclic nature and long-term repeatability of various modes of gait lend themselves to automated pattern recognition techniques for classification. The inputs to the classifier include the sensed states of the user, the environment, and of the device. Important considerations for choosing a classifier include the number of activities from which to choose, the procedure required for training, its error rate in real-world conditions, signals that are required as an input, and the classification latency i.e. the time required by the classifier to reach a decision.

(p17.1) As useful definitions, Huang et al. coined the term critical time to describe the time by which a classification decision must be reached to ensure proper kinematic and kinetic transitioning between modes [59]. Thus, the classification latency must be shorter than the critical time to execute a proper transition. The critical time is an especially important constraint when transitioning between activity modes with substantially different characteristics, for example level walking to stair ascent, where excessive latency may cause a loss-of-balance. In subsequent work, Zhang et al. use the term critical error to describe any error that results in the subjective feeling of unstable balance [121]. This definition emphasizes not only that a loss-of-balance is to be avoided, but that the user must also feel secure with the performance of the device.
## (s21) Non-phase-based controllers
(p21.0) Complementary Limb Motion Estimation (CLME) infers the intended motion of affected limbs from the motion of the residual limbs, and maps this to a reference trajectory for robotic P/O joints to track [191]. This is possible due to the strong inter-joint coordination exhibited during physiological human motion [36]. The mapping is derived through regression of physiological gait recordings of healthy subjects. CLME is sometimes confounded with echo control, as described above. By contrast, CLME complements residual body motion without delay. In addition, the recorded joints and their sensed states (e.g. position, velocity, acceleration) need not directly correspond to the controlled joint, as with echo control. For example, the motion of the arms and upper body are often highly correlated to the motion of the lower limbs, and thus represent potential recording sites for CLME-based control [192]. CLME does not depend on information of the gait phase, and no change of control is necessary between stance and swing. However, instrumentation of selected residual body parts must be provided. CLME was first evaluated with the LOPES gait rehabilitation robot, showing that it can both replace (unilateral) leg function when needed [193], and be transparent when no assistance is needed [191]. Later, it was shown that an amputee subject can walk at different speeds and negotiate stairs [157] with a CLME-controlled actuated knee prosthesis. This study also demonstrated a qualitative reduction in the compensatory motion of the soundside foot relative to a commercial controlled-damping prosthesis.
## (s22) Forms of control laws
(p22.0) The output from the mid-level controller is the desired state of the device. This state may consist of a combination of joint positions, velocities, and torques. The design of the device and the actuators it contains will have a strong influence on how well the desired state can be achieved, and thus must be taken into account during the development of the mid and low level controllers.

(p22.1) Commanding joint positions or velocities is a straightforward approach to robot control, for which an abundance of theory exists. In this case, the robot is tasked with the precise reproduction of a pre-defined trajectory. This type of controller works best when the output mechanical impedance (as defined below) of the actuator is high relative to the load, thus enabling the device to reject perturbations from the user or the environment. Controlling the position or velocity of the device is useful when the desired trajectory and the interaction forces are wellcharacterized; but both of these may be difficult to predict given the dynamic nature of locomotion. Interaction with stiff objects (e.g. the environment) can lead to instability and the generation of high forces under this type of control [200]. Presumably, it is because of these issues that very few examples of assistive devices for lower limbs were found that use position control.

(p22.2) The causal dual of angular velocity is torque. Torque control is possible when the output mechanical impedance of the actuator is low relative to the load, and is useful for providing assistive forces when the desired position is ill-defined or unimportant. Problems can arise, however, when torques are applied without regard to the position of the joint (e.g. uncontrolled motions, bumping into RoM limits).

(p22.3) Impedance is defined as the transfer function between an input flow and an output effort [201]. In the domain of mechanical rotation, controlling the impedance of a joint is to control the relationship between the accepted http://www.jneuroengrehab.com/content/12/1/1 angular velocity and the yielded torque. Since the output of an impedance controlled joint is ultimately a torque, the output mechanical impedance of the actuator must be relatively low. A wide variety of virtual dynamics can be rendered under impedance control, with common intuitive examples being linear stiffness, damping and inertia. By applying passivity constraints to the rendered dynamics, the stability of the impedance-controlled system can be guaranteed [200,202].

(p22.4) A leading theory regarding physiological movement is that the CNS controls the limbs through impedance control [203,204]. It is partly due to property that human movements can be robust to perturbations despite the delays inherent to transmission of efferent and afferent signals via neural pathways, as explained in the section on nominal control of human locomotion. Thus, it is possible to realize a bio-inspired approach to P/O control through impedance modulation. An improved understanding of how humans control the impedance of the lower limbs is necessary to optimize the mechanical design and control of P/O devices and is the topic of ongoing biomechanics and neuroscience research [156,194,[205][206][207][208][209].

(p22.5) Admittance is defined as the inverse of impedance, and thus also defines a relationship between effort and flow. Admittance control has been proposed as an approach to masking the undesired dynamics (e.g. added friction and inertia) imposed by an exoskeletal device [210]. This type of control has been used with treadmillbased gait orthoses [211], but no examples of admittance control implementations with a portable device were found.

(p22.6) It is impossible to say whether it is best to control a device's position, velocity, torque, impedance, or admittance, though the choice may be constrained by the physical dynamics of the device and how it is actuated. There are distinct advantages and disadvantages to each type of control, and there may be different conditions and gait phases that lend themselves to switching between control modes [134,185,212].

(p22.7) The output from the mid-level controller is the desired state of the device. This state may consist of a combination of joint positions, velocities, and torques. The design of the device and the actuators it contains will have a strong influence on how well the desired state can be achieved, and thus must be taken into account during the development of the mid and low level controllers.

(p22.8) Commanding joint positions or velocities is a straightforward approach to robot control, for which an abundance of theory exists. In this case, the robot is tasked with the precise reproduction of a pre-defined trajectory. This type of controller works best when the output mechanical impedance (as defined below) of the actuator is high relative to the load, thus enabling the device to reject perturbations from the user or the environment. Controlling the position or velocity of the device is useful when the desired trajectory and the interaction forces are wellcharacterized; but both of these may be difficult to predict given the dynamic nature of locomotion. Interaction with stiff objects (e.g. the environment) can lead to instability and the generation of high forces under this type of control [200]. Presumably, it is because of these issues that very few examples of assistive devices for lower limbs were found that use position control.

(p22.9) The causal dual of angular velocity is torque. Torque control is possible when the output mechanical impedance of the actuator is low relative to the load, and is useful for providing assistive forces when the desired position is ill-defined or unimportant. Problems can arise, however, when torques are applied without regard to the position of the joint (e.g. uncontrolled motions, bumping into RoM limits).

(p22.10) Impedance is defined as the transfer function between an input flow and an output effort [201]. In the domain of mechanical rotation, controlling the impedance of a joint is to control the relationship between the accepted http://www.jneuroengrehab.com/content/12/1/1 angular velocity and the yielded torque. Since the output of an impedance controlled joint is ultimately a torque, the output mechanical impedance of the actuator must be relatively low. A wide variety of virtual dynamics can be rendered under impedance control, with common intuitive examples being linear stiffness, damping and inertia. By applying passivity constraints to the rendered dynamics, the stability of the impedance-controlled system can be guaranteed [200,202].

(p22.11) A leading theory regarding physiological movement is that the CNS controls the limbs through impedance control [203,204]. It is partly due to property that human movements can be robust to perturbations despite the delays inherent to transmission of efferent and afferent signals via neural pathways, as explained in the section on nominal control of human locomotion. Thus, it is possible to realize a bio-inspired approach to P/O control through impedance modulation. An improved understanding of how humans control the impedance of the lower limbs is necessary to optimize the mechanical design and control of P/O devices and is the topic of ongoing biomechanics and neuroscience research [156,194,[205][206][207][208][209].

(p22.12) Admittance is defined as the inverse of impedance, and thus also defines a relationship between effort and flow. Admittance control has been proposed as an approach to masking the undesired dynamics (e.g. added friction and inertia) imposed by an exoskeletal device [210]. This type of control has been used with treadmillbased gait orthoses [211], but no examples of admittance control implementations with a portable device were found.

(p22.13) It is impossible to say whether it is best to control a device's position, velocity, torque, impedance, or admittance, though the choice may be constrained by the physical dynamics of the device and how it is actuated. There are distinct advantages and disadvantages to each type of control, and there may be different conditions and gait phases that lend themselves to switching between control modes [134,185,212].
## (s23) Coordinated motion control and load sharing
(p23.0) Prosthetic and orthotic devices are part of an overall system involving physical interactions, and thus cannot operate as if in isolation. A coordinated mid-level control scheme is necessary whenever there are multiple actuated degrees of freedom, whether contained within one device [117,170,181,213,214] or distributed across multiple devices [176]. Uncoordinated motion between limbs and joints can result in loss of balance or falls, and so the states of each should be communicated and taken into account to prevent such an occurrence. Monitoring of the state of the user (e.g. ground contact state, joint positions) also provides relevant information to the controller.

(p23.1) It should also be noted that the joints in the human body are subject to biarticular coupling on both a mechanical and neural level [215]. As a result, the realizable voluntary torque output and range-of-motion (RoM) of the user's joints are functions of posture, which potentially involves joints that are not specifically actuated by the device. Considering this, the mid-level controller should take into account the configuration of the user to ensure that the device does not over-power the joint nor exceed his RoM.
## (s24) Low-level control
(p24.0) The purpose of the low-level controller (Figure 1) is to calculate the error between the device's current and desired states (i.e. the output from the mid-level controller) and to drive the actuator to reduce this error. This executionlevel of control tends to be highly device-specific, and may rely on a combination of feedforward and feedback loops. http://www.jneuroengrehab.com/content/12/1/1 Feedforward control requires some form of model to predict the system's future state based on the past and current set of inputs and device state. Such control inputs can be effective at reducing undesired interaction forces due to the added mass, inertia, and friction of the device [178].

(p24.1) Feedback controllers do not require a model of the system per se, but do require an estimate of the current state. The controller compares this with the desired state of the device and modulates the power input to the device to drive any discrepancy to zero. A wide variety of control techniques can be used to achieve this, the details of which are left to any reputable controls textbook. Many classical control strategies employ negative feedback, though the Berkeley Lower Extremity Exoskeleton (BLEEX) employs a positive feedback loop [220,221]. In this example, the net effect of the positive feedback is to increase the controller's sensitivity to the user's interactions without requiring force sensing between the user and the device. The trade-off is that very precise models of the device's dynamics are required for each of the bilateral ground contact states. This was counteracted using the hybrid control scheme outlined in subsequent work [214].

(p24.2) The physical configuration and dynamics (i.e. friction, inertia, actuator power output) of the device will fundamentally limit its ability to stably track a desired output trajectory. The performance of digitally-controlled systems is further constrained by sensor noise, signal quantization, discrete sampling effects, and control loop execution times. The use of passivity constraints (i.e. that the device is controlled to store or dissipate energy, but not add) provides a means to guarantee the stability of the device as it interacts with the user and his environment [182,200,202].

(p24.3) The purpose of the low-level controller (Figure 1) is to calculate the error between the device's current and desired states (i.e. the output from the mid-level controller) and to drive the actuator to reduce this error. This executionlevel of control tends to be highly device-specific, and may rely on a combination of feedforward and feedback loops. http://www.jneuroengrehab.com/content/12/1/1 Feedforward control requires some form of model to predict the system's future state based on the past and current set of inputs and device state. Such control inputs can be effective at reducing undesired interaction forces due to the added mass, inertia, and friction of the device [178].

(p24.4) Feedback controllers do not require a model of the system per se, but do require an estimate of the current state. The controller compares this with the desired state of the device and modulates the power input to the device to drive any discrepancy to zero. A wide variety of control techniques can be used to achieve this, the details of which are left to any reputable controls textbook. Many classical control strategies employ negative feedback, though the Berkeley Lower Extremity Exoskeleton (BLEEX) employs a positive feedback loop [220,221]. In this example, the net effect of the positive feedback is to increase the controller's sensitivity to the user's interactions without requiring force sensing between the user and the device. The trade-off is that very precise models of the device's dynamics are required for each of the bilateral ground contact states. This was counteracted using the hybrid control scheme outlined in subsequent work [214].

(p24.5) The physical configuration and dynamics (i.e. friction, inertia, actuator power output) of the device will fundamentally limit its ability to stably track a desired output trajectory. The performance of digitally-controlled systems is further constrained by sensor noise, signal quantization, discrete sampling effects, and control loop execution times. The use of passivity constraints (i.e. that the device is controlled to store or dissipate energy, but not add) provides a means to guarantee the stability of the device as it interacts with the user and his environment [182,200,202].
## (s25) The P/O device
(p25.0) The device represents the hardware embodiment of the robotic P/O. This includes the device's physical structure, actuators, embedded sensors, control system, energy storage, and power amplifiers. While the mechanical design and implementation of P/O devices is beyond the scope of this review, the hardware must be taken into account as it heavily influences the low-level control possibilities. For example, it may be difficult and inefficient to render forces with an assistive device whose actuator output impedance is high [197], conversely the maximum torque output, controllable bandwidth and the dynamic range of renderable impedance (i.e. Z-width) are reduced for an actuator with low output impedance [202].

(p25.1) Additional considerations are the performance limitations and saturation effects of the actuator and power source [14,60,170]. Even state-of-the-art portable devices must be driven beyond their continuous operating range to achieve the power outputs required during energetically demanding activities, such as sit-to-stand, stair ascent, running, or jumping [61,217]. While this is generally acceptable for short bursts, it may be necessary for the controller to derate the actuator if these conditions are sustained for long periods.

(p25.2) A further optimization for the controller may be the energy efficiency of operation. In addition to minimizing the energetic expenditure of the user, the device may also be tasked with minimizing its own energy consumption, thus extending its useful range of operation. Portable devices are inherently limited in their energy storage capabilities, and as such the conversion of power to a usable form should be as efficient as possible. Aside from improvements in amplifier or transmission technology, energy-saving approaches include the use of passive compliance, e.g. [3,205,222], mechanically-variable impedance actuation [223,224] and the reciprocal transfer of power between joints [213,[225][226][227][228] or between portions of the gait cycle [229][230][231].
## (s26) Safety mechanisms
(p26.0) Considerations of safety must underly nearly all aspects of the mechanical design and control of P/O devices. These must include safety of the subject, his environment, and of the device itself. This is especially important for powered devices, which may be capable of generating destructive forces and whose controlled output behavior may not always be in agreement with the user's intent. The identification, quantification and mitigation of risks is thus a critical aspect of device development.

(p26.1) Common risks to locomotion include slipping, tripping and falling, all of which may be exacerbated by the presence of the P/O device. The cause of such incidents may be internal to the device (e.g. controller failure) or due to external factors, such as encountering unexpected terrain. The severity of these risks spans a wide range, and must be weighed against the probability that they will occur, and whether such a failure is detectable. The risks are also not limited to physical harm, but may also include social, emotional, and psychological effects [38,39].
## (s29) Definitions, scope and prior work
(p29.0) Adopting the terminology provided by the review of Herr [10], the term exoskeleton is used to describe a device that enhances the physical capabilities of an able-bodied user, whereas the term orthosis is used to describe a device used to assist a person with an impairment of the limbs. Though exceptions exist, orthoses and exoskeletons typically act in parallel with the limb. A prosthesis is a device which supplants a missing limb, and therefore acts in series with the residual limb. http://www.jneuroengrehab.com/content/12/1/1 Several related review papers have been published in recent years that comprehensively establish the state-ofthe-art in portable and active lower limb prosthetics, orthotics and exoskeletons, mostly in terms of the design and hardware realization [10][11][12][13][14][15]. While these reviews do touch on some of the implemented control strategies, the holistic descriptions of the considered devices often do not leave room to ruminate on this particular subject. Chapters 4 and 5 of [16] provide a nice depth of theory regarding cognitive and physical human-robot interaction, which complements the breadth of practical examples provided herein.

(p29.1) Controllers for robotic prosthetic, orthotic and exoskeletal systems for the ankle were recently reviewed by Jimenez-Fabian and Verlinden [17]. The present work extends their review by considering controllers for the hip, knee and ankle, with special emphasis on P/O devices. The discussion and classification of controllers herein is structured and enhanced by the provision of a generalized control framework. Furthermore, this architecture is also proposed as a template for the development of the next generation of multifunctional controllers for active lower limb P/O devices.

(p29.2) This review also considers modalities for artificial sensory substitution and feedback. Though much of the work in this field is relatively nascent in the context of robotic lower limb P/Os, this is seen as a promising and necessary future avenue of research for the seamless integration of the device's controller with that of the human user.

(p29.3) It is duly noted that the power output characteristics vary substantially between the hip, knee, and ankle during a given activity [18]. Additionally, the nature of the physical assistance required of a prosthesis is substantially different than that of an orthosis for the corresponding joint. Though these differences fundamentally preclude the direct translation of control paradigms between devices, there are also many concepts that can be applied universally.

(p29.4) This review excludes explicit consideration of controllers for energetically net-passive devices and powered exoskeletons intended exclusively for performance augmentation of able-bodied users. Attention is only given to devices which are wearable and portable in nature, or in principle could be made as such in the near-future. This would exclude treadmill-based gait training orthoses such as the LOPES [19] and the Lokomat (Hocoma AG, Volketswil, Switzerland), which were among the classes of devices discussed in the review of Marchal-Crespo and Reinkensmeyer [20]. Furthermore, this excludes consideration of studies involving purely stimulatory devices that act in the absence of external mechanical assistance (e.g. functional electrical stimulation (FES)), which were reviewed in [21][22][23].

(p29.5) Adopting the terminology provided by the review of Herr [10], the term exoskeleton is used to describe a device that enhances the physical capabilities of an able-bodied user, whereas the term orthosis is used to describe a device used to assist a person with an impairment of the limbs. Though exceptions exist, orthoses and exoskeletons typically act in parallel with the limb. A prosthesis is a device which supplants a missing limb, and therefore acts in series with the residual limb. http://www.jneuroengrehab.com/content/12/1/1 Several related review papers have been published in recent years that comprehensively establish the state-ofthe-art in portable and active lower limb prosthetics, orthotics and exoskeletons, mostly in terms of the design and hardware realization [10][11][12][13][14][15]. While these reviews do touch on some of the implemented control strategies, the holistic descriptions of the considered devices often do not leave room to ruminate on this particular subject. Chapters 4 and 5 of [16] provide a nice depth of theory regarding cognitive and physical human-robot interaction, which complements the breadth of practical examples provided herein.

(p29.6) Controllers for robotic prosthetic, orthotic and exoskeletal systems for the ankle were recently reviewed by Jimenez-Fabian and Verlinden [17]. The present work extends their review by considering controllers for the hip, knee and ankle, with special emphasis on P/O devices. The discussion and classification of controllers herein is structured and enhanced by the provision of a generalized control framework. Furthermore, this architecture is also proposed as a template for the development of the next generation of multifunctional controllers for active lower limb P/O devices.

(p29.7) This review also considers modalities for artificial sensory substitution and feedback. Though much of the work in this field is relatively nascent in the context of robotic lower limb P/Os, this is seen as a promising and necessary future avenue of research for the seamless integration of the device's controller with that of the human user.

(p29.8) It is duly noted that the power output characteristics vary substantially between the hip, knee, and ankle during a given activity [18]. Additionally, the nature of the physical assistance required of a prosthesis is substantially different than that of an orthosis for the corresponding joint. Though these differences fundamentally preclude the direct translation of control paradigms between devices, there are also many concepts that can be applied universally.

(p29.9) This review excludes explicit consideration of controllers for energetically net-passive devices and powered exoskeletons intended exclusively for performance augmentation of able-bodied users. Attention is only given to devices which are wearable and portable in nature, or in principle could be made as such in the near-future. This would exclude treadmill-based gait training orthoses such as the LOPES [19] and the Lokomat (Hocoma AG, Volketswil, Switzerland), which were among the classes of devices discussed in the review of Marchal-Crespo and Reinkensmeyer [20]. Furthermore, this excludes consideration of studies involving purely stimulatory devices that act in the absence of external mechanical assistance (e.g. functional electrical stimulation (FES)), which were reviewed in [21][22][23].
## (s30) Generalized control framework
(p30.0) To structure the classification and discussion of the various control approaches for active lower limb P/Os, we propose the generalized framework of Figure 1. This framework was inspired by and extended from that of Varol et al. 2010 [24] to be applied to a wider range of devices (i.e. prostheses and orthoses) and joints (i.e. hip, knee and ankle). The diagram reflects the physical interaction and signal-level feedback loops underlying powered assistive devices during practical use. The major subsystems include a hierarchical control structure, the user of the P/O device, the environment through which he ambulates, and the device itself. The framework has been generalized to describe "what" each component of the hierarchical controller should do rather than "how" it should be done. Safety layers have been included to emphasize the importance of safe human-robot interaction, especially considering the amount of power such devices can generate. Furthermore, the structure of the rest of the paper follows that of this framework, which provides a holistic consideration of the challenges facing P/O control developments today.

(p30.1) Motion intentions originate with the user, whose physiological state and desires must be discerned and interpreted. In this context, the user's state refers to the pose (i.e. position and orientation) and velocity of the head, trunk and limbs, as well as the existence and status of physical interactions between the user and the environment or the user and the P/O device.

(p30.2) Motion intention estimation requires an understanding of how locomotion is nominally controlled in humans and how the user's state and intent can be sensed. The terrain features and surface conditions of the environment (i.e. the environmental state) constrain the type of movements that can be carried out, and if perceived by the controller can be taken into account. Interaction forces exist between the device, the user, and the environment, which can also be sensed as an input to the controller.

(p30.3) At the high level, the controller must perceive the user's locomotive intent. Activity mode recognition identifies the current locomotive task, such as standing, level walking and stair descent. Direct volitional control allows the user to voluntarily manipulate the device's state, i.e. joint positions, velocities and torques. It is possible to combine both of these, where the volitional control modulates the device's behavior within a particular activity.

(p30.4) The mid-level controller translates the user's motion intentions from the high level to desired device states for the low-level controller to track. It is at this level of control that the user's state within the gait cycle is determined and a control law applied. It may have the form of a position/velocity, torque, impedance, or admittance controller. http://www.jneuroengrehab.com/content/12/1/1 Figure 1 Generalized control framework for active lower limb prostheses and orthoses. The proposed framework illustrates the physical and signal-level interactions between a powered lower limb prosthetic or orthotic (P/O) device, a user, and his environment. The arrows indicate the exchange of power and information between the various components of the P/O ecosystem. A hierarchical control structure is implemented, with the estimation of the user's locomotive intent taking place at the high level, translation of the user's intent to a desired device state at the mid level, and a device-specific controller responsible for realizing the desired device state at the low level. Safety mechanisms underly all aspects of P/O design, including those which are mechanically passive and those which are actively controlled. Adapted from Varol et al. 2010 [24].

(p30.5) The desired device state is passed to the low-level controller, which computes the error with respect to the current state. It then sends commands to the actuator(s) in an effort to reduce the error. This can be achieved through feedforward or feedback control, and typically accounts for the kinematic and kinetic properties of the device.

(p30.6) Finally, the P/O device is actuated to execute these commands, and thus the control loop is closed. The device may also provide artificial sensory feedback to the user for full integration with the physiological control system.

(p30.7) Given that a robotic P/O device is likely capable of generating substantial output forces and is to be placed in close physical contact with the user, both passive and active safety mechanisms are of paramount importance and must underly all aspects of device hardware and software design. Therefore, safety considerations are intended to be implicit to all subsystems of the generalized control architecture, despite the lack of explicit connections.

(p30.8) Each subsystem within the generalized control architecture can be defined by a set of physical and signal-level inputs, by a set of processes that operate on those inputs to control the exchange of power through the subsystem, and by a set of outputs that transmit power and signals to connected subsystems. In the following sections, each of these subsystems will be discussed with regard to the roles that they play in the proposed generalized control architecture for actively assisted locomotion with mobile lower limb P/O devices.

(p30.9) To structure the classification and discussion of the various control approaches for active lower limb P/Os, we propose the generalized framework of Figure 1. This framework was inspired by and extended from that of Varol et al. 2010 [24] to be applied to a wider range of devices (i.e. prostheses and orthoses) and joints (i.e. hip, knee and ankle). The diagram reflects the physical interaction and signal-level feedback loops underlying powered assistive devices during practical use. The major subsystems include a hierarchical control structure, the user of the P/O device, the environment through which he ambulates, and the device itself. The framework has been generalized to describe "what" each component of the hierarchical controller should do rather than "how" it should be done. Safety layers have been included to emphasize the importance of safe human-robot interaction, especially considering the amount of power such devices can generate. Furthermore, the structure of the rest of the paper follows that of this framework, which provides a holistic consideration of the challenges facing P/O control developments today.

(p30.10) Motion intentions originate with the user, whose physiological state and desires must be discerned and interpreted. In this context, the user's state refers to the pose (i.e. position and orientation) and velocity of the head, trunk and limbs, as well as the existence and status of physical interactions between the user and the environment or the user and the P/O device.

(p30.11) Motion intention estimation requires an understanding of how locomotion is nominally controlled in humans and how the user's state and intent can be sensed. The terrain features and surface conditions of the environment (i.e. the environmental state) constrain the type of movements that can be carried out, and if perceived by the controller can be taken into account. Interaction forces exist between the device, the user, and the environment, which can also be sensed as an input to the controller.

(p30.12) At the high level, the controller must perceive the user's locomotive intent. Activity mode recognition identifies the current locomotive task, such as standing, level walking and stair descent. Direct volitional control allows the user to voluntarily manipulate the device's state, i.e. joint positions, velocities and torques. It is possible to combine both of these, where the volitional control modulates the device's behavior within a particular activity.

(p30.13) The mid-level controller translates the user's motion intentions from the high level to desired device states for the low-level controller to track. It is at this level of control that the user's state within the gait cycle is determined and a control law applied. It may have the form of a position/velocity, torque, impedance, or admittance controller. http://www.jneuroengrehab.com/content/12/1/1 Figure 1 Generalized control framework for active lower limb prostheses and orthoses. The proposed framework illustrates the physical and signal-level interactions between a powered lower limb prosthetic or orthotic (P/O) device, a user, and his environment. The arrows indicate the exchange of power and information between the various components of the P/O ecosystem. A hierarchical control structure is implemented, with the estimation of the user's locomotive intent taking place at the high level, translation of the user's intent to a desired device state at the mid level, and a device-specific controller responsible for realizing the desired device state at the low level. Safety mechanisms underly all aspects of P/O design, including those which are mechanically passive and those which are actively controlled. Adapted from Varol et al. 2010 [24].

(p30.14) The desired device state is passed to the low-level controller, which computes the error with respect to the current state. It then sends commands to the actuator(s) in an effort to reduce the error. This can be achieved through feedforward or feedback control, and typically accounts for the kinematic and kinetic properties of the device.

(p30.15) Finally, the P/O device is actuated to execute these commands, and thus the control loop is closed. The device may also provide artificial sensory feedback to the user for full integration with the physiological control system.

(p30.16) Given that a robotic P/O device is likely capable of generating substantial output forces and is to be placed in close physical contact with the user, both passive and active safety mechanisms are of paramount importance and must underly all aspects of device hardware and software design. Therefore, safety considerations are intended to be implicit to all subsystems of the generalized control architecture, despite the lack of explicit connections.

(p30.17) Each subsystem within the generalized control architecture can be defined by a set of physical and signal-level inputs, by a set of processes that operate on those inputs to control the exchange of power through the subsystem, and by a set of outputs that transmit power and signals to connected subsystems. In the following sections, each of these subsystems will be discussed with regard to the roles that they play in the proposed generalized control architecture for actively assisted locomotion with mobile lower limb P/O devices.
## (s33) Compensatory and assisted control of locomotion
(p33.0) In the wake of a neurologic injury or limb amputation, parts of the sensory-motor control loop responsible for locomotion may be disrupted and would need to be assisted or even taken over by a P/O device. Stemming from the inherent adaptability and plasticity of the CNS, compensatory mechanisms may arise to counteract the loss of structure and function post-disease or injury. These are typically manifested as a gait abnormality and may range from a simple limp to a total inability to walk, any of which may be considered to be the optimal outcome for a given condition [32]. Thus, the P/O controller must be robust enough to accommodate gait patterns that are potentially far-removed from the nominal condition.

(p33.1) Pathological gait has also been linked to numerous secondary conditions, including increased energy expenditure [37], increased risk and fear of falling [38,39], and degenerative bone and joint disorders (e.g. osteoarthritis, osteopenia/osteoporosis, and back pain). These will not only involve the affected limb, but also the unaffected limb and others involved in compensatory movements [15,40].

(p33.2) The purpose of a powered assistive device is to interface with the residual neuromusculoskeletal structures such that the support, control and actuation loops are reconnected. This provides the immediate benefit of reenabling locomotive ADL, and potentially the long-term benefit of rehabilitating and retraining physiological gait patterns over time. This may result in a "spiral of adaptation" as the user adapts to the new conditions imposed by the use of a P/O device, and that the device itself may need to adapt to the evolving needs of the user [41].

(p33.3) Based on the review of Marchal-Crespo and Reinkensmeyer [20], most training paradigms for gait rehabilitation can be classified into two groups. An assistive controller directly helps the user in moving their affected limbs in accordance with the desired movement. A challengebased controller could be used to provoke motor plasticity within the user by making movements more difficult through, for example, error amplification. While there remains some debate regarding which of these strategies would provide the most lasting rehabilitative benefit to the user when employed during a dedicated therapy session [42], intuition indicates that an assistive controller would provide the most utility in the performance of ADL in a real-world setting. This may at least partially explain why, within the scope of the devices covered in this review, no examples of challenge-based controllers were found.

(p33.4) It is left as an open question whether one of the control objectives of the device should be to minimize the user's exhibition of compensatory mechanisms or whether restoration of functional ADLs is sufficient. In either case, an oft-cited hypothesis motivating the development of active P/Os is that only an actuated device would be capable of providing the full power-output capabilities of the corresponding physiological joints, and could thus enable gait patterns resembling those of unaffected persons across a wide variety of activities and terrain [15,43]. The corollary is that the aforementioned secondary conditions could be prevented -providing a direct benefit for the user and a potential incentive for health care and insurance providers to opt for an active device as opposed to a passive one.

(p33.5) The take-away message is that a practical P/O controller must take into account the individual user's capabilities and physiological constraints in order to realize functional outcomes. These can be achieved both through assistance and rehabilitation, either of which may dramatically improve the mobility and quality of life for the user.

(p33.6) In the wake of a neurologic injury or limb amputation, parts of the sensory-motor control loop responsible for locomotion may be disrupted and would need to be assisted or even taken over by a P/O device. Stemming from the inherent adaptability and plasticity of the CNS, compensatory mechanisms may arise to counteract the loss of structure and function post-disease or injury. These are typically manifested as a gait abnormality and may range from a simple limp to a total inability to walk, any of which may be considered to be the optimal outcome for a given condition [32]. Thus, the P/O controller must be robust enough to accommodate gait patterns that are potentially far-removed from the nominal condition.

(p33.7) Pathological gait has also been linked to numerous secondary conditions, including increased energy expenditure [37], increased risk and fear of falling [38,39], and degenerative bone and joint disorders (e.g. osteoarthritis, osteopenia/osteoporosis, and back pain). These will not only involve the affected limb, but also the unaffected limb and others involved in compensatory movements [15,40].

(p33.8) The purpose of a powered assistive device is to interface with the residual neuromusculoskeletal structures such that the support, control and actuation loops are reconnected. This provides the immediate benefit of reenabling locomotive ADL, and potentially the long-term benefit of rehabilitating and retraining physiological gait patterns over time. This may result in a "spiral of adaptation" as the user adapts to the new conditions imposed by the use of a P/O device, and that the device itself may need to adapt to the evolving needs of the user [41].

(p33.9) Based on the review of Marchal-Crespo and Reinkensmeyer [20], most training paradigms for gait rehabilitation can be classified into two groups. An assistive controller directly helps the user in moving their affected limbs in accordance with the desired movement. A challengebased controller could be used to provoke motor plasticity within the user by making movements more difficult through, for example, error amplification. While there remains some debate regarding which of these strategies would provide the most lasting rehabilitative benefit to the user when employed during a dedicated therapy session [42], intuition indicates that an assistive controller would provide the most utility in the performance of ADL in a real-world setting. This may at least partially explain why, within the scope of the devices covered in this review, no examples of challenge-based controllers were found.

(p33.10) It is left as an open question whether one of the control objectives of the device should be to minimize the user's exhibition of compensatory mechanisms or whether restoration of functional ADLs is sufficient. In either case, an oft-cited hypothesis motivating the development of active P/Os is that only an actuated device would be capable of providing the full power-output capabilities of the corresponding physiological joints, and could thus enable gait patterns resembling those of unaffected persons across a wide variety of activities and terrain [15,43]. The corollary is that the aforementioned secondary conditions could be prevented -providing a direct benefit for the user and a potential incentive for health care and insurance providers to opt for an active device as opposed to a passive one.

(p33.11) The take-away message is that a practical P/O controller must take into account the individual user's capabilities and physiological constraints in order to realize functional outcomes. These can be achieved both through assistance and rehabilitation, either of which may dramatically improve the mobility and quality of life for the user.
## (s34) Sensor modalities for motion intention estimation
(p34.0) The intention of a user to execute a movement can be estimated through the sensing of cortical and neuromuscular activity, posture, locomotive state, and physical http://www.jneuroengrehab.com/content/12/1/1 interaction with the environment and the P/O device. The sensor modalities corresponding to each of these differ widely in terms of their relative invasiveness and the richness of the provided information [15]. Here, invasiveness is intended to indicate the relative ease (in time, effort, and risk) with which a sensor may be applied and removed. These range from completely noninvasive (e.g. fully embedded within the device) to highly invasive (e.g. surgically implanting electrode arrays in the motor cortex) [15]. The richness of information is related to both the variety of discernible activities and the specificity of motion intention obtainable through a given modality.

(p34.1) The optimization to be performed is to maximize the richness of information while minimizing the invasiveness of the required instrumentation. From a practical standpoint, the error threshold for correctly identifying the user's motion intentions needs to be such that he neither gets frustrated (or potentially injured) by incorrect estimates, nor feels like a Christmas tree due to the "decoration" of one's self with a multitude of sensors with each donning and doffing of the device. The level of invasiveness required must also correspond to the severity of the morbidities stemming from the underlying condition. Societal acceptance and cosmesis are also critical practicality issues [44].

(p34.2) Here, a summary is provided exclusively for the sensor modalities that have been documented in the literature in the context of lower limb P/O control, organized by the level at which the user's intentions are sensed.

(p34.3) The intention of a user to execute a movement can be estimated through the sensing of cortical and neuromuscular activity, posture, locomotive state, and physical http://www.jneuroengrehab.com/content/12/1/1 interaction with the environment and the P/O device. The sensor modalities corresponding to each of these differ widely in terms of their relative invasiveness and the richness of the provided information [15]. Here, invasiveness is intended to indicate the relative ease (in time, effort, and risk) with which a sensor may be applied and removed. These range from completely noninvasive (e.g. fully embedded within the device) to highly invasive (e.g. surgically implanting electrode arrays in the motor cortex) [15]. The richness of information is related to both the variety of discernible activities and the specificity of motion intention obtainable through a given modality.

(p34.4) The optimization to be performed is to maximize the richness of information while minimizing the invasiveness of the required instrumentation. From a practical standpoint, the error threshold for correctly identifying the user's motion intentions needs to be such that he neither gets frustrated (or potentially injured) by incorrect estimates, nor feels like a Christmas tree due to the "decoration" of one's self with a multitude of sensors with each donning and doffing of the device. The level of invasiveness required must also correspond to the severity of the morbidities stemming from the underlying condition. Societal acceptance and cosmesis are also critical practicality issues [44].

(p34.5) Here, a summary is provided exclusively for the sensor modalities that have been documented in the literature in the context of lower limb P/O control, organized by the level at which the user's intentions are sensed.
## (s35) Supraspinal neural activity
(p35.0) Recalling that motor intentions originate at the cortical level, several groups have investigated methods for triggering the device to provide assistance through Brain-Computer Interfaces (BCI) [45]. Recording of activity at this level has the potential to allow for a wide-variety of volitional movements, however, these may be difficult to decipher given that the brain is concurrently responsible for a multitude of tasks, including the control of the other limbs. In addition, many of the control loops responsible for physiological locomotion take place at the spinal level via reflex arcs (Figure 2), which may fundamentally preclude the use of neural activity to directly control the legs while maintaining balance during a dynamic task. However, there may still be utility in using brain activity to provide high-level commands to the device, which it will then execute (as in the shared control context promoted in [45][46][47] and demonstrated in [48,49]).

(p35.1) Functional near-infrared spectroscopy (fNIRS) uses optical light emitters and receivers placed on the scalp to sense the haemodynamic response of the brain, which correlates with brain activity. This modality is subject to non-specific brain activity, motion artifacts, significant haemodynamic delay, and requires that optodes be worn on the head. Even so, a recent pilot study investigated the use of an fNIRS-BCI to detect the preparation for movement of the hip in seated stroke subjects, which may indicate its suitability in shared control with severely impaired subjects [50].

(p35.2) Electroencephalography (EEG) uses an array of surface electrodes to non-invasively record the electrical activity of the brain as evident on the scalp [45]. The EEG electrode arrays typically used in research are built into a snug-fitting skull cap that can be extremely difficult and time-consuming to put on by oneself, especially for the patient groups whose injuries would necessitate direct cortical input to the P/O controller. This supposedly could be countered with advancements in self-contained EEG headsets designed for consumer use. The electrodes can be either dry or wet, depending on whether an electrically conductive gel is required. Signals recorded via EEG can encode a wide variety of movements with high temporal resolution.

(p35.3) In practice, the use of EEG signals demands a high level of focus and concentration from the user and is susceptible to movement artifacts, autonomic neural activity and electrical noise. Use in real-world environments is further complicated by the presence of distractions and the performance of tasks that are unrelated to locomotion. However, EEG signals could be combined with other sensory inputs in the framework of the so-called hybrid BCIs [51,52] in order to decode user's high-level commands more reliably.

(p35.4) Environmental sensing (see section below) can add an additional layer of safety in the context of shared control with BCIs, as the controller may prevent certain movements due to the presence of obstacles [47]. For example, prior to executing a high-level command (e.g. go forward, turn left), the controller would check first whether there are any terrain features in the way. Similarly, the execution of the high-level command "sit down" would not require the user to align perfectly with the chair, but would rely on the controller's ability to compensate for the misalignment. As these examples illustrate, shared control reduces cognitive workload, as the user does not need to care about the mid-to-low-level execution over long periods of time or during critical operations.

(p35.5) Implanted electrode arrays within the motor cortex enable measurements which may encode a wide variety of movements, with the noted downside of requiring a highly invasive (and still experimental) surgical procedure [15,53,54]. Such an interface may also be used to provide sensory feedback to the user, thus closing the sensory-motor control loop [54]. Intracortical electrode arrays have been successfully demonstrated to allow control of multi-degree-of-freedom reach and grasp movements with robotic arms in tetraplegic subjects [55,56], http://www.jneuroengrehab.com/content/12/1/1 though to date there are no known examples of corticallyimplanted electrodes being used to control a lower limb device in humans. Similar experiments have been done, however, in rhesus macaques to demonstrate the prediction of leg movements to control of bipedal gait in a humanoid robot [57]. It remains to be demonstrated how well this technique would translate to the control of a wearable P/O device.

(p35.6) Recalling that motor intentions originate at the cortical level, several groups have investigated methods for triggering the device to provide assistance through Brain-Computer Interfaces (BCI) [45]. Recording of activity at this level has the potential to allow for a wide-variety of volitional movements, however, these may be difficult to decipher given that the brain is concurrently responsible for a multitude of tasks, including the control of the other limbs. In addition, many of the control loops responsible for physiological locomotion take place at the spinal level via reflex arcs (Figure 2), which may fundamentally preclude the use of neural activity to directly control the legs while maintaining balance during a dynamic task. However, there may still be utility in using brain activity to provide high-level commands to the device, which it will then execute (as in the shared control context promoted in [45][46][47] and demonstrated in [48,49]).

(p35.7) Functional near-infrared spectroscopy (fNIRS) uses optical light emitters and receivers placed on the scalp to sense the haemodynamic response of the brain, which correlates with brain activity. This modality is subject to non-specific brain activity, motion artifacts, significant haemodynamic delay, and requires that optodes be worn on the head. Even so, a recent pilot study investigated the use of an fNIRS-BCI to detect the preparation for movement of the hip in seated stroke subjects, which may indicate its suitability in shared control with severely impaired subjects [50].

(p35.8) Electroencephalography (EEG) uses an array of surface electrodes to non-invasively record the electrical activity of the brain as evident on the scalp [45]. The EEG electrode arrays typically used in research are built into a snug-fitting skull cap that can be extremely difficult and time-consuming to put on by oneself, especially for the patient groups whose injuries would necessitate direct cortical input to the P/O controller. This supposedly could be countered with advancements in self-contained EEG headsets designed for consumer use. The electrodes can be either dry or wet, depending on whether an electrically conductive gel is required. Signals recorded via EEG can encode a wide variety of movements with high temporal resolution.

(p35.9) In practice, the use of EEG signals demands a high level of focus and concentration from the user and is susceptible to movement artifacts, autonomic neural activity and electrical noise. Use in real-world environments is further complicated by the presence of distractions and the performance of tasks that are unrelated to locomotion. However, EEG signals could be combined with other sensory inputs in the framework of the so-called hybrid BCIs [51,52] in order to decode user's high-level commands more reliably.

(p35.10) Environmental sensing (see section below) can add an additional layer of safety in the context of shared control with BCIs, as the controller may prevent certain movements due to the presence of obstacles [47]. For example, prior to executing a high-level command (e.g. go forward, turn left), the controller would check first whether there are any terrain features in the way. Similarly, the execution of the high-level command "sit down" would not require the user to align perfectly with the chair, but would rely on the controller's ability to compensate for the misalignment. As these examples illustrate, shared control reduces cognitive workload, as the user does not need to care about the mid-to-low-level execution over long periods of time or during critical operations.

(p35.11) Implanted electrode arrays within the motor cortex enable measurements which may encode a wide variety of movements, with the noted downside of requiring a highly invasive (and still experimental) surgical procedure [15,53,54]. Such an interface may also be used to provide sensory feedback to the user, thus closing the sensory-motor control loop [54]. Intracortical electrode arrays have been successfully demonstrated to allow control of multi-degree-of-freedom reach and grasp movements with robotic arms in tetraplegic subjects [55,56], http://www.jneuroengrehab.com/content/12/1/1 though to date there are no known examples of corticallyimplanted electrodes being used to control a lower limb device in humans. Similar experiments have been done, however, in rhesus macaques to demonstrate the prediction of leg movements to control of bipedal gait in a humanoid robot [57]. It remains to be demonstrated how well this technique would translate to the control of a wearable P/O device.
## (s36) Peripheral neural activity
(p36.0) The closer that neural activity can be recorded to the innervated muscle, the more specific the motor commands become. Also interesting is the electromechanical delay between the motor commands and the generation of force in the muscle on the order of 10s of milliseconds [58], which would provide a significant head-start to a controller based on muscle activity over one based on mechanical feedback alone [59]. This delay, however, may also be a source of instability when a device with a faster control loop is coupled to the user to provide high levels of assistance [60].
## (s37) Joint torques and positions
(p37.0) Mechanomyography (MMG) can be used to estimate the force production in muscle by measuring the sound or vibrations evident on the surface of the skin using microphones or accelerometers [68]. A potential advantage of MMG over EMG is that the muscle force estimated through MMG is less sensitive to fatigue [69]. Force production can also be estimated via changes in muscle hardness [70,71] and the volume of the muscle [72,73]. A substantial downside to all of these approaches is their high sensitivity to motion artifacts, which may be significant given the nature of the physical coupling at the user-device interface.

(p37.1) Joint torques can be estimated via inverse dynamics provided measurements of the joint positions and external forces being applied to the limbs. Wearable sensors for estimating joint positions or limb segment orientations are summarized in [74] and include goniometers, inclinometers, accelerometers, gyroscopes, magnetometers, and inertial measurement units (IMUs). Ground reaction forces can be sensed using instrumented insoles worn under the foot (reviewed in [75]) or e.g. by measuring the load in the shank of a prosthesis. A variety of foot switches can also be used to deliver binary ground contact information, for example using force-sensitive resistors, sensed air pressure in a sealed tube under the foot, or a physical switch.
## (s39) Artificial sensory feedback and substitution
(p39.0) In the nominal sensory-motor system, sensory feedback from proprioceptors, exteroceptors, and the vestibular and visual systems close the physiological control loop, allowing stable and efficient locomotion, while http://www.jneuroengrehab.com/content/12/1/1 also triggering supportive reflexes. Following neurological pathologies or amputation, this sensory feedback may be diminished or disrupted.

(p39.1) While it is possible to restore locomotive functionality without this information, artificial sensory feedback is necessary for the seamless integration of the P/O with the impaired sensory-motor system [81]. Feedback modalities may be either invasive or non-invasive, devices are stationary or portable, with the latter being more relevant for every-day use in combination with a P/O. A recent review has summarized the clinical impacts of wearable sensing and feedback technologies for normal and pathological gait [74], though the scope does not include their application to P/O devices.

(p39.2) Artificial feedback can be used for sensory substitution or augmentation. Sensory substitution replaces a lost sensor modality with another modality, e.g. by providing a sense of touch after amputation of the upper [82,83] or lower [84] extremity. Sensory augmentation complements attenuated information using the same or a different sensor modality, e.g. visual feedback about the movement of a passively guided or prosthetic limb. Both sensory substitution and augmentation exploit brain plasticity, and different sensory modalities can be used to convey information and thereby restore function.
## (s40) Environmental interaction
(p40.0) The environment provides the reaction forces responsible for the balance, support, and propulsion of the P/O user. These forces are a function of the ground contact surface condition, the slope, and the elevation of the terrain. Other forces arise due to the physical properties of the environment, such as gravity and fluid dynamic drag.

(p40.1) Obstacles are terrain features that impede motion in a particular direction, thus forcing the user to circumnavigate or to perform a compensatory motion to negotiate. Each of these environmental properties have a great influence on the stability, balance, and energy consumption of the device and of the user [18] and thus should be considered in the overall control scheme.

(p40.2) The state of the environment can be indirectly inferred based on the states of the user and of the device or directly estimated using sensors explicitly for this purpose. This provides contextual information that can be used for the strategic implementation of control policies over a time window of several steps, as well as tactical information that can directly influence the control behavior within the current step.

(p40.3) The environment provides the reaction forces responsible for the balance, support, and propulsion of the P/O user. These forces are a function of the ground contact surface condition, the slope, and the elevation of the terrain. Other forces arise due to the physical properties of the environment, such as gravity and fluid dynamic drag.

(p40.4) Obstacles are terrain features that impede motion in a particular direction, thus forcing the user to circumnavigate or to perform a compensatory motion to negotiate. Each of these environmental properties have a great influence on the stability, balance, and energy consumption of the device and of the user [18] and thus should be considered in the overall control scheme.

(p40.5) The state of the environment can be indirectly inferred based on the states of the user and of the device or directly estimated using sensors explicitly for this purpose. This provides contextual information that can be used for the strategic implementation of control policies over a time window of several steps, as well as tactical information that can directly influence the control behavior within the current step.
## (s42) Explicit environmental sensing
(p42.0) Scandaroli et al. presented a method using gyroscopes and infrared sensors [112] for estimation of the ground slope and elevation of the foot above the ground. In this application, two single-axis gyroscopes and four distancemeasuring infrared sensors were mounted underneath a prosthetic foot. So far, only bench-top test results have been presented. Zhang et al. presented a "Terrain Recognition System" comprised of a body-worn laser distance sensor and IMUs fixed to the limbs [113]. The system estimates the height and slope of the terrain and was tested using an unassisted, able-bodied user with the laser sensor attached to the waist. An array of sonar sensors and digital video cameras was used to detect obtacles, which was used in the shared control context allow/disallow user commands with a brain-controlled wheelchair [47]. This approach could easily be extended to P/O devices.

(p42.1) Relatively few examples were found regarding active lower limb P/O devices that include explicit environmental sensing and adaptation, which is likely attributable to several factors. One is that many of the documented devices are still confined to well-defined and controlled environments as imposed by hardware and experimental constraints. Another is that much of the controller development has so far focused on the mastery of executing a particular task in a particular setting. Also possible is that sensors appropriate for environmental sensing have only recently become available and practical for use in a portable device. As each of these aspects attain sufficient technological maturity to provide generalized assistance that is responsive to real-world settings, it is expected that sensing of the environmental state and its physical and signal-level influence on the user, the device and the controller will gain higher priority.

(p42.2) Scandaroli et al. presented a method using gyroscopes and infrared sensors [112] for estimation of the ground slope and elevation of the foot above the ground. In this application, two single-axis gyroscopes and four distancemeasuring infrared sensors were mounted underneath a prosthetic foot. So far, only bench-top test results have been presented. Zhang et al. presented a "Terrain Recognition System" comprised of a body-worn laser distance sensor and IMUs fixed to the limbs [113]. The system estimates the height and slope of the terrain and was tested using an unassisted, able-bodied user with the laser sensor attached to the waist. An array of sonar sensors and digital video cameras was used to detect obtacles, which was used in the shared control context allow/disallow user commands with a brain-controlled wheelchair [47]. This approach could easily be extended to P/O devices.

(p42.3) Relatively few examples were found regarding active lower limb P/O devices that include explicit environmental sensing and adaptation, which is likely attributable to several factors. One is that many of the documented devices are still confined to well-defined and controlled environments as imposed by hardware and experimental constraints. Another is that much of the controller development has so far focused on the mastery of executing a particular task in a particular setting. Also possible is that sensors appropriate for environmental sensing have only recently become available and practical for use in a portable device. As each of these aspects attain sufficient technological maturity to provide generalized assistance that is responsive to real-world settings, it is expected that sensing of the environmental state and its physical and signal-level influence on the user, the device and the controller will gain higher priority.
## (s45) High-level control
(p45.0) The purpose of the high-level controller is to perceive the locomotive intent of the user through a combination of activity mode detection and direct volitional control. Depending on the user's underlying pathology, the ability to generate, transmit, and execute appropriate locomotor commands may be impaired at some level. Therefore, once the user has provided a high-level command, the device should be responsible for the execution of movement via the mid-and low-level controllers. This shared control approach limits the cognitive burden imposed on the user [45,46].

(p45.1) The desired high-level control output allows for the device to autonomously switch between different locomotive activities, ideally without imposing any conscious inputs from the user. Activity mode recognition can be coupled with direct volitional control to provide the user the ability to modulate the device's behavior within a particular activity [120]. It is also possible to provide direct volitional control of the device in the absence of activity mode recognition.

(p45.2) The purpose of the high-level controller is to perceive the locomotive intent of the user through a combination of activity mode detection and direct volitional control. Depending on the user's underlying pathology, the ability to generate, transmit, and execute appropriate locomotor commands may be impaired at some level. Therefore, once the user has provided a high-level command, the device should be responsible for the execution of movement via the mid-and low-level controllers. This shared control approach limits the cognitive burden imposed on the user [45,46].

(p45.3) The desired high-level control output allows for the device to autonomously switch between different locomotive activities, ideally without imposing any conscious inputs from the user. Activity mode recognition can be coupled with direct volitional control to provide the user the ability to modulate the device's behavior within a particular activity [120]. It is also possible to provide direct volitional control of the device in the absence of activity mode recognition.
## (s46) Activity mode recognition
(p46.0) Activity mode recognition is what enables the high-level controller to switch between mid-level controllers that are appropriate for different locomotive tasks, such as level walking, stair ascent, and standing. The cyclic nature and long-term repeatability of various modes of gait lend themselves to automated pattern recognition techniques for classification. The inputs to the classifier include the sensed states of the user, the environment, and of the device. Important considerations for choosing a classifier include the number of activities from which to choose, the procedure required for training, its error rate in real-world conditions, signals that are required as an input, and the classification latency i.e. the time required by the classifier to reach a decision.

(p46.1) As useful definitions, Huang et al. coined the term critical time to describe the time by which a classification decision must be reached to ensure proper kinematic and kinetic transitioning between modes [59]. Thus, the classification latency must be shorter than the critical time to execute a proper transition. The critical time is an especially important constraint when transitioning between activity modes with substantially different characteristics, for example level walking to stair ascent, where excessive latency may cause a loss-of-balance. In subsequent work, Zhang et al. use the term critical error to describe any error that results in the subjective feeling of unstable balance [121]. This definition emphasizes not only that a loss-of-balance is to be avoided, but that the user must also feel secure with the performance of the device.
## (s50) Non-phase-based controllers
(p50.0) Complementary Limb Motion Estimation (CLME) infers the intended motion of affected limbs from the motion of the residual limbs, and maps this to a reference trajectory for robotic P/O joints to track [191]. This is possible due to the strong inter-joint coordination exhibited during physiological human motion [36]. The mapping is derived through regression of physiological gait recordings of healthy subjects. CLME is sometimes confounded with echo control, as described above. By contrast, CLME complements residual body motion without delay. In addition, the recorded joints and their sensed states (e.g. position, velocity, acceleration) need not directly correspond to the controlled joint, as with echo control. For example, the motion of the arms and upper body are often highly correlated to the motion of the lower limbs, and thus represent potential recording sites for CLME-based control [192]. CLME does not depend on information of the gait phase, and no change of control is necessary between stance and swing. However, instrumentation of selected residual body parts must be provided. CLME was first evaluated with the LOPES gait rehabilitation robot, showing that it can both replace (unilateral) leg function when needed [193], and be transparent when no assistance is needed [191]. Later, it was shown that an amputee subject can walk at different speeds and negotiate stairs [157] with a CLME-controlled actuated knee prosthesis. This study also demonstrated a qualitative reduction in the compensatory motion of the soundside foot relative to a commercial controlled-damping prosthesis.
## (s51) Forms of control laws
(p51.0) The output from the mid-level controller is the desired state of the device. This state may consist of a combination of joint positions, velocities, and torques. The design of the device and the actuators it contains will have a strong influence on how well the desired state can be achieved, and thus must be taken into account during the development of the mid and low level controllers.

(p51.1) Commanding joint positions or velocities is a straightforward approach to robot control, for which an abundance of theory exists. In this case, the robot is tasked with the precise reproduction of a pre-defined trajectory. This type of controller works best when the output mechanical impedance (as defined below) of the actuator is high relative to the load, thus enabling the device to reject perturbations from the user or the environment. Controlling the position or velocity of the device is useful when the desired trajectory and the interaction forces are wellcharacterized; but both of these may be difficult to predict given the dynamic nature of locomotion. Interaction with stiff objects (e.g. the environment) can lead to instability and the generation of high forces under this type of control [200]. Presumably, it is because of these issues that very few examples of assistive devices for lower limbs were found that use position control.

(p51.2) The causal dual of angular velocity is torque. Torque control is possible when the output mechanical impedance of the actuator is low relative to the load, and is useful for providing assistive forces when the desired position is ill-defined or unimportant. Problems can arise, however, when torques are applied without regard to the position of the joint (e.g. uncontrolled motions, bumping into RoM limits).

(p51.3) Impedance is defined as the transfer function between an input flow and an output effort [201]. In the domain of mechanical rotation, controlling the impedance of a joint is to control the relationship between the accepted http://www.jneuroengrehab.com/content/12/1/1 angular velocity and the yielded torque. Since the output of an impedance controlled joint is ultimately a torque, the output mechanical impedance of the actuator must be relatively low. A wide variety of virtual dynamics can be rendered under impedance control, with common intuitive examples being linear stiffness, damping and inertia. By applying passivity constraints to the rendered dynamics, the stability of the impedance-controlled system can be guaranteed [200,202].

(p51.4) A leading theory regarding physiological movement is that the CNS controls the limbs through impedance control [203,204]. It is partly due to property that human movements can be robust to perturbations despite the delays inherent to transmission of efferent and afferent signals via neural pathways, as explained in the section on nominal control of human locomotion. Thus, it is possible to realize a bio-inspired approach to P/O control through impedance modulation. An improved understanding of how humans control the impedance of the lower limbs is necessary to optimize the mechanical design and control of P/O devices and is the topic of ongoing biomechanics and neuroscience research [156,194,[205][206][207][208][209].

(p51.5) Admittance is defined as the inverse of impedance, and thus also defines a relationship between effort and flow. Admittance control has been proposed as an approach to masking the undesired dynamics (e.g. added friction and inertia) imposed by an exoskeletal device [210]. This type of control has been used with treadmillbased gait orthoses [211], but no examples of admittance control implementations with a portable device were found.

(p51.6) It is impossible to say whether it is best to control a device's position, velocity, torque, impedance, or admittance, though the choice may be constrained by the physical dynamics of the device and how it is actuated. There are distinct advantages and disadvantages to each type of control, and there may be different conditions and gait phases that lend themselves to switching between control modes [134,185,212].

(p51.7) The output from the mid-level controller is the desired state of the device. This state may consist of a combination of joint positions, velocities, and torques. The design of the device and the actuators it contains will have a strong influence on how well the desired state can be achieved, and thus must be taken into account during the development of the mid and low level controllers.

(p51.8) Commanding joint positions or velocities is a straightforward approach to robot control, for which an abundance of theory exists. In this case, the robot is tasked with the precise reproduction of a pre-defined trajectory. This type of controller works best when the output mechanical impedance (as defined below) of the actuator is high relative to the load, thus enabling the device to reject perturbations from the user or the environment. Controlling the position or velocity of the device is useful when the desired trajectory and the interaction forces are wellcharacterized; but both of these may be difficult to predict given the dynamic nature of locomotion. Interaction with stiff objects (e.g. the environment) can lead to instability and the generation of high forces under this type of control [200]. Presumably, it is because of these issues that very few examples of assistive devices for lower limbs were found that use position control.

(p51.9) The causal dual of angular velocity is torque. Torque control is possible when the output mechanical impedance of the actuator is low relative to the load, and is useful for providing assistive forces when the desired position is ill-defined or unimportant. Problems can arise, however, when torques are applied without regard to the position of the joint (e.g. uncontrolled motions, bumping into RoM limits).

(p51.10) Impedance is defined as the transfer function between an input flow and an output effort [201]. In the domain of mechanical rotation, controlling the impedance of a joint is to control the relationship between the accepted http://www.jneuroengrehab.com/content/12/1/1 angular velocity and the yielded torque. Since the output of an impedance controlled joint is ultimately a torque, the output mechanical impedance of the actuator must be relatively low. A wide variety of virtual dynamics can be rendered under impedance control, with common intuitive examples being linear stiffness, damping and inertia. By applying passivity constraints to the rendered dynamics, the stability of the impedance-controlled system can be guaranteed [200,202].

(p51.11) A leading theory regarding physiological movement is that the CNS controls the limbs through impedance control [203,204]. It is partly due to property that human movements can be robust to perturbations despite the delays inherent to transmission of efferent and afferent signals via neural pathways, as explained in the section on nominal control of human locomotion. Thus, it is possible to realize a bio-inspired approach to P/O control through impedance modulation. An improved understanding of how humans control the impedance of the lower limbs is necessary to optimize the mechanical design and control of P/O devices and is the topic of ongoing biomechanics and neuroscience research [156,194,[205][206][207][208][209].

(p51.12) Admittance is defined as the inverse of impedance, and thus also defines a relationship between effort and flow. Admittance control has been proposed as an approach to masking the undesired dynamics (e.g. added friction and inertia) imposed by an exoskeletal device [210]. This type of control has been used with treadmillbased gait orthoses [211], but no examples of admittance control implementations with a portable device were found.

(p51.13) It is impossible to say whether it is best to control a device's position, velocity, torque, impedance, or admittance, though the choice may be constrained by the physical dynamics of the device and how it is actuated. There are distinct advantages and disadvantages to each type of control, and there may be different conditions and gait phases that lend themselves to switching between control modes [134,185,212].
## (s52) Coordinated motion control and load sharing
(p52.0) Prosthetic and orthotic devices are part of an overall system involving physical interactions, and thus cannot operate as if in isolation. A coordinated mid-level control scheme is necessary whenever there are multiple actuated degrees of freedom, whether contained within one device [117,170,181,213,214] or distributed across multiple devices [176]. Uncoordinated motion between limbs and joints can result in loss of balance or falls, and so the states of each should be communicated and taken into account to prevent such an occurrence. Monitoring of the state of the user (e.g. ground contact state, joint positions) also provides relevant information to the controller.

(p52.1) It should also be noted that the joints in the human body are subject to biarticular coupling on both a mechanical and neural level [215]. As a result, the realizable voluntary torque output and range-of-motion (RoM) of the user's joints are functions of posture, which potentially involves joints that are not specifically actuated by the device. Considering this, the mid-level controller should take into account the configuration of the user to ensure that the device does not over-power the joint nor exceed his RoM.
## (s53) Low-level control
(p53.0) The purpose of the low-level controller (Figure 1) is to calculate the error between the device's current and desired states (i.e. the output from the mid-level controller) and to drive the actuator to reduce this error. This executionlevel of control tends to be highly device-specific, and may rely on a combination of feedforward and feedback loops. http://www.jneuroengrehab.com/content/12/1/1 Feedforward control requires some form of model to predict the system's future state based on the past and current set of inputs and device state. Such control inputs can be effective at reducing undesired interaction forces due to the added mass, inertia, and friction of the device [178].

(p53.1) Feedback controllers do not require a model of the system per se, but do require an estimate of the current state. The controller compares this with the desired state of the device and modulates the power input to the device to drive any discrepancy to zero. A wide variety of control techniques can be used to achieve this, the details of which are left to any reputable controls textbook. Many classical control strategies employ negative feedback, though the Berkeley Lower Extremity Exoskeleton (BLEEX) employs a positive feedback loop [220,221]. In this example, the net effect of the positive feedback is to increase the controller's sensitivity to the user's interactions without requiring force sensing between the user and the device. The trade-off is that very precise models of the device's dynamics are required for each of the bilateral ground contact states. This was counteracted using the hybrid control scheme outlined in subsequent work [214].

(p53.2) The physical configuration and dynamics (i.e. friction, inertia, actuator power output) of the device will fundamentally limit its ability to stably track a desired output trajectory. The performance of digitally-controlled systems is further constrained by sensor noise, signal quantization, discrete sampling effects, and control loop execution times. The use of passivity constraints (i.e. that the device is controlled to store or dissipate energy, but not add) provides a means to guarantee the stability of the device as it interacts with the user and his environment [182,200,202].

(p53.3) The purpose of the low-level controller (Figure 1) is to calculate the error between the device's current and desired states (i.e. the output from the mid-level controller) and to drive the actuator to reduce this error. This executionlevel of control tends to be highly device-specific, and may rely on a combination of feedforward and feedback loops. http://www.jneuroengrehab.com/content/12/1/1 Feedforward control requires some form of model to predict the system's future state based on the past and current set of inputs and device state. Such control inputs can be effective at reducing undesired interaction forces due to the added mass, inertia, and friction of the device [178].

(p53.4) Feedback controllers do not require a model of the system per se, but do require an estimate of the current state. The controller compares this with the desired state of the device and modulates the power input to the device to drive any discrepancy to zero. A wide variety of control techniques can be used to achieve this, the details of which are left to any reputable controls textbook. Many classical control strategies employ negative feedback, though the Berkeley Lower Extremity Exoskeleton (BLEEX) employs a positive feedback loop [220,221]. In this example, the net effect of the positive feedback is to increase the controller's sensitivity to the user's interactions without requiring force sensing between the user and the device. The trade-off is that very precise models of the device's dynamics are required for each of the bilateral ground contact states. This was counteracted using the hybrid control scheme outlined in subsequent work [214].

(p53.5) The physical configuration and dynamics (i.e. friction, inertia, actuator power output) of the device will fundamentally limit its ability to stably track a desired output trajectory. The performance of digitally-controlled systems is further constrained by sensor noise, signal quantization, discrete sampling effects, and control loop execution times. The use of passivity constraints (i.e. that the device is controlled to store or dissipate energy, but not add) provides a means to guarantee the stability of the device as it interacts with the user and his environment [182,200,202].
## (s54) The P/O device
(p54.0) The device represents the hardware embodiment of the robotic P/O. This includes the device's physical structure, actuators, embedded sensors, control system, energy storage, and power amplifiers. While the mechanical design and implementation of P/O devices is beyond the scope of this review, the hardware must be taken into account as it heavily influences the low-level control possibilities. For example, it may be difficult and inefficient to render forces with an assistive device whose actuator output impedance is high [197], conversely the maximum torque output, controllable bandwidth and the dynamic range of renderable impedance (i.e. Z-width) are reduced for an actuator with low output impedance [202].

(p54.1) Additional considerations are the performance limitations and saturation effects of the actuator and power source [14,60,170]. Even state-of-the-art portable devices must be driven beyond their continuous operating range to achieve the power outputs required during energetically demanding activities, such as sit-to-stand, stair ascent, running, or jumping [61,217]. While this is generally acceptable for short bursts, it may be necessary for the controller to derate the actuator if these conditions are sustained for long periods.

(p54.2) A further optimization for the controller may be the energy efficiency of operation. In addition to minimizing the energetic expenditure of the user, the device may also be tasked with minimizing its own energy consumption, thus extending its useful range of operation. Portable devices are inherently limited in their energy storage capabilities, and as such the conversion of power to a usable form should be as efficient as possible. Aside from improvements in amplifier or transmission technology, energy-saving approaches include the use of passive compliance, e.g. [3,205,222], mechanically-variable impedance actuation [223,224] and the reciprocal transfer of power between joints [213,[225][226][227][228] or between portions of the gait cycle [229][230][231].
## (s55) Safety mechanisms
(p55.0) Considerations of safety must underly nearly all aspects of the mechanical design and control of P/O devices. These must include safety of the subject, his environment, and of the device itself. This is especially important for powered devices, which may be capable of generating destructive forces and whose controlled output behavior may not always be in agreement with the user's intent. The identification, quantification and mitigation of risks is thus a critical aspect of device development.

(p55.1) Common risks to locomotion include slipping, tripping and falling, all of which may be exacerbated by the presence of the P/O device. The cause of such incidents may be internal to the device (e.g. controller failure) or due to external factors, such as encountering unexpected terrain. The severity of these risks spans a wide range, and must be weighed against the probability that they will occur, and whether such a failure is detectable. The risks are also not limited to physical harm, but may also include social, emotional, and psychological effects [38,39].
