# Threats to Online Advertising and Countermeasures: A Technical Survey

CorpusID: 218518023 - [https://www.semanticscholar.org/paper/42ce230075cee1a21cf0df8770068d4f97863175](https://www.semanticscholar.org/paper/42ce230075cee1a21cf0df8770068d4f97863175)

Fields: Business, Computer Science, Law

## (s7) Click Fraud.
(p7.0) Click fraud is probably the most common ad fraud and also the most studied because of the widely adopted Cost Per Click pricing model, in which advertisers are charged based on the number of clicks on their products. As its name indicates, click fraud is done by generating HTTP requests to advertisement click URLs, usually after an ad is shown. There are two kinds of click fraud [81]. Click inflation is where publishers make more money than they should by creating traffic using artificial clicking. Competitor clicking is a different approach where advertisers make false clicks in a competitor's ads to consume the competitor's advertising budget.
## (s9) Other Frauds.
(p9.0) Cookie stuffing or cookie dropping is an activity in which illegitimate actors receive credit for purchases made by web users by defrauding affiliate marketing programs, even if the affiliate marketer did not actively perform any marketing for the affiliate program [76]. The defrauding is carried out by the illegitimate actor depositing a cookie (hence the term "cookie stuffing") on the user's computer for a target website that is unrelated to the one the user is visiting. The illegitimate actor then receives credit when the user later visits the target website. The user is usually unaware of the cookie stuffing. By mining the HTTP logs in a university web server, Snyder et al. [76] found that over one-third of publishers in affiliate marketing programs use cookiestuffing to claim credit from online retailers for illicit referrals. In addition to cookie stuffing, a new ad fraud mechanism enables publishers to increase their ad revenue by deceiving the ad exchange and advertisers. This new scheme (described in Reference [54]) targets users visiting the publisher's site using higher-paying ads. By issuing requests to content not explicitly requested by the user, the user's online interest profile is corrupted and the ad selection process is influenced.
## (s10) Ad Injections
(p10.0) Threats to online advertising involving tampering are usually in the form of ad injection, which has a direct impact on a publisher's revenue. In theory, the Internet follows the end-to-end principle [71], which implies that intermediary boxes between two communicating processes should not alter the application messages. Tampering of ads, like any tampering of Internet flows, can be considered as a violation of this principle [19].

(p10.1) The ad delivery process is through client-server communications, which is mostly via HTTP. Therefore, tampering in the end-to-end tunnel can be conducted to alter ad contents and their delivery process. Although HTTPS can protect general Man-in-the-Middle (MitM) attacks, proxies at HTTPS endpoints can still modify web pages unknown to the client. What is even worse is that there is still a large number of websites that have not deployed Transport Layer Security (TLS). Ad tampering can happen at the client-side or in the network. For monetization, the injectors syndicate from the large ad ecosystem.

(p10.2) The cases where browser sessions are tampered with, such that tampered ads are imposed on the browsers, are discussed in Reference [85]. To discover ad injection and the value chain behind it, a client-side DOM scanner was deployed in a subset of Google's websites. The scanner is able to detect and report rogue ad elements. With such client-side telemetry technique, the paper reports that more than 5% of unique daily IP addresses accessing Google were impacted by ad injection during the time frame of the study. Furthermore, injected ads were identified to arrive at a client's machine through multiple vectors, and the measurements identified 50,870 Chrome extensions and 34,407 Windows binaries, 38% and 17% of which were explicitly malicious, respectively.

(p10.3) Many legitimate applications use advertisements to earn money while providing the application to users for free. However, malicious applications can take advertising a step further with invasive advertising practices. Rather than placing advertisements alongside legitimate application content, malicious adware will display advertisements when the user is interacting with other applications. This could significantly interfere with a user's experience with other applications (see invasive advertising [30]).
## (s12) Malvertising
(p12.0) Online advertising has been exploited by cybercriminals to spread malware. This is known as malvertising, a form of spreading malware to vulnerable devices through online advertising [30]. Take browser-based advertising as an example. In this case, a user navigates to a website that contains an external advertising link in the form of an injected iframe that directs the user's browser to an invisible exploit kit landing page. Exploit kits are webbased services designed by hackers to exploit vulnerabilities of browsers by downloading malicious executables. At that point, information about the victim's system is passed along to the attacker's server, which is then used to select a malicious exploit file that is automatically downloaded. The downloaded file exploits a vulnerability on the system that allows the attacker to install a malicious binary or otherwise control the victim's machine. This process is the so-called Drive By Downloads-one way by which malvertising works.
## (s15) In the Network. As shown in
(p15.0) With Transport Layer Security (TLS), MiTM is not as easy as before. However, it is still doable. In fact, the usage of TLS proxies is not negligible. In Reference [60], 1 out 250 TLS connections are TLS-proxied during a study of 2.9M tests. A TLS proxy acts as an endpoint of TLS connections. In particular, A TLS proxy can issue a substitute certificate for any web server the user visits; as a result, the user establishes an encrypted connection to the proxy rather than the desired web server. This means the proxy can decrypt and modify the HTTP payload including ads [60]. Besides HTTPS proxies, other attacks are possible. For instance, a Man-In-The-Middle-Script-In-The-Browser (MITM-SITB) attack is presented in Reference [43]. In the attack, malicious JavaScript is sent to the user's browser within a TLS connection with the attacker, and this JavaScript is used in direct connections. In such cases, the boundary between MiTM and MiTB/MiTMo is blurred.
## (s16) What Malicious Parties Can Use
(p16.0) Another important aspect of understanding attacks concerns the tools and infrastructure that attackers have to achieve their goals. For advertising attacks, hackers have utilized malware, botnets, and click farms. 3.6.1 Malware and Botnets. Malware gains access to a computer system (personal computer, smartphones, IoT devices, and so on) for purposes such as stealing data, damaging the device, or simply annoying the user [30]. Hence, malware is a popular means to create attacks against online advertising. These threats include ad fraud, ad injection, and stealing web cookies. A botnet refers to a network of computers that have been infected by malware and turned into bots. Figure 6 illustrates a typical botnet architecture. A botmaster can remotely control a large network of bots (i.e., infected computers) to execute attacks. Bots receive commands from the attacker's Command and Control (C&C) server [78] and can be turned into machines creating click fraud (which are then known as clickbots [24]). Through the C&C, bots can also be turned into machines that fetch ads from the Internet unknown to the user. Botnets take advantage of vulnerabilities in web browsers and spread malware in the form of browser extensions [65].
## (s17) Click Farms.
(p17.0) Despite the absence of a thorough study on click farms, i.e., organized activities to generate illegitimate ad clicks and conversions, ad fraud research such as Reference [26] does assume click farms to be one of the sources of fraud.
## (s20) Data Analytics-based Techniques
(p20.0) Data analytics, especially machine learning, has been widely used in detecting ad fraud and malvertising. Prior to data analytics, ad networks usually used ad hoc or simple heuristics to filter out ad fraud. For example, if an advertiser complains of getting thousands of clicks from a single IP address, none of which convert into paying customers, the ad network may start filtering all clicks from that specific IP address or the whole area where the IP address is located. With more and more sophisticated fraud and tampering, the application of more advanced data analytical technologies and algorithms has been proposed.

(p20.1) Reference [59] reports some findings from a data-mining competition in 2012 that used anonymous production data. The task in the competition was to identify fraudulent publishers who generated illegitimate clicks and to distinguish them from normal publishers. One of the main findings is that features derived from finegrained time-series analysis are crucial for accurate fraud detection. Further, methods consisting of multiple classical data-mining techniques provide the most promising solutions to highly imbalanced nonlinear classification tasks with mixed variable types and noisy/missing patterns. Note that the competition happened before the recent trend of applying deep learning to similar tasks [45]. The fraud detection results may be potentially improved with deep learning, especially in regard to the feature engineering capability. Recently, the application of neural networks in detecting fraud has been reported by Badhe in References [8] and [9], but some details are unfortunately missing.

(p20.2) Based on the observation that publishers using click fraud have a higher return of investment (ROI) than ethical publishers [26], a framework called Viceroi has been proposed. Viceroi consists of an offline component and an online component. In the offline part, click logs are analyzed over multiple timescales to identify click fraud and regions in the associated revenue per user distribution that are anomalous. In the online part, whether or not a given click falls in the anomalous region is identified. The underlying principle is that publishers using click fraud have higher ROI than ethical publishers. In a sense, this higher ROI justifies the higher risk the click fraud must carry, regardless of the specific mechanism the click fraud uses to commit fraud. In Reference [25], a proactive methodology is discussed for ad networks to detect click fraud. The data are collected through a special publisher website that collects information such as mouse movements. A fake ad is added to the website to trick fraudulent parties into clicking it. To deal with false positive and false negative cases, a Bayesian approach is used in the data analytics phase. Similarly, a Bayesian-based framework is also employed in Reference [63] to filter fraud from click streams. Click fraud prediction without knowledge of the ground truth is discussed in Reference [11]. The work is based on the fact that predictions of these ground models are not the same as the unknown ground truth and that the automatically generated class labels are inherently uncertain. The paper suggests that supervised learning from automatically labelled data should be complemented by an interpretation of conflicting predictions between the new classifier and the ground model. In Reference [66], 15K ads were observed using static analysis and behavior analysis. The data are defined in nine features and are fed into a Support Vector Machine (SVM) to detect malvertisements on the publisher side. A malvertising detection system, called MadTracer, potentially deployable in ad networks, is proposed in Reference [48]. MadTracer actively crawls the web's ad delivery processes and leverages a statistical learning framework based on decision trees to automatically generate a set of detection rules.
## (s24) Client-centric Proposals
(p24.0) Currently, there are two types of clients in ad delivery: web browsers and mobile applications. The execution environments and integration technology for these client types are very different. Accordingly, there are proposals to enhance security for these two types of clients, respectively. [68] is a client-side solution implemented in JavaScript to detect modification to a web page over HTTP. At the time of the work, HTTPS was considered an expensive security mechanism, and Tripwire was considered as an alternative to HTTPS for ad delivery. Today, this assumption is no longer valid. The HTTPS protocol can be achieved at very low cost, for instance, via letsencrypt.org. Nevertheless, the work is novel among client-side approaches to provide basic integrity checks for web servers. The weakness of Tripwire is that MiTB attacks are not covered. Basically, a browser extension or any malicious code in a browser can still tamper with Tripwire and, in the end, the web page that Tripwire intended to protect. The scheme also suffers from a lack of a trusted communication channel. As a result, adversaries with sufficient privileges can strip out integrity verification code and spoof a valid response.
## (s25) Client-centric Proposals for Web Browser Environments. Tripwire
(p25.0) Similarly, a solution for publishers and ad servers to build a secure ad serving system based on authenticated hash-chains is proposed in Reference [88]. A basic operation of the proposal is to compute hash values of web pages. However, as websites become more dynamic, computation of web pages is not as relevant as when the research was done. In contemporary websites or web applications, the only way to measure integrity is to compute the hash value of the DOM (Document Object Model) tree that is rendered by the browser. A series of tests on web browsers to detect bot use (replacing humans) is developed in Reference [93]. JavaScript snippets are developed for testing the browser with mouse event tests, functionality tests, and behavior tests. The advertiser's server will challenge the client using this series of tests. If the client fails during the testing, the request from the client is considered as invalid.

(p25.1) To protect users from threats such as malvertising, AdSentry is proposed in Reference [27]. It is a browserbased solution targeting JavaScript-based advertisements. With the help of a shadow JavaScript Engine, AdSentry enables flexible regulation on ad script behaviors by completely mediating the ad script's access to the web page (including its DOM) without limiting the JavaScript functionality exposed to the ads. AdSentry includes a policy enforcer, which allows both web publishers and end-users to customize the access policy for ads. For web publishers, if the ads are wrapped with special JavaScript variables, the ads' executions are confined to the shadow JavaScript engine. For end-users, AdSentry can leverage adblockers to automatically identify ads and confine them with a customized JavaScript wrapper.
## (s26) Client-centric Proposals for Mobile Advertising.
(p26.0) With insufficient regulation, it is possible that legitimate advertisement service providers can leverage ad libraries to track users without their knowledge, access sensitive data, and execute malicious code downloaded via ad delivery.

(p26.1) A framework called AdDroid is proposed in Reference [64] to separate out the privilege associated with an ad library in Android applications. The proposed framework provides a special API to application developers for advertising so advertising-related API calls will no longer have the same privilege as the application itself. Based on ARM's TrustZone technology, a verifiable mobile ad framework called AdAttester is proposed in Reference [47]. It consists of two security primitives: unforgettable clicks and verifiable display. ARM's TrustZone hardware root of trust is leveraged to implement these two primitives to collect proofs, which are piggybacked on ad requests to ad providers for attestation. Based on the observation that a malicious application could simulate the behavior of advertising libraries, a scheme call AdSplit is proposed in Reference [73]. In the proposal, the Android operating system is modified to allow an application and its advertising to run as separate processes under separate user identifiers, eliminating the need for applications to request permissions on behalf of their advertising libraries and providing services to validate the legitimacy of clicks, both locally and remotely. However, whether this proposal will be accepted by the Android community and ecosystem is unknown.

(p26.2) Finally, FCFraud [39] is an operating system-level proposal to address click fraud. FCFraud consists of a Linux kernel module that constructs HTTP request trees based on publicly available ad-related domain names. It also monitors the hardware (mouse movement and clicks). Once an inferred click from HTTP request trees is not triggered by a hardware click, the request is logged as click fraud.
## (s27) Client-centric Proposal to Improve Online Behavioral Advertising.
(p27.0) Reference [46] describes the online advertising industry's proposal to mitigate the loss of privacy in OBA. The proposal is for the use of OBA disclosures: icons, accompanying taglines, and landing pages intended to inform users about OBA and provide opt-out options. The authors of Reference [46] conducted a 1,505-participant online study to investigate Internet users' perceptions of OBA disclosures. They found that the disclosures failed to clearly notify participants about OBA and inform them about their choices. The authors discuss the challenges in crafting disclosures and provide suggestions for improvement.
## (s28) Client+Server Proposals
(p28.0) A fundamental problem with many client-centric solutions is that clients can be hacked, so the security strategies implemented therein will not be effective a t a ll. To overcome t his l imitation, t here h ave b een p roposals with client-server cooperation architecture.

(p28.1) Bluff ads [34] are baiting ads that are designed to be detected and clickable by bots or poorly trained click farm workers. When a bluff ad is clicked, the server side component considers the click as fraudulent. To address the performance issues of HTTPS in use cases such as Content Delivery Network (CDN) caching, HTTPi, a HTTP protocol with integrity, is proposed in Reference [75]. To achieve this, both web browsers and web servers need to be enhanced with new modules. This proposal is potentially useful for addressing hacking-related ad threats, but it requires a significant amount of work in the Internet of today. To address the MiTB attacks, Reference [77] presents a method and system to fingerprint transactions between client and server sides. A scheme to authenticate valid clicks, i.e., admitting only verifiably legitimate ones, is proposed in Reference [41]. The scheme is based on authenticating requests via cryptography attestations on clients. Notably, a web token can be used in the authentication process. The basic idea is to issue a unique identification for each session. A similar idea with a focus on increasing the transparency from the advertisers' perspective is proposed in Reference [14]. The idea is also implemented in JavaScript. This code collects relevant information associated with each impression and sends it to a central server. In particular, the following information will be obtained: the User-Agent receiving the impression, the URL where the impression is shown, and user interactions with the ad impression (mouse movements or clicks on the ad). The connection established with the server is used to obtain the IP address of the device receiving the ad impression as well as the time-stamp assigned to the impression. In the end, the exposure time of the ad impression will be estimated as the duration of the connection.
## (s29) Network-centric Proposals
(p29.0) By analyzing the traffic passing through the network edge, network monitoring devices such as intrusion detection systems (IDSs) can identify malicious traffic such as fraud and malvertising. In Section 4.1, we introduced the off-line approaches utilizing data analytics. There have been proposals to address malvertising using IDSs in a real-time fashion. In malvertising, attackers attempt to hide their web-based exploit kit services from being blacklisted. Hence, more advanced detection of malvertising traffic is needed. To infect a client browser, a webbased exploit kit must lead a web browser to visit its landing page, download an exploit file, and download a malicious payload, necessitating multiple requests to several malicious servers. In Reference [84], an approach is proposed to detect malvertising traffic based on the structure of these web requests, which are in a tree-like form, and uses the structural information for classification. First, an index of malicious tree samples is built using information retrieval techniques. Then, subtree similarity searching is applied to detect HTTP traffic-related to malicious exploit kits on enterprise networks.

(p29.1) Note that these proposals can potentially be scaled up and applied to large operations such as ISPs to detect more advertising-related issues including ad fraud. Technically, the first challenge that needs to be addressed is how to scale up these techniques to accommodate much larger volumes of traffic. One of the economic challenges is how to motivate ISPs to deploy these solutions to address advertising issues, which is briefly surveyed in Section 4.3.
## (s30) Ad Blocking and Anti-adblocking
(p30.0) In this subsection, we discuss adblocking-related solutions. Ad blocking itself has the following security and performance benefits: First, users can block most ads listed on the blocklists of adblockers, freeing browsers from having to run very time-consuming fetching and rendering of ads. Second, some malvertising can also be blocked by adblockers, preventing some browser vulnerabilities from being exploited. Third, to some extent, the users using adblockers can protect their privacy by blocking request to track the user's Internet surfing behavior. Therefore, adblocking is a security-enhancing measure, especially from the user's perspective.

(p30.1) However, adblocking can also be considered as a threat for publishers that rely on advertising to run their services. To maintain their income, publishers can set up a rule so their content or services are only available for those who are willing to see their ads. Such economic phenomenon is studied in Reference [67] using game theoretic modelling, describing how the parties are incentivized. Fundamentally, an adblocker runs as a web browser extension, having higher privilege than an anti-adblocking script, which usually runs in the JavaScript engine sandbox. This means that at the end of the competition between adblocking and anti-adblocking, adblockers have more technical advantages. Admittedly, the increasing use of adblocking is one of the symptoms of a problematic online advertising ecosystem, especially from the user's perspective. However, whether or not the cost incurred by adblocking is justified is unknown. Nevertheless, from a technical perspective, the schemes used in adblocking and anti-adblocking are valuable for increasing the security of online advertising.
## (s31) Private-by-Design Proposal for Online Behavioral Targeting
(p31.0) Designs do exist for online advertising systems that allow for online behavioral targeting without revealing the user's online behavior, and thus protecting his privacy. For instance, a framework called Adnostic is proposed in Reference [86], which is a browser-assisted approach. The scheme consists of two modules building user profile with privacy and rendering ads into publisher pages when the participated publishers' websites are visited. However, according to Reference [69], none of these designs have been implemented and deployed in the real world. The authors of Reference [69] attempt to remedy this situation by building and evaluating a fully functional prototype of a practical privacy-preserving ad system at a reasonably large scale and deploying it. The authors claim to have more than 13K opted-in users. Their system had been in operation for over two months at the time of writing their paper, serving an average of 4.8K active users daily. These authors found that their system obtained click-through rates that are comparable with Google display ads. Their paper is an account of their experience and lessons learned with this system, the first "privacy-by-design" behavioral advertising and analytics system.
