# Privacy-Preserving Data Aggregation Protocols for Wireless Sensor Networks: A Survey

CorpusID: 12970117 - [https://www.semanticscholar.org/paper/a86046ef3f26811b0d4e996c9692b36bafec2c76](https://www.semanticscholar.org/paper/a86046ef3f26811b0d4e996c9692b36bafec2c76)

Fields: Engineering, Computer Science, Medicine

## (s1) Application Areas
(p1.0) In this section, we briefly explain some major application areas of privacy-preserving data aggregation (PPDA) protocols where the leakage of sensor data is a critical issue for WSN users. People might not agree to allow an application to intrude on their personal domain if the privacy of the collected information is not protected. Some common application areas of the PPDA protocol are health monitoring, military surveillance and private households.

(p1.1) (a) Health Monitoring: There are two main health monitoring applications for WSNs. First, there is athletic performance monitoring such as tracking a person's pulse and respiration rate via wearable sensors. Secondly, using health sensors, we can monitor the health of patients, e.g., personal weight, blood sugar level, blood pressure, etc. These sensor measurements of people's health data should be kept private and hidden from other people during transmission with aggregation to the sink node.

(p1.2) (b) Military Surveillance: In military communications, we can use WSNs to replace guards and sentries around defensive perimeters, keeping soldiers out of harm's way, to locate and identify targets for potential attacks and to support attacks by locating friendly troops and unmanned vehicles. Therefore, the privacy of the sensor data is always critical and it should be preserved during aggregation.

(p1.3) (c) Private Households: As mentioned in PDA [17], wireless sensors could be placed in houses in order to collect statistics about water, gas and electricity consumption within a large neighborhood. The aggregated population statistics may be useful for individuals, businesses and government agencies for resource planning purposes and usage advice. However, the individual sensor readings could reveal the daily activities of a household, such as when all family members are absent or when someone is taking a shower; i.e., different water appliances have distinct signatures of consumption that can reveal their identity. Hence, we need a way to collect the aggregated sensor readings while preserving data privacy.
## (s2) PPDA Protocol Designing Principles, Issues and Challenges
(p2.0) WSNs can be deployed in different private data generating fields, as we mentioned in the previous section. PPDA protocols to design supporting sensitive data aggregation face multiple issues and challenges because of bandwidth limited WSNs with resource-constrained sensor nodes. So, a PPDA protocol designed for WSNs must address the features mentioned below in order to be acceptable in the WSN domain.

(p2.1) (a) Eavesdropping and privacy preservation: Eavesdropping is an attack in which an attacker or a curious individual attempts to obtain private information by overhearing transmissions over its neighboring wireless links. Eavesdropping threatens the privacy of data held by an individual sensor node. In opposition, privacy preservation ensures data privacy against both trusted sensor nodes and adversaries. There are some techniques which can prevent revealing the actual data of a sensor node to other sensor nodes and adversaries even though they overhear the sensor data. For example, the PDA proposed two new trends of data transmission to hide actual sensor data [16]. They are CPDA and SMART protocols. To maintain data privacy, in CPDA, seeds (real numbers) are mixed with actual sensor data before they are sent to a parent node. In SMART, the data of a sensor node is divided into small pieces which are sent to a neighboring node. However, such techniques generate unnecessary data traffics which cause a high cost for resource-constrained sensor nodes.

(p2.2) (b) Data pollution and data integrity: Another type of attack is data pollution, in which an attacker tampers with the intermediate result of sensor data during data aggregation at an aggregator. The purpose of the attack is to make a base station receive a wrong aggregation result, thus resulting in improper or wrong decisions. Because the result of data aggregation is used to make critical decisions, a base station or a user needs to attest to the integrity of the aggregated result before accepting it. Ensuring the correctness of the received aggregated data is highly desirable in civilian applications. Therefore, it is necessary to protect the aggregation results from being polluted by attackers. Moreover, if data pollution can be detected as soon as possible, its impact in the final aggregated result can be avoided. To resolve the problem, a commitment-and-attestation technique is presented in the SDAP and the SIA for secure data aggregation [23,24]. But, the commitment-and-attestation technique delays the decision making process because it needs the searching cost of O(log N) to detect the spot of data pollution and ensure data integrity, where N is the total number of sensor nodes in a network. In addition, it needs a significant amount of resources for resource-limited sensor nodes.

(p2.3) (c) Efficiency: In WSNs, data aggregation should achieve both bandwidth and energy efficiency through in-network processing. In private data aggregation protocols, an additional communication overhead cannot be avoided when additional features are realized. However, additional overheads due to the resource-constrained nature of sensor nodes, such as communication cost, computation cost, memory and payload size, should be kept to a minimum. The privacy homomorphism technique performs privacy-preserved data aggregation by using the minimal amount of sensor resources [33,35]. However, the privacy homomorphism technique is not flexible enough to include other features, like supporting a variety of aggregation functions and data integrity within a system. Because most existing PPDA protocols [17,19,31] are not seriously concerned about the efficient usage of the resources, it is a challenging task to devise an elastic PPDA protocol for WSNs by considering the resource limitations of sensor nodes.
## (s3) Classification of PPDA Protocols
(p3.0) In this section, we present the classification criteria. Based on that, we classify the existing PPDA protocols for WSNs and review them. Work related to security issues in data aggregation [22][23][24] is out of the scope of this research.
## (s6) Perturbation
(p6.0) Perturbation technique is also known as data customization. In this technique, every sensor node uses encryption key and/or private or public seeds generated by randomization techniques [25,26], in order to hide the sampled data before transmitting them to a parent node.  [17] to achieve privacy-preserving data aggregation for WSNs. In the CPDA, sensor nodes are randomly grouped into clusters for creating an aggregation tree. Each cluster leverages the additive property of polynomials to calculate the desired aggregate value. At the same time, it guarantees that no individual node can know the data values of other nodes. The intermediate aggregate values in each cluster will be further aggregated on the way to the data sink along the aggregation tree. First, every sensor node in each cluster customizes its private data into polynomial form of order k -1, where k is the total number of nodes in a cluster using shared (non-private) seeds and random numbers (private). Secondly, each sensor node encrypts its customized value by using a unique shared key between a sensor node and the other sensor nodes of the cluster. Thirdly, all nodes from the same cluster exchange their encrypted customized data with each other. Each sensor node has to encrypt and decrypt O(N c ) messages, where N c is the number of sensor nodes in a cluster. Each node assembles all the data including its own by using the additive property of polynomials and sends them to their respective cluster leaders. After that, the cluster leaders deduce the aggregate value by computing the inverse of an M × M matrix where M is the number of cluster nodes. Finally, each cluster leader routes the derived sum of the cluster back towards the query server through the TAG routing tree [10]. Figure 2 shows message exchange within a cluster for the CPDA where there is a cluster leader A and two sensor nodes B and C. 

(p6.1) However, since sensor nodes are resource-constrained, particularly in terms of the limited power and processing speed and the CPDA suffers from high communication and computation overheads. In addition, the CPDA can only tolerate the collusion to a certain threshold i.e., the number of sensor nodes in a cluster minus two. If the number of colluding sensor nodes exceeds the threshold, the sensor nodes may collaboratively reveal the private information of some of the others. Although the threshold can be increased by expanding the size of the clusters, this will further increase communication overhead.
## (s7) CONTI et al.'s scheme:
(p7.0) The privacy-preserving data aggregation scheme by Conti et al. [19] first establishes twin keys for different pairs of sensor nodes in a network. Twin key establishment is an anonymous process that prevents each node in a pair from deriving the identity of the other node with which it is sharing a twin key. Then, for each aggregation phase, it uses an anonymous liveness announcement protocol to declare the liveness of each twin key. In the end, during the aggregation phase, each node encrypts its own value by adding shadow values computed from the lively twin keys it holds. In this way, the contribution of the shadow values for each twin key will cancel out each other and the correct aggregated result is finally obtained.

(p7.1) There are three major steps on the scheme: local cluster formation, twin-key establishment and data aggregation. In the first step, nodes are grouped into several clusters and each cluster forms a different logical Hamiltonian circuit [27]. Each pair of neighboring nodes in the circuit shares a pair-wise key. In the twin-key establishment step, it is assumed that each node contains a pre-deployed ring of K symmetric key [28], randomly chosen from a larger common key pool of size P. Each node establishes a number of twin keys with the other nodes. In particular, a node n i establishes a twin key with another node (twin-node) in the cluster when n i is aware there is a node sharing a key with it. The twin keys are only known to the owners and they are established anonymously. In the data aggregation step, each cluster first computes the aggregated value of its nodes during which an aggregate is routed twice along the Hamiltonian circuit. Each node adds its own sensed value to the aggregate. For each live twin key, it adds (or removes) a corresponding shadow value. The cluster head obtains the correct aggregate for the cluster, because it is guaranteed that any shadow value added during aggregation by one node will be removed by another node that shares the same twin key. Then, by using a tree-aggregation hierarchical structure, the cluster head nodes contribute to the aggregate with the cluster aggregate. Finally, the base station (BS) receives the sum of the values owned by all of the cluster heads. Figures 3 and 4 illustrate data aggregation with shadow values and aggregation of the cluster aggregates of the proposed scheme, respectively. Although this scheme preserves the privacy of the data contributed by a sensor to the aggregate value, it has limited applications, since the information about the key pool is only known to the nodes manufacturer. In addition, this scheme incurs higher communication cost because not only an aggregate is routed twice along the Hamiltonian circuit, but also all nodes are involved while routing individual cluster aggregates to the BS. Furthermore, this scheme decreases the lifetime of the WSN, because all sensor nodes need longer idle times until the BS receives the aggregated value from the cluster heads.  [29] offers different levels of data aggregation privacy based on different node numbers for pre-treating the data. This protocol is inspired by the work of Shao et al. [30] in terms of different levels of privacy as well as the CPDA in terms of the privacy achieving method. In DADPP, a hierarchical wireless sensor network is first constructed in such that sensor nodes form several clusters each of which has a fixed cluster head below the energy efficient BS. According to the desired privacy level, all nodes within the same cluster are partitioned into multiple groups belonging to the same privacy level. Data are pretreated only in the same group and privacy levels are defined by the size of groups. The lowest privacy level consists of partitioned groups that have at least 3-sensor-nodes. The upper privacy level corresponds to portioned groups with 4-sensor-nodes. By analogy, if all sensor nodes of a cluster belong to a single group, they consider this case as the highest privacy level. The data aggregation process is similar to that of the CPDA. First, original data are pretreated in each group. Secondly, the cluster head aggregates all pretreated data. Finally, data are aggregated on the plane of the cluster head up to the BS. The hierarchical wireless sensor network is illustrated in Figure 5. Although DADPP reduces traffic by partitioning a cluster with n sensor nodes into multiple in-networks with pretreatment of groups according to the desired privacy-levels, it suffers from the inherent high communication and computation overheads. Furthermore, these overheads increase with increasing privacy level. 
## (s8) Sensor node
(p8.0) Base station Sensor node Base station PHA: Zhang et al. [31] proposed the Perturbed Histogram-based Aggregation (PHA) to preserve privacy for queries targeted at special sensor data or sensor data distribution. The perturbation technique is applied to hide the actual individual readings and the actual aggregate results sent by sensor nodes. For this, every sensor node is preloaded with a unique secret number which is known exclusively by the sink and the node itself. Sensor nodes and the sink form a tree. The basic idea of PHA is to generalize the values of data transmitted in a WSN, such that although individual data content cannot be decrypted, the aggregator can still obtain an accurate estimate of the histogram of data distribution and thereby approximate the aggregates. In particular, before transmission, each sensor node first uses an integer range to replace the raw data. Next, with a certain granularity, the aggregator plots the histogram for data collected and then estimates aggregates such as MIN, MAX, Median and Histogram. Although the PHA supports many data aggregation functions, it has the following disadvantages. First, the final aggregated result is an approximation value of the sensor data rather than the real data. Secondly, the PHA requires a large size payload (message/data) because all sensor data need to be replaced by an integer range. Moreover, the bandwidth consumption of this protocol increases as the number of ranges increases. Finally, storing interval ranges to replace the original data consumes a significant amount of memory.
## (s10) SMART:
(p10.0) The Slice-Mix-AggRegaTe (SMART) by He et al. [17] achieves privacy-preserving data aggregation by hiding original data before the data transmissions. For this, each sensor node first customizes its private data by slicing it into a fixed number of pieces. Then, it sends data slices to a particular number of neighboring sensor nodes. After the data pieces are received from the neighboring sensor nodes, all sensor nodes calculate the aggregate value of the data slices so that the privacy of the sensor data can be preserved. In the SMART, each sensor node randomly selects a set of sensor nodes, say J, within h hops. When each sensor node slices its private data randomly into J pieces, J -1 pieces are encrypted and sent to the randomly selected sensor nodes, keeping one data piece at the same sensor node. All the sensor nodes decrypt the data by using their shared keys and sum all the received slices. Each sensor node sends the sum to its parent. Finally, the root of the network is the ultimate aggregation point of all sensor data. Figure 6 shows an example of the SMART with seven nodes where J = 3 and hop h = 1. The notation d ij represents a slice of private data sent from node i to node j and r i represents the sum of sliced data. Although the SMART preserves the privacy of sensor data during their aggregation with low computation overhead, it generates a large number of messages in the network. In addition, like the CPDA, the SMART can tolerate only the collusion to a certain threshold, i.e., the sum of out-degree and in-degree minus one.  iPDA: To address both privacy-preservation and integrity-protection for WSNs, He et al. [32] proposed a data aggregation protocol called integrity-Protecting Private Data Aggregation (iPDA). The iPDA resorts to a redundancy check by constructing two disjoint aggregation trees to achieve integrity. Each sensor node needs to send its reading to both aggregation trees and the inputs to both trees are equal. The disjoint aggregation trees perform data aggregation individually. Therefore, data pollution attacks can be detected at the base station by comparing aggregation results along the disjoint aggregation trees. If the aggregation results agree with each other, then the base station will accept the result. Otherwise, it will treat the data to have pollution attacks or node failures, or both and reject it. The iPDA achieves data privacy by using the slicing and assembling technique of the SMART. In this protocol, each participating sensor node first hides its individual data by slicing the data and sending encrypted data slices to different neighboring aggregators. Then, the aggregators collect and route aggregated results back to the base station. Figure 7 illustrates disjoint aggregation trees composed of sky-blue and grey nodes that are separately rooted at the base station (yellow node). However, the iPDA has a high communication overhead due to the slicing technique and each sensor node has to send its reading to both aggregation trees. In addition, it can tolerate the collusion of up to a certain threshold number of sensor nodes. Although the threshold can be raised by increasing the number of slices, it will further increase communication overhead. Moreover, the accuracy of the aggregated result is decreased because of the high data collision rate due to the large number of messages in the network. 
## (s11) Privacy Homomorphism
(p11.0) Privacy Homomorphism (PH) has a special feature that allows arithmetic operations to be performed on cipher-text without decryption. This technique is fast and resource-efficient for privacy-preserving data aggregation, but it has a limitation that it performs only addition and multiplication operations. Before sensor data are sent to the aggregators, they are encrypted by using the respective keys of sensor nodes and they are added or multiplied without decryption. The CDA and AH scheme belong to PH-based protocols.

(p11.1) CDA: Girao et al. [33] proposed Concealed Data Aggregation (CDA) which conceals the process of data aggregation in WSN by using Domingo-Ferrer's (DF) approach [34]. In this protocol, each sensor node splits its data into d parts (d ≥ 2), encrypts them by using a public key and transmits them to the aggregator node. The aggregator node operates on the encrypted data, computes an aggregated value from the data without decryption and sends it to the sink. Next, the sink decrypts the encrypted aggregated value by using a private key to derive accumulated data. This allows the protocol to guarantee the privacy of the sensor nodes against a passive eavesdropper. Figure 8 illustrates data aggregation in the CDA where S 1 to S n , s 1 to s n , A, y' and R are sensor nodes, their respective encrypted data, aggregator node, encrypted aggregated value and sink node, respectively. Although the CDA is cheap in terms of computational resources, the CDA does not guarantee the privacy of individually sensed data against other nodes because the entire sensor nodes share the same encryption key with the BS. In addition, it does not protect against replay attacks and malicious aggregation where the contents of encrypted packets can be added as a summand to the aggregation result. AH scheme: The Additively Homomorphic (AH) encryption technique by Castelluccia et al. [35] protects privacy against other sensor nodes. The main idea of this approach is to replace the xor (Exclusive-OR) operation typically found in stream ciphers with modular addition (+). In the AH scheme, the encryption, decryption and aggregation processes are as given below where c, m, k and M are a cipher-text, a sensor data (message), a key shared with the BS and large integer, respectively. The AH scheme assumes that every node n i shares a key k i with the BS. Basically, a node n i adds a random number to its sensed value where the random number is determined by the key k i . After receiving the encrypted aggregate, the BS filters out the correct aggregate by subtracting all the random numbers added by the nodes.

(p11.2) There are several disadvantages of the AH scheme, despite providing data privacy cheaply in terms of computational cost. First, the AH scheme is not scalable because the base station must know the keys of all aggregated packets in order to decrypt the received result. This requires additional communication costs for the transmission of all participated nodes' IDs and corresponding security measures. There is no reliable solution to this problem, except that all nodes' IDs are transmitted to the sink node as plaintext. None of the known solutions can provide both data integrity and confidentiality on the high level of security. Second, the AH scheme is vulnerable to malicious modifications of data by adding natural numbers to the cipher text. Finally, the AH scheme does not support data integrity.
## (s14) Sheng and Li's scheme:
(p14.0) Sheng et al. [36] proposed a privacy-preserving storage scheme which associates a tag with each encrypted data in order to process a range query, by adopting the concept of bucketing [37] and indexing [38]. Their two-tiered network model consists of a powerful sink, regular sensor nodes, and storage nodes equipped with a large storage capacity, as shown in Figure 9. In this scheme, every sensor generates environmental data values at a fixed rate and periodically submits the collected data in the form of coarse information to the closest storage node. The storage nodes first bucketize the mixture of original data into a few bins before storing them. Both the sensor node and the sink node have agreed on the same bucket partition. Before transmitting the data to the storage nodes, the data source first encrypts the data by using the key shared with the sink and then attaches a tag to the encrypted data indicating the bucket into which the data falls. When the sink node needs to process a range query over the data stored in the storage nodes, it obtains an approximate result based on the tags corresponding to the query range, instead of having storage nodes decrypting every data point and returning them. Then, through decryption at the base station, the real data set can be derived. However, the main problem of this scheme is the transmission delay, i.e., sending data from sensors to the sink, which is critical for many tracking and event detection applications. In addition, this scheme does not consider the scenario of malicious modifications of sensor data.
## (s16) PIA:
(p16.0) To address Privacy-preserving Integrity-assured data Aggregation (PIA) for WSNs, recently, Taban et al. [39] proposed four distinct symmetric-key solutions. In their single aggregator model, an aggregator node is used as an intermediary between the user (i.e., a third party) and the sensor nodes that aggregates the sensor data and forwards the query response to the user, as shown in Figure 10. The problem is that the user wants to verify the integrity of the received aggregate value whereas the network owner does not want the user to access the original data. The proposed four solutions to the problem are as follows. The first scheme uses homomorphic encryption to hide the data. In this scheme, homomorphism and Message Authentication Code (MAC) [40] are combined to construct an authenticated encryption scheme for the aggregator model. However, it is limited to additive homomorphism and only supports aggregation functions such as add, average and standard deviation. The second scheme adopts an Order Preserving Encryption Scheme (OPES) [41] to preserve the privacy of the distribution of the data. For example, OPES preserves the order of the data such that any pair of plaintexts y 1 and y 2 , where y 1 < y 2 , encrypt to ciphertexts c 1 and c 2 , where c 1 < c 2 . However, this framework is useful for any aggregation function which can be approximated by uniform sampling [24,42] and which relies only on the comparison operation. The third scheme directly uses the Secure Hierarchical In-networking Aggregation (SHIA) scheme [22] for adapting distributed integrity verification to the single aggregated model. Because the sensor nodes have access to all of the raw data, this scheme can support any aggregation function. However, the scheme has the communication overhead of O(N) messages per sensor node, where N is the total number of sensor nodes in a network. To achieve data privacy and integrity assurance the third scheme is improved by introducing a logical aggregation tree within the aggregator node. This is the fourth scheme know the improved scheme and each sensor node has the communication overhead of O(log N). However, the scheme only supports decomposable functions, such as Mean, Standard Deviation, Count and Min/Max. Figure 10. Data aggregation from sensors A, B and C with two aggregators X and Y.
