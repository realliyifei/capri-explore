# AN OVERVIEW OF L 1 OPTIMAL TRANSPORTATION ON METRIC MEASURE SPACES

CorpusID: 119266179
 
tags: #Mathematics

URL: [https://www.semanticscholar.org/paper/7ceed288bcdcaf0b61072e23f7e39912b92d1766](https://www.semanticscholar.org/paper/7ceed288bcdcaf0b61072e23f7e39912b92d1766)
 
| Is Survey?        | Result          |
| ----------------- | --------------- |
| By Classifier     | False |
| By Annotator      | (Not Annotated) |

---

AN OVERVIEW OF L 1 OPTIMAL TRANSPORTATION ON METRIC MEASURE SPACES
13 Sep 2018

Fabio Cavalletti 
AN OVERVIEW OF L 1 OPTIMAL TRANSPORTATION ON METRIC MEASURE SPACES
13 Sep 2018
The scope of this note is to make a self-contained survey of the recent developments and achievements of the theory of L 1 -Optimal Transportation on metric measure spaces. Among the results proved in the recent papers[20,21]where the author, together with A. Mondino, proved a series of sharp (and in some cases rigid) geometric and functional inequalities in the setting of metric measure spaces enjoying a weak form of Ricci curvature lower bound, we review the proof of the Lévy-Gromov isoperimetric inequality. T ♯ µ 0 = µ 1 , i.e. µ 0 (T −1 (A)) = µ 1 (A), ∀ A Borel set;

## Introduction

The scope of this note is to make a self-contained survey of the recent developments and achievements of the theory of L 1 -Optimal Transportation on metric measure spaces. We will focus on the general scheme adopted in the recent papers [20,21] where the author, together with A. Mondino, proved a series of sharp (and in some cases even rigid and stable) geometric and functional inequalities in the setting of metric measure spaces enjoying a weak form of Ricci curvature lower bound. Roughly the general scheme consists in reducing the initial problem to a family of easier one-dimensional problems; as it is probably the most relevant result obtained with this technique, we will review in detail how to proceed to obtain the Lévy-Gromov isoperimetric inequality for metric measure spaces verifying the Riemmanian Curvature Dimension condition (or, more generally, essentially non-branching metric measure spaces verifying the Curvature Dimension condition).

In [11,18] a fine analysis of the Monge problem in the metric setting was done treating, with a different perspective, similar questions whose answers were later used also in [20,21]. We therefore believe the Monge problem and V.N. Sudakov's approach to it (see [53]) is a good starting point for our review and to see how L 1 -Optimal Transportation naturally yields a reduction of the problem to a family of one-dimensional problems.

It is worth stressing that the dimensional reduction proposed by V.N. Sudakov to solve the Monge problem is only one of the strategy to attack the problem. Monge problem has a long story and many different authors contributed to obtain solutions in different frameworks with different approaches; here we only mention that the first existence result for the Monge problem was independently obtained in [15] and in [54]. We also mention the subsequent generalizations obtained in [1,7,28] and we refer to the monograph [55] for a more complete list of results.

1.1. Monge problem. The original problem posed by Monge in 1781 can be restated in modern language as follows: given two Borel probability measures µ 0 and µ 1 over R d , called marginal measures, find the optimal manner of transporting µ 0 to µ 1 ; the transportation of µ 0 to µ 1 is understood as a map T : R d → R d assigning to each particle x a final position T (x) fulfilling the following compatibility condition (1.1) any map T verifying the previous condition will be called a transport map. The optimality requirement is stated as follows:
(1.2)ˆR d |T (x) − x| µ 0 (dx) ≤ˆR d |T (x) − x| µ 0 (dx),
for any otherT transport map. In proving the existence of a minimizer, the first difficulty appears studying the domain of the minimization, that is the set of maps T verifying (1.1). Suppose µ 0 = f 0 L d and µ 1 = f 1 L d where L d denotes the d-dimensional Lebesgue measure; a smooth injective map T is then a transport map if and only if
f 1 (T (x))| det(DT )(x)| = f 0 (x), µ 0 -a.e. x ∈ R d ,
showing a strong non-linearity of the constrain. The first big leap in optimal transportation theory was achieved by Kantorovich considering a suitable relaxation of the problem: associate to each transport map the probability measure (Id, T ) ♯ µ 0 over R d × R d and introduce the set of transport plans Π(µ 0 , µ 1 ) := π ∈ P(R d × R d ) : P 1 ♯ π = µ 0 , P 2 ♯ π = µ 1 ;

where P i : R d ×R d → R d is the projection on the i-th component, with i = 1, 2. By definition (Id, T ) ♯ µ 0 ∈ Π(µ 0 , µ 1 ) andˆR
d |T (x) − x| µ 0 (dx) =ˆR d ×R d |x − y| ((Id, T ) ♯ µ 0 ) (dxdy);
then it is natural to consider the minimization of the following functional (called Monge-Kantorovich minimization problem)
(1.3) Π(µ 0 , µ 1 ) ∋ π −→ I(π) :=ˆR d ×R d
|x − y| π(dxdy).

The big advantage being now that Π(µ 0 , µ 1 ) is a convex subset of P(R d × R d ) and it is compact with respect to the weak topology. Since the functional I is linear, the existence of a minimizer follows straightforwardly. Then a strategy to obtain a solution of the original Monge problem is to start from an optimal transport plan π and prove that it is indeed concentrated on the graph of a Borel map T ; the latter is equivalent to π = (Id, T ) ♯ µ 0 .

To run this program one needs to deduce from optimality some condition on the geometry of the support of the transport plan. This was again obtained by Kantorovich introducing a dual formulation of (1.3) and finding out that for any probability measures µ 0 and µ 1 with finite first moment, there exists a 1-Lipschitz function ϕ : R d → R such that Π(µ 0 , µ 1 ) ∋ π is optimal ⇐⇒ π {(x, y) ∈ R 2d : ϕ(x) − ϕ(y) = |x − y|} = 1.

At this point one needs to focus on the structure of the set (1.4) Γ := (x, y) ∈ R 2d : ϕ(x) − ϕ(y) = |x − y| .

Definition 1.1. A set Λ ⊂ R 2d is | · |-cyclically monotone if and only if for any finite subset of Λ,
{(x 1 , y 1 ), . . . , (x N , y N )} ⊂ Λ it holds 1≤i≤N |x i − y i | ≤ 1≤i≤N |x i − y i+1 |,
where y N +1 := y 1 .

Almost by definition, the set Γ is | · |-cyclically monotone and whenever (x, y) ∈ Γ considering z t := (1 − t)x + ty with t ∈ [0, 1] it holds that (z s , z t ) ∈ Γ, for any s ≤ t. In particular this suggests that Γ produces a family of disjoint lines of R d along where the optimal transportation should move. This can be made rigorous considering the following "relation" between points: a point x is in relation with y if, using optimal geodesics selected by the above optimal transport problem, one can travel from x to y or viceversa. That is, consider R := Γ ∪ Γ −1 and define x ∼ y if and only if (x, y) ∈ R. Then R d will be decomposed (up to a set of Lebesgue-measure zero) as T ∪ Z where T will be called the transport set and Z the set of points not moved by the optimal transportation problem. The important property of T being that T = q∈Q X q , X q straight line,
X q ∩ X q ′ = ∅, if q = q ′ .
Here Q is a set of indices; a convenient way to index a straight line X q is to select an element of X q and call it, with an abuse of notation, q. With this choice the set Q can be understood as a subset of R d . Once a partition of the space is given, one obtains via Disintegration Theorem a corresponding decomposition of marginal measures:
µ 0 =ˆQ µ 0 q q(dq), µ 1 =ˆQ µ 1 q q(dq);
where q is a Borel probability measure over the set of indices Q ⊂ R d . If Q enjoys a measurability condition (see Theorem 2.8 for details), the conditional measures µ 0 q and µ 1 q are concentrated on the straight line with index q, i.e. µ 0 q (X q ) = µ 1 q (X q ) = 1, for q-a.e. q ∈ Q. Then a classic way to construct an optimal transport maps is to -consider T q the monotone rearrangement along X q of µ 0 q to µ 1 q ; -define the transport map T as T q on each X q . The map T will be then an optimal transport map moving µ 0 to µ 1 ; it is indeed easy to check that (Id, T ) ♯ µ 0 ∈ Π(µ 0 , µ 1 ) and (x, T (x)) ∈ Γ for µ 0 -a.e. x.

So the original Monge problem has been reduced to the following family of one-dimensional problems: for each q ∈ Q find a minimizer of the following functional Π(µ 0 q , µ 1 q ) ∋ π −→ I(π) :=ˆX q ×Xq |x − y| π(dxdy), that is concentrated on the graph of a Borel function. As X q is isometric to the real line, whenever µ 0 q does not contain any atom (i.e µ 0 q (x) = 0, for all x ∈ X q ), the monotone rearrangement T q exists and the existence of an optimal transport map T constructed as before follows. The existence of a solution has been reduced therefore to a regularity property of the disintegration of µ 0 .

As already stressed before, this approach to the Monge problem, mainly due to V.N. Sudakov, was proposed in [53] and was later completed in the subsequent papers [15] and in [54]. See also [23] for a complete Sudakov approach to Monge problem when the Euclidean distance is replaced by any strictly convex norm and [12] where any norm is considered. In all these papers, assuming µ 0 to be absolutely continuous with respect to L d give the sufficient regularity to solve the problem.

The Monge problem can be actually stated, and solved, in a much more general framework. Given indeed two Borel probability measures µ 0 and µ 1 over a complete and separable metric space (X, d), the notion of transportation map perfectly makes sense and the optimality condition (1.2) can be naturally formulated using the distance d as a cost function instead of the Euclidean norm:
(1.5)ˆR d d(T (x), x) µ 0 (dx) ≤ˆR d d(T (x), x) µ 0 (dx).
The problem can be relaxed to obtain a transport plan π solution of the corresponding Monge-Kantorovich minimization problem. Also the Kantorovich duality applies yielding the existence of a 1-Lipschitz function ϕ : X → R such that
Π(µ 0 , µ 1 ) ∋ π is optimal ⇐⇒ π Γ = 1, where Γ := {(x, y) ∈ X × X : ϕ(x) − ϕ(y) = d(x, y)} is d-cyclically monotone.
All the strategy proposed for the Euclidean problem can be adopted: produce a decomposition of X as T ∪Z where Z is the set of points not moved by the optimal transportation problem and T is the transport set and it is partitioned, up to a set of measure zero, by a family of geodesics {X q } q∈Q ; via Disintegration Theorem one obtains as before a reduction of the Monge problem to a family of one-dimensional problems Π(µ 0 q , µ 1 q ) ∋ π −→ I(π) :=ˆX q ×Xq d(x, y) π(dxdy).

Therefore, since X q with distance d is isometric to an interval of the real line with Euclidean distance, the problem is reduced to proving that for q-a.e. q ∈ Q the conditional measure µ 0 q does not have any atoms.

Clearly in showing such a result, besides the regularity of µ 0 itself, the regularity of the ambient space X does play a crucial role. In particular, together with the localization of the Monge problem to X q , it should come a localization of the regularity of the space. This is the case when the metric space (X, d) is endowed with a reference probability measure m and the resulting metric measure space (X, d, m) verifies a weak Ricci curvature lower bound.

In [11] we in fact observed that if (X, d, m) verifies the so-called measure contraction property MCP, then for q-a.e. q ∈ Q the one-dimensional metric measure space (X q , d, m q ) verifies MCP as well, where m q is the conditional measure of m with respect to the family of geodesics {X q } q∈Q . Now the assumption µ 0 ≪ m is sufficient to solve the Monge problem. It is worth mentioning that [11] was the first contribution where regularity of conditional measures were obtained in a purely non-smooth framework. The techniques introduced in [11] permitted also to threat such regularity issues in the infinite dimensional setting of Wiener space; see [16].

This short introduction should suggest that L 1 -Optimal Transportation permits to obtain an efficient dimensional reduction together with a localization of the "smoothness" of the space for very general metric measure spaces. We now make a short introduction also to the Lévy-Gromov isoperimetric inequality.

1.2. Lévy-Gromov isoperimetric inequality. The Lévy-Gromov isoperimetric inequality [35, Appendix C] can be stated as follows: if E is a (sufficiently regular) subset of a Riemannian manifold (M N , g) with dimension N and Ricci bounded below by K > 0, then
(1.6) |∂E| |M | ≥ |∂B| |S| ,
where B is a spherical cap in the model sphere S, i.e. the N -dimensional sphere with constant Ricci curvature equal to K, and |M |, |S|, |∂E|, |∂B| denote the appropriate N or N − 1 dimensional volume, and where B is chosen so that |E|/|M | = |B|/|S|. As K > 0 both M and S are compact and their volume is finite; hence the previous equality and (1.6) makes sense. In other words, the Lévy-Gromov isoperimetric inequality states that isoperimetry in (M, g) is at least as strong as in the model space S.

A general introduction on the isoperimetric problem goes beyond the scopes of this note; here it is worth mentioning that a complete description of isoperimetric inequality in spaces admitting singularities is quite an hard task and the bibliography reduces to [42,45,44]. See also [25, Appendix H] for more details. We also include the following reference to the isoperimetric problem corresponding to different approaches: for a geometric measure theory approach see [43]; for the point of view of optimal transport see [29,56]; for the connections with convex and integral geometry see [14]; for the recent quantitative forms see [24,31] and finally for an overview of the more geometric aspects see [46,48,49].

Coming back to Lévy-Gromov isoperimetric inequality, it makes sense naturally also in the broader class of metric measure spaces, i.e. triples (X, d, m) where (X, d) is complete and separable and m is a Radon measure over X. Indeed the volume of a Borel set is replaced by its m-measure, m(E); the boundary area of the smooth framework instead can be replaced by the Minkowski content:
(1.7) m + (E) := lim inf ε↓0 m(E ε ) − m(E) ε ,
where E ε := {x ∈ X : ∃y ∈ E such that d(x, y) < ε} is the ε-neighborhood of E with respect to the metric d; the natural analogue of "dimension N and Ricci bounded below by K > 0" is encoded in the so-called Riemannian Curvature Dimension condition, RCD * (K, N ) for short. As normalization factors appears in (1.6), it is also more convenient to directly consider the case m(X) = 1.

So the Lévy-Gromov isoperimetric problem for a m.m.s. (X, d, m) with m(X) = 1 can be formulated as follows:

Find the largest function I K,N : [0, 1] → R + such that for every Borel subset E ⊂ X it holds m + (E) ≥ I K,N (m(E)), with I K,N depending on N, K ∈ R with K > 0 and N > 1.

Then in [20] (Theorem 1.2) the author with A. Mondino proved the non-smooth Lévy-Gromov isoperimetric inequality (1.6) Theorem 1.2 (Lévy-Gromov in RCD * (K, N )-spaces, Theorem 1.2 of [20]). Let (X, d, m) be an RCD * (K, N ) space for some N ∈ N and K > 0 and m(X) = 1. Then for every Borel subset E ⊂ X it holds
m + (E) ≥ |∂B| |S| ,
where B is a spherical cap in the model sphere S (the N -dimensional sphere with constant Ricci curvature equal to K) chosen so that |B|/|S| = m(E).

We refer to Theorem 1.2 of [20] (or Theorem 6.6) for the more general statement.

The link between Theorem 1.2 and the first part of the Introduction, where the Monge problem was discussed, stands in the techniques used to prove Theorem 1.2.

The main obstacle to Lévy-Gromov type inequalities in the non-smooth metric measure spaces setting is that the previously known proofs rely on regularity properties of isoperimetric regions and on powerful results of geometric measure theory (see for instance [35,43]) that are out of disposal in the framework of metric measure spaces. The recent paper of B. Klartag [38] permitted to obtain a proof of the Lévy-Gromov isoperimetric inequality, still in the framework of smooth Riemannian manifolds, avoiding regularity of optimal shapes and using instead an optimal transportation argument involving L 1 -Optimal Transportation and ideas of convex geometry. This approach goes back to Payne-Weinberger [47] and was later developed by Gromov-Milman [36], Lovász-Simonovits [40] and Kannan-Lovász-Simonovits [37]; it consists in reducing a multi-dimensional problem, to easier one-dimensional problems. B. Klartag's contribution was to observe that a suitable L 1 -Optimal Transportation problem produces what he calls a needle decomposition (in our terminology will be called disintegration) that localize (or reduce) the proof of the isoperimetric inequality to the proof of a family of one-dimensional isoperimetric inequalities; also the regularity of the space is localized.

The approach of [38] does not rely on the regularity of the isoperimetric region, nevertheless it still heavily makes use of the smoothness of the ambient space to obtain the localization; in particular it makes use of sharp properties of the geodesics in terms of Jacobi fields and estimates on the second fundamental forms of suitable level sets, all objects that are still not enough understood in general metric measure space in order to repeat the same arguments.

Hence to apply the localization technique to the Lévy-Gromov isoperimetric inequality in singular spaces, structural properties of geodesics and of L 1 -optimal transportation have to be understood also in the general framework of metric measure spaces. Such a program already started in the previous work of the author with S. Bianchini [11] and of the author [18,17]. Finally with A. Mondino in [20] we obtained the general result permitting to obtained the Lévy-Gromov isoperimetric inequality.


## 1.3.

Outline. The outline of the paper goes as follows: Section 2 contains all the basic material on Optimal Transportation and the theory of Lott-Sturm-Villani spaces, that is metric measure spaces verifying the Curvature Dimension condition, CD(K, N ) for short. It also covers some basics on isoperimetric inequality, Disintegration Theorem and selection theorems we will use during the paper. In Section 3 we prove all the structure results on the building block of L 1 -Optimal Transportation, the d-cyclically monotone sets. Here no curvature assumption enters. In Section 4 we show that the aforementioned sets induce a partition of almost all transport, provided the space enjoies a stronger form of the essentially non-branching condition; we also show that each element of the partition is a geodesic (and therefore a one-dimensional set). Section 5 contains all the regularity results of conditional measures of the disintegration induced by the L 1 -Optimal Transportation problem. In particular we will present three assumptions, each one implying the previous one, yielding three increasing level of regularity of the conditional measures. Finally in Section 6 we collect the consequences of the regularity results of Section 5; in particular we first show the existence of a solution of the Monge problem under very general regularity assumption (Theorem 6.2) and finally we go back to the Lévy-Gromov isoperimetric inequality (Theorem 6.6).


## Preliminaries

In what follows we say that a triple (X, d, m) is a metric measure space, m.m.s. for short, if (X, d) is a complete and separable metric space and m is positive Radon measure over X. For this paper we will only be concerned with m.m.s. with m probability measure, that is m(X) = 1. The space of all Borel probability measures over X will be denoted by P(X).

A metric space is a geodesic space if and only if for each x, y ∈ X there exists γ ∈ Geo(X) so that
γ 0 = x, γ 1 = y, with Geo(X) := {γ ∈ C([0, 1], X) : d(γ s , γ t ) = |s − t|d(γ 0 , γ 1 ), for every s, t ∈ [0, 1]}.
It follows from the metric version of the Hopf-Rinow Theorem (see Theorem 2.5.28 of [13]) that for complete geodesic spaces, local completeness is equivalent to properness (a metric space is proper if every closed ball is compact).

So we assume the ambient space (X, d) to be proper and geodesic, hence also complete and separable. Moreover we assume m to be a proability measure, i.e. m(X) = 1.

We denote by P 2 (X) the space of probability measures with finite second moment endowed with the L 2 -Wasserstein distance W 2 defined as follows: for µ 0 , µ 1 ∈ P 2 (X) we set
(2.1) W 2 2 (µ 0 , µ 1 ) = inf πˆX ×X d 2 (x, y) π(dxdy),
where the infimum is taken over all π ∈ P(X × X) with µ 0 and µ 1 as the first and the second marginal, called the set of transference plans. The set of transference plans realizing the minimum in (2.1) will be called the set of optimal transference plans. Assuming the space (X, d) to be geodesic, also the space (P 2 (X), W 2 ) is geodesic. Any geodesic (µ t ) t∈[0,1] in (P 2 (X), W 2 ) can be lifted to a measure ν ∈ P(Geo(X)), so that (e t ) ♯ ν = µ t for all t ∈ [0, 1]. Here for any t ∈ [0, 1], e t denotes the evaluation map: e t : Geo(X) → X, e t (γ) := γ t .

Given µ 0 , µ 1 ∈ P 2 (X), we denote by OptGeo(µ 0 , µ 1 ) the space of all ν ∈ P(Geo(X)) for which (e 0 , e 1 ) ♯ ν realizes the minimum in (2.1). If (X, d) is geodesic, then the set OptGeo(µ 0 , µ 1 ) is non-empty for any µ 0 , µ 1 ∈ P 2 (X). It is worth also introducing the subspace of P 2 (X) formed by all those measures absolutely continuous with respect with m: it is denoted by P 2 (X, d, m).


## 2.1.

Geometry of metric measure spaces. Here we briefly recall the synthetic notions of lower Ricci curvature bounds, for more detail we refer to [9,39,51,52,56].

In order to formulate the curvature properties for (X, d, m) we introduce the following distortion coefficients: given two numbers K, N ∈ R with N ≥ 0, we set for (t, θ) ∈ [0, 1] × R + ,
(2.2) σ (t) K,N (θ) :=                    ∞, if Kθ 2 ≥ N π 2 , sin(tθ K/N ) sin(θ K/N ) if 0 < Kθ 2 < N π 2 , t if Kθ 2 < 0 and N = 0, or if Kθ 2 = 0, sinh(tθ −K/N ) sinh(θ −K/N )
if Kθ 2 ≤ 0 and N > 0.

We also set, for N ≥ 1, K ∈ R and (t, θ)
∈ [0, 1] × R + (2.3) τ (t) K,N (θ) := t 1/N σ (t) K,N −1 (θ) (N −1)/N .
As we will consider only the case of essentially non-branching spaces, we recall the following definition.

Definition 2.1. A metric measure space (X, d, m) is essentially non-branching if and only if for any µ 0 , µ 1 ∈ P 2 (X), with µ 0 absolutely continuous with respect to m, any element of OptGeo(µ 0 , µ 1 ) is concentrated on a set of non-branching geodesics.

A set F ⊂ Geo(X) is a set of non-branching geodesics if and only if for any γ 1 , γ 2 ∈ F , it holds: 
∃t ∈ (0, 1) such that ∀t ∈ [0,t ] γ 1 t = γ 2 t =⇒ γ 1 s = γ 2 s , ∀s ∈ [0, 1].µ 0 , µ 1 ∈ P 2 (X, d, m) there exists ν ∈ OptGeo(µ 0 , µ 1 ) such that (2.4) ̺ −1/N t (γ t ) ≥ τ (1−t) K,N (d(γ 0 , γ 1 ))̺ −1/N 0 (γ 0 ) + τ (t) K,N (d(γ 0 , γ 1 ))̺ −1/N 1 (γ 1 ), ν-a.e. γ ∈ Geo(X), for all t ∈ [0, 1], where (e t ) ♯ ν = ̺ t m.
For the general definition of CD(K, N ) see [39,51,52]. 
Ric g,h,N ≥ Kg, Ric g,h,N := Ric g − (N − n) ∇ 2 g h 1 N −n h 1 N −n .
In particular if N = n the generalized Ricci tensor Ric g,h,N = Ric g makes sense only if h is constant.

Another important case is when I ⊂ R is any interval, h ∈ C 2 (I) and L 1 is the one-dimensional Lebesgue measure; then the m.m.s. (I, | · |, hL 1 ) verifies CD(K, N ) if and only if 
(2.5) h 1 N −1 ′′ + K N − 1 h 1 N −1 ≤ 0,(2.6) h((1 − s)t 0 + st 1 ) 1/(N −1) ≥ σ (1−s) K,N −1 (t 1 − t 0 )h(t 0 ) 1/(N −1) + σ (s) K,N −1 (t 1 − t 0 )h(t 1 ) 1/(N −1)
, that is the formulation in the sense of distributions of the differential inequality
h 1 N −1 ′′ + K N − 1 h 1 N −1 ≤ 0. Recall indeed that s → σ (s) K,N −1 (θ) solves in the classical sense f ′′ + (t 1 − t 0 ) 2 K N −1 f = 0.
We also mention the more recent Riemannian curvature dimension condition RCD * (K, N ). In the infinite dimensional case, i.e. N = ∞, it was introduced [5]. The class RCD * (K, N ) with N < ∞ has been proposed in [33] and deeply investigated in [3,26] and [8]. We refer to these papers and references therein for a general account on the synthetic formulation of Ricci curvature lower bounds for metric measure spaces.

Here we only mention that RCD * (K, N ) condition is an enforcement of the so called reduced curvature dimension condition, denoted by CD * (K, N ), that has been introduced in [9]: in particular the additional condition is that the Sobolev space W 1,2 (X, m) is an Hilbert space, see [33,4,5].

The reduced CD * (K, N ) condition asks for the same inequality (2.4) of CD(K, N ) but the coefficients τ
(t) K,N (d(γ 0 , γ 1 )) and τ (1−t) K,N (d(γ 0 , γ 1 )) are replaced by σ (t) K,N (d(γ 0 , γ 1 )) and σ (1−t) K,N (d(γ 0 , γ 1 )), respectively.
Hence while the distortion coefficients of the CD(K, N ) condition are formally obtained imposing one direction with linear distortion and N − 1 directions affected by curvature, the CD * (K, N ) condition imposes the same volume distortion in all the N directions.

For both definitions there is a local version that is of some relevance for our analysis. Here we state only the local formulation CD(K, N ), being clear what would be the one for CD * (K, N ). Definition 2.4 (CD loc condition). An essentially non-branching m.m.s. (X, d, m) satisfies CD loc (K, N ) if for any point x ∈ X there exists a neighborhood X(x) of x such that for each pair µ 0 , µ 1 ∈ P 2 (X, d, m) supported in X(x) there exists ν ∈ OptGeo(µ 0 , µ 1 ) such that (2.4) holds true for all t ∈ [0, 1]. The support of (e t ) ♯ ν is not necessarily contained in the neighborhood X(x).

One of the main properties of the reduced curvature dimension condition is the globalization one: under the essentially non-branching property, CD * loc (K, N ) and CD * (K, N ) are equivalent (see [9,Corollary 5.4]), i.e. the CD * -condition verifies the local-to-global property.

We also recall a few relations between CD and CD * . It is known by [32,Theorem 2.7] that, if (X, d, m) is a non-branching metric measure space verifying CD(K, N ) and µ 0 , µ 1 ∈ P(X) with µ 0 absolutely continuous with respect to m, then there exists a unique optimal map T : X → X such (id, T ) ♯ µ 0 realizes the minimum in (2.1) and the set OptGeo(µ 0 , µ 1 ) contains only one element. The same proof holds if one replaces the non-branching assumption with the more general one of essentially non-branching, see for instance [34].


## 2.2.

Isoperimetric profile function. Given a m.m.s. (X, d, m) as above and a Borel subset A ⊂ X, let A ε denote the ε-tubular neighborhood
A ε := {x ∈ X : ∃y ∈ A such that d(x, y) < ε}. The Minkowski (exterior) boundary measure m + (A) is defined by (2.7) m + (A) := lim inf ε↓0 m(A ε ) − m(A) ε .
The isoperimetric profile, denoted by I (X,d,m) , is defined as the point-wise maximal function so that
m + (A) ≥ I (X,d,m) (m(A)) for every Borel set A ⊂ X, that is (2.8) I (X,d,m) (v) := inf m + (A) : A ⊂ X Borel, m(A) = v .
If K > 0 and N ∈ N, by the Lévy-Gromov isoperimetric inequality (1.6) we know that, for Ndimensional smooth manifolds having Ricci ≥ K, the isoperimetric profile function is bounded below by the one of the N -dimensional round sphere of the suitable radius. In other words the model isoperimetric profile function is the one of S N . For N ≥ 1, K ∈ R arbitrary real numbers the situation is more complicated, and just recently E. Milman [41] discovered what is the model isoperimetric profile. We refer to [41] for all the details. Here we just recall the relevance of isoperimetric profile functions for m.m.s. over (R, | · |): given K ∈ R, N ∈ [1, +∞) and D ∈ (0, +∞], consider the function
(2.9) I K,N,D (v) := inf µ + (A) : A ⊂ R, µ(A) = v, µ ∈ F K,N,D , where F K,N,D denotes the set of µ ∈ P(R) such that supp(µ) ⊂ [0, D] and µ = h · L 1 with h ∈ C 2 ((0, D)) satisfying (2.10) h 1 N −1 ′′ + K N − 1 h 1 N −1 ≤ 0 if N ∈ (1, ∞), h ≡ const if N = 1.
Then from [41, Theorem 1.2, Corollary 3.2] it follows that for N -dimensional smooth manifolds having Ricci ≥ K, with K ∈ R arbitrary real number, and diameter D, the isoperimetric profile function is bounded below by I K,N,D and the bound is sharp. This also justifies the notation.

Going back to non-smooth metric measure spaces (what follows is taken from [20]), it is necessary to consider the following broader family of measures: (2.11) and the corresponding comparison synthetic isoperimetric profile:
F s K,N,D := {µ ∈ P(R) : supp(µ) ⊂ [0, D], µ = h µ L 1 , h µ verifies (2.6) and is continuous if N ∈ (1, ∞), h µ ≡ const if N = 1},I s K,N,D (v) := inf µ + (A) : A ⊂ R, µ(A) = v, µ ∈ F s K,N,D ,
where µ + (A) denotes the Minkowski content defined in (2.7). The term synthetic refers to µ ∈ F s K,N,D meaning that the Ricci curvature bound is satisfied in its synthetic formulation: if µ = h · L 1 , then h verifies (2.6).

We have already seen that F K,N,D ⊂ F s K,N,D ; actually one can prove that I s K,N,D coincides with its smooth counterpart I K,N,D for every volume v ∈ [0, 1] via a smoothing argument. We therefore need the following approximation result. In order to state it let us recall that a standard mollifier in R is a non negative C ∞ (R) function ψ with compact support in [0, 1] such that´R ψ = 1.
Lemma 2.5 (Lemma 6.2, [20]). Let D ∈ (0, ∞) and let h : [0, D] → [0, ∞) be a continuous function. Fix N ∈ (1, ∞) and for ε > 0 define (2.12) h ε (t) := [h 1 N −1 * ψ ε (t)] N −1 := ˆR h(t − s) 1 N −1 ψ ε (s) ds N −1 = ˆR h(s) 1 N −1 ψ ε (t − s) ds N −1 ,
where ψ ε (x) = 1 ε ψ(x/ε) and ψ is a standard mollifier function. The following properties hold:
(1) h ε is a non-negative C ∞ function with support in [−ε, D + ε]; (2) h ε → h uniformly as ε ↓ 0, in particular h ε → h in L 1 .
(3) If h satisfies the convexity condition (5.5) corresponding to the above fixed N > 1 and some K ∈ R then also h ε does. In particular h ε satisfies the differential inequality (2.10).

Using this approximation one can prove the following
Theorem 2.6 (Theorem 6.3, [20]). For every v ∈ [0, 1], K ∈ R, N ∈ [1, ∞), D ∈ (0, ∞] it holds I s K,N,D (v) = I K,N,D (v).

### Disintegration of measures.

We include here a version of Disintegration Theorem that we will use. We will follow Appendix A of [10] where a self-contained approach (and a proof) of Disintegration Theorem in countably generated measure spaces can be found. An even more general version of Disintegration Theorem can be found in Section 452 of [30].

Recall that a σ-algebra is countably generated if there exists a countable family of sets so that the σ-algebra coincide with the smallest σ-algebra containing them.

Given a measurable space (X, X ), i.e. X is a σ-algebra of subsets of X, and a function Q : X → Q, with Q general set, we can endow Q with the push forward σ-algebra Q of X :
C ∈ Q ⇐⇒ Q −1 (C) ∈ X ,
which could be also defined as the biggest σ-algebra on Q such that Q is measurable. Moreover given a probability measure m on (X, X ), define a probability measure q on (Q, Q) by push forward via Q, i.e. q := Q ♯ m.

This general scheme fits with the following situation: given a measure space (X, X , m), suppose a partition of X is given in the form {X q } q∈Q , Q is the set of indices and Q : X → Q is the quotient map, i.e. q = Q(x) ⇐⇒ x ∈ X q . Following the previous scheme, we can consider also the quotient σ-algebra Q and the quotient measure q obtaining the quotient measure space (Q, Q, q).
Definition 2.7. A disintegration of m consistent with Q is a map Q ∋ q −→ m q ∈ P(X, X )
such that the following hold:

(1) for all B ∈ X , the map m · (B) is q-measurable;

(2) for all B ∈ X , C ∈ Q satisfies the consistency condition
m B ∩ Q −1 (C) =ˆC m q (B) q(dq).
A disintegration is strongly consistent with respect to Q if for q-a.e. q ∈ Q we have m q (Q −1 (q)) = 1. The measures m q are called conditional probabilities.

When the map Q is induced by a partition of X as before, we will directly say that the disintegration is consistent with the partition, meaning that the disintegration is consistent with the quotient map Q associated to the partition X = ∪ q∈Q X q .

We now report Disintegration Theorem.

Theorem 2.8 (Theorem A.7, Proposition A.9 of [10]). Assume that (X, X , ρ) is a countably generated probability space and X = ∪ q∈Q X q is a partition of X.

Then the quotient probability space (Q, Q, q) is essentially countably generated and there exists a unique disintegration q → m q consistent with the partition X = ∪ q∈Q X q .

The disintegration is strongly consistent if and only if there exists a m-section S ∈ X such that the σ-algebra S contains B(S).

We expand the statement of Theorem 2.8. In the measure space (Q, Q, q), the σ-algebra Q is essentially countably generated if, by definition, there exists a countable family of sets Q n ⊂ Q such that for any C ∈ Q there existsĈ ∈Q, whereQ is the σ-algebra generated by {Q n } n∈N , such that q(C ∆Ĉ) = 0.

Uniqueness is understood in the following sense: if q → m 1 q and q → m 2 q are two consistent disintegrations then m 1 q = m 2 q for q-a.e. q ∈ Q. Finally, a set S is a section for the partition
X = ∪ q X q if for any q ∈ Q there exists a unique x q ∈ S∩X q . A set S m is an m-section if there exists Y ⊂ X with m(X \ Y ) = 0 such that the partition Y = ∪ q (X q ∩ Y )
has section S m . Once a section (or an m-section) is given, one can obtain the measurable space (S, S ) by pushing forward the σ-algebra X on S via the map that associates to any X q ∋ x → x q = S ∩ X q .


## Transport set

The following setting is fixed once for all: (X, d, m) is a fixed metric measure space with m(X) = 1 such that the ambient metric space (X, d) is geodesic and proper (hence complete and separable).

Let ϕ : X → R be any 1-Lipschitz function. Here we present some useful results (all of them already presented in [11]) concerning the d-cyclically monotone set associated with ϕ:
(3.1) Γ := {(x, y) ∈ X × X : ϕ(x) − ϕ(y) = d(x, y)},
that can be seen as the set of couples moved by ϕ with maximal slope. Recall that a set Λ ⊂ X × X is said to be d-cyclically monotone if for any finite set of points (
x 1 , y 1 ), . . . , (x N , y N ) it holds N i=1 d(x i , y i ) ≤ N i=1 d(x i , y i+1 ),
with the convention that y N +1 = y 1 .

The following lemma is a consequence of the d-cyclically monotone structure of Γ.
Lemma 3.1. Let (x, y) ∈ X × X be an element of Γ. Let γ ∈ Geo(X) be such that γ 0 = x and γ 1 = y. Then (γ s , γ t ) ∈ Γ,
for all 0 ≤ s ≤ t ≤ 1.

Proof. Take 0 ≤ s ≤ t ≤ 1 and note that
ϕ(γ s ) − ϕ(γ t ) = ϕ(γ s ) − ϕ(γ t ) + ϕ(γ 0 ) − ϕ(γ 0 ) + ϕ(γ 1 ) − ϕ(γ 1 ) ≥ d(γ 0 , γ 1 ) − d(γ 0 , γ s ) − d(γ t , γ 1 ) = d(γ s , γ t ).
The claim follows.

It is natural then to consider the set of geodesics G ⊂ Geo(X) such that
γ ∈ G ⇐⇒ {(γ s , γ t ) : 0 ≤ s ≤ t ≤ 1} ⊂ Γ, that is G := {γ ∈ Geo(X) : (γ 0 , γ 1 ) ∈ Γ}.
We now recall some basic definitions of the L 1 -optimal transportation theory that will be needed to describe the structure of Γ.
Definition 3.2.
We define the set of transport rays by
R := Γ ∪ Γ −1 , where Γ −1 := {(x, y) ∈ X × X : (y, x) ∈ Γ}.
The set of initial points and final points are defined respectively by
a :={z ∈ X : ∄ x ∈ X, (x, z) ∈ Γ, d(x, z) > 0}, b :={z ∈ X : ∄ x ∈ X, (z, x) ∈ Γ, d(x, z) > 0}.
The set of end points is a ∪ b. We define the subset of X, transport set with end points:
T e = P 1 (Γ \ {x = y}) ∪ P 1 (Γ −1 \ {x = y}). where {x = y} stands for {(x, y) ∈ X 2 : d(x, y) = 0}.
Few comments are in order. Notice that R coincide with {(x, y) ∈ X × X : |ϕ(x) − ϕ(y)| = d(x, y)}; the name transport set with end points for T e is motivated by the fact that later on we will consider a more regular subset of T e that will be called transport set; moreover if x ∈ X for instance is moved forward but not backward by ϕ, this is translated in x ∈ Γ and x / ∈ Γ −1 ; anyway it belongs to T e . We also introduce the following notation that will be used throughout the paper; we set Γ(x) :=
P 2 (Γ ∩ ({x} × X)) and Γ −1 (x) := P 2 (Γ −1 ∩ ({x} × X)). More in general if F ⊂ X × X, we set F (x) = P 2 (F ∩ ({x} × X)).

## Remark 3.3.

Here we discuss the measurability of the sets introduced in Definition 3.2. Since ϕ is 1-Lipschitz, Γ is closed and therefore Γ −1 and R are closed as well. Moreover by assumption the space is proper, hence the sets Γ, Γ −1 , R are σ-compact (countable union of compact sets).

Then we look at the set of initial and final points:
a = P 2 (Γ ∩ {(x, z) ∈ X × X : d(x, z) > 0}) c , b = P 1 (Γ ∩ {(x, z) ∈ X × X : d(x, z) > 0}) c . Since {(x, z) ∈ X × X : d(x, z) > 0} = ∪ n {(x, z) ∈ X × X : d(x, z) ≥ 1/n}, it
follows that it follows that both a and b are the complement of σ-compact sets. Hence a and b are Borel sets. Reasoning as before, it follows that T e is a σ-compact set.
Lemma 3.4. Let π ∈ Π(µ 0 , µ 1 ) with π(Γ) = 1, then π(T e × T e ∪ {x = y}) = 1.
Proof. It is enough to observe that if (z, w) ∈ Γ with z = w, then w ∈ Γ(z) and z ∈ Γ −1 (w) and therefore
(z, w) ∈ T e × T e .
Hence Γ \ {x = y} ⊂ T e × T e . Since π(Γ) = 1, the claim follows.

As a consequence, µ 0 (T e ) = µ 1 (T e ) and any optimal map T such that T ♯ µ 0 Te = µ 1 Te can be extended to an optimal map T ′ with T ′ ♯ µ 0 = µ 1 with the same cost by setting
(3.2) T ′ (x) = T (x), if x ∈ T e x, if x / ∈ T e .
It can be proved that the set of transport rays R induces an equivalence relation on a subset of T e . It is sufficient to remove from T e the branching points of geodesics. Then using curvature properties of the space, one can prove that such branching points all have m-measure zero.

3.1. Branching structures in the Transport set. What follows was first presented in [18]. Consider the sets of respectively forward and backward branching points
A + := {x ∈ T e : ∃z, w ∈ Γ(x), (z, w) / ∈ R}, A − := {x ∈ T e : ∃z, w ∈ Γ(x) −1 , (z, w) / ∈ R}. (3.3)
The sets A ± are σ-compact sets. Indeed since (X, d) is proper, any open set is σ-compact. The main motivation for the definition of A + and A − is contained in the next Theorem 3.5. The set of transport rays R ⊂ X × X is an equivalence relation on the set
T e \ (A + ∪ A − ) . Proof. First, for all x ∈ P 1 (Γ), (x, x) ∈ R. If x, y ∈ T e with (x, y) ∈ R, then by definition of R, it follows straightforwardly that (y, x) ∈ R.
So the only property needing a proof is transitivity. Let x, z, w ∈ T e \ (A + ∪ A − ) be such that (x, z), (z, w) ∈ R with x, z and w distinct points. The claim is (x, w) ∈ R. So we have 4 different possibilities: the first one is z ∈ Γ(x), w ∈ Γ(z).

This immediately implies w ∈ Γ(x) and therefore (x, w) ∈ R. The second possibility is
z ∈ Γ(x), z ∈ Γ(w),
that can be rewritten as (z, x), (z, w) ∈ Γ −1 . Since z / ∈ A − , necessarily (x, w) ∈ R. Third possibility:

x ∈ Γ(z), w ∈ Γ(z), and since z / ∈ A + it follows that (x, w) ∈ R. The last case is
x ∈ Γ(z), z ∈ Γ(w),
and therefore x ∈ Γ(w), hence (x, w) ∈ R and the claim follows.

Next, we show that each equivalence class of R is formed by a single geodesic.
Lemma 3.6. For any x ∈ T and z, w ∈ R(x) there exists γ ∈ G ⊂ Geo(X) such that {x, z, w} ⊂ {γ s : s ∈ [0, 1]}.
Ifγ ∈ G enjoys the same property, then
{γ s : s ∈ [0, 1]} ∪ {γ s : s ∈ [0, 1]} ⊂ {γ s : s ∈ [0, 1]}
for someγ ∈ G.

Since G = {γ ∈ Geo(X) : (γ 0 , γ 1 ) ∈ Γ}, Lemma 3.6 states that as soon as we fix an element x in T e \ (A + ∪ A − ) and we pick two elements z, w in the same equivalence class of x, then these three points are aligned on a geodesic γ whose image is again all contained in the same equivalence class R(x).

Proof. Assume that x, z and w are all distinct points otherwise the claim follows trivially. We consider different cases.

First case: z ∈ Γ(x) and w ∈ Γ −1 (x). By d-cyclical monotonicity
d(z, w) ≤ d(z, x) + d(x, w) = ϕ(w) − ϕ(z) ≤ d(z, w).
Hence z, x and w lie on a geodesic.

Second case: z, w ∈ Γ(x). Without loss of generality ϕ(x) ≥ ϕ(w) ≥ ϕ(z). Since in the proof of Lemma 4.2 we have already excluded the case ϕ(w) = ϕ(z), we assume ϕ(x) > ϕ(w) > ϕ(z). Then if there would not exist any geodesics γ ∈ G with γ 0 = x and γ 1 = z and γ s = w, there will be γ ∈ G with (γ 0 , γ 1 ) = (x, z) and s ∈ (0, 1) such that
ϕ(γ s ) = ϕ(w), γ s ∈ Γ(x), γ s = w.
As observed in the proof of Lemma 4.2, this would imply that (γ s , w) / ∈ R and since x / ∈ A + this would be a contradiction. Hence the second case follows.

The remaining two cases follow with the same reasoning, exchanging the role of Γ(x) with the one of Γ −1 (x). The second part of the statement follows now easily.


## Cyclically monotone sets

Following Theorem 3.5 and Lemma 3.6, the next step is to prove that both A + and A − have mmeasure zero, that is branching happens on rays with zero m-measure. Already from the statement of this property, it is clear that some regularity assumption on (X, d, m) should play a role. We will indeed assume the space to enojoy a stronger form of essentially non-branching. Recall that the latter is formulated in terms of geodesics of (P 2 (X), W 2 ) hence of d 2 -cyclically monotone set, while we need regularity for the d-cyclically monotone set Γ. Hence it is necessary to include d 2 -cyclically monotone sets as subset of d-cyclically monotone sets.

We present here a strategy introduced by the author in [17,18] from where all the material presented in this section is taken. Section 4.1 contains results from [11] while Section 4.2 is taken from [20].  [17]). Let ∆ ⊂ Γ be any set so that:
(x 0 , y 0 ), (x 1 , y 1 ) ∈ ∆ ⇒ (ϕ(y 1 ) − ϕ(y 0 )) · (ϕ(x 1 ) − ϕ(x 0 )) ≥ 0.
Then ∆ is d 2 -cyclically monotone.

Proof. It follows directly from the hypothesis of the lemma that the set
Λ := {(ϕ(x), ϕ(y)) : (x, y) ∈ ∆} ⊂ R 2 ,
is monotone in the Euclidean sense. Since Λ ⊂ R 2 , it is then a standard fact that Λ is also | · | 2 -cyclically monotone, where | · | denotes the modulus. We anyway include a short proof: there exists a maximal monotone multivalued function F such that Λ ⊂ graph(F ) and its domain is an interval, say (a, b) with a and b possibly infinite; moreover, apart from countably many x ∈ R, the set F (x) is a singleton. Then the following function is well defined:
Ψ(x) :=ˆx c F (s)ds,
where c is any fixed element of (a, b). Then observe that
Ψ(z) − Ψ(x) ≥ y(z − x), ∀ z, x ∈ (a, b),
where y is any element of F (x). In particular this implies that Ψ is convex and F (x) is a subset of its sub-differential. In particular Λ is | · | 2 -cyclically monotone.
Then for {(x i , y i )} i≤N ⊂ ∆, since ∆ ⊂ Γ, it holds N i=1 d 2 (x i , y i ) = N i=1 |ϕ(x i ) − ϕ(y i )| 2 ≤ N i=1 |ϕ(x i ) − ϕ(y i+1 )| 2 ≤ N i=1 d 2 (x i , y i+1 ),
where the last inequality is given by the 1-Lipschitz regularity of ϕ. The claim follows.

To study the set of branching points is necessary to relate point of branching to geodesics. In the next Lemma, using Lemma 3.1, we observe that once a branching happens there exist two distinct geodesics, both contained in Γ(x), that are not in relation in the sense of R.
Lemma 4.2. Let x ∈ A + . Then there exist two distinct geodesics γ 1 , γ 2 ∈ G such that -(x, γ 1 s ), (x, γ 2 s ) ∈ Γ for all s ∈ [0, 1]; -(γ 1 s , γ 2 s ) / ∈ R for all s ∈ [0, 1]; -ϕ(γ 1 s ) = ϕ(γ 2 s ) for all s ∈ [0, 1].

## Moreover both geodesics are non-constant.

Proof. From the definition of A + there exists z, w ∈ T e such that z, w ∈ Γ(x) and (z, w) / ∈ R. Since z, w ∈ Γ(x), from Lemma 3.1 there exist two geodesics γ 1 , γ 2 ∈ G such that γ 1 0 = γ 2 0 = x, γ 1 1 = z, γ 2 1 = w. Since (z, w) / ∈ R, necessarily both z and w are different from x and x is not a final point, that is x / ∈ b. So the previous geodesics are not constant. Since z and w can be exchanged, we can also assume that ϕ(z) ≥ ϕ(w). Since z ∈ Γ(x), ϕ(x) ≥ ϕ(z) and by continuity there exists s 2 ∈ (0, 1] such that ϕ(z) = ϕ(γ 2 s2 ). Note that z = γ 2 s2 , otherwise w ∈ Γ(z) and therefore (z, w) ∈ R. Moreover still (z, γ 2 s2 ) / ∈ R. Indeed if the contrary was true, then 0 = |ϕ(z) − ϕ(γ 2 s2 )| = d(z, γ 2 s2 ), that is a contradiction with z = γ 2 s2 . So by continuity there exists δ > 0 such that
ϕ(γ 1 1−s ) = ϕ(γ 2 s2(1−s) ), d(γ 1 1−s , γ 2 s2−s ) > 0, for all 0 ≤ s ≤ δ.
Hence reapplying the previous argument (γ 1 1−s , γ 2 s2(1−s) ) / ∈ R. The curve γ 1 and γ 2 of the claim are then obtained properly restricting and rescaling the geodesic γ 1 and γ 2 considered so far.

The previous correspondence between branching points and couples of branching geodesics can be proved to be measurable. We will make use of the following selection result, Theorem 5.5.2 of [50]. We again refer to [50] for some preliminaries on analytic sets. Theorem 4.3. Let X and Y be Polish spaces, F ⊂ X × Y analytic, and A be the σ-algebra generated by the analytic subsets of X. Then there is an A-measurable section u :
P 1 (F ) → Y of F .
Recall that given F ⊂ X × Y , a section u of F is a function from P 1 (F ) to Y such that graph(u) ⊂ F . Proof. Since G = {γ ∈ Geo(X) : (γ 0 , γ 1 ) ∈ Γ} and Γ ⊂ X × X is closed, the set G is a complete and separable metric space. Consider now the set
F := {(x, γ 1 , γ 2 ) ∈ T e × G × G : (x, γ 1 0 ), (x, γ 2 0 ) ∈ Γ} ∩ X × {(γ 1 , γ 2 ) ∈ G × G : d(γ 1 1 , γ 2 1 ) > 0} ∩ X × {(γ 1 , γ 2 ) ∈ G × G : d(γ 1 0 , γ 2 0 ) > 0} ∩ X × {(γ 1 , γ 2 ) ∈ G × G : d(γ 1 0 , γ 1 1 ) > 0} ∩ X × {(γ 1 , γ 2 ) ∈ G × G : ϕ(γ 1 i ) = ϕ(γ 2 i ), i = 0, 1} . It follows from Remark 3.3 that F is σ-compact.
To avoid possible intersections in interior points of γ 1 with γ 2 we consider the following map:
h : G × G → [0, ∞) (γ 1 , γ 2 ) → h(γ 1 , γ 2 ) := min s∈[0,1] d(γ 1 s , γ 2 s ).
From compactness of [0, 1], we deduce the continuity of h. Thereforê
F := F ∩ {(x, γ 1 , γ 2 ) ∈ X × G × G : h(γ 1 , γ 2 ) > 0}
is a Borel set and from Lemma 4
.2,F ∩ ({x} × G × G) = ∅
for all x ∈ A + . By Theorem 4.3 we infer the existence of an A-measurable selection u ofF . Since
A + = P 1 (F ) and if u(x) = (γ 1 , γ 2 ), then d(γ 1 s , γ 2 s ) > 0, ϕ(γ 1 s ) = ϕ(γ 2 s )
, for all s ∈ [0, 1], and therefore (γ 1 s , γ 2 s ) / ∈ R for all s ∈ [0, 1]. The claim follows.

We are ready to prove the following 
2 ∈ G such that -(x, γ 1 s ), (x, γ 2 s ) ∈ Γ for all s ∈ [0, 1]; -(γ 1 s , γ 2 s ) / ∈ R for all s ∈ [0, 1]; -ϕ(γ 1 s ) = ϕ(γ 2 s ) for all s ∈ [0, 1]. Moreover the map A + ∋ x → u(x) := (γ 1 , γ 2 ) ∈ G 2 is A-measurable.
By inner regularity of compact sets (or by Lusin's Theorem), possibly selecting a subset of A + still with strictly positive m-measure, we can assume that the previous map is continuous and in particular the functions A + ∋ x → ϕ(γ i j ) ∈ R, i = 1, 2, j = 0, 1 are all continuous. Put α x := ϕ(γ 1 0 ) = ϕ(γ 2 0 ), β x := ϕ(γ 1 1 ) = ϕ(γ 2 1 ) and note that α x > β x . Now we want to show the existence of a subset B ⊂ A + , still with m(B) > 0, such that sup
x∈B β x < inf x∈B α x .
By continuity of α and β, a set B verifying the previous inequality can be obtained considering the set A + ∩ B r (x), for x ∈ A + with r sufficiently small. Since m(A + ) > 0, for m-a.e. x ∈ A + the set A + ∩ B r (x) has positive m-measure. So the existence of B ⊂ A + enjoying the aforementioned properties follows.

Step 2. Let I = [c, d] be a non trivial interval such that
sup x∈B β x < c < d < inf x∈B α x .
Then by construction for all x ∈ B the image of the composition of the geodesics γ 1 and γ 2 with ϕ contains the interval I:
I ⊂ {ϕ(γ i s ) : s ∈ [0, 1]}, i = 1, 2.
Then fix any point inside I, say c and consider for any x ∈ B the value s(x) such that ϕ(γ 1 s(x) ) = ϕ(γ 2 s(x) ) = c. We can now define on B two transport maps T 1 and T 2 by
B ∋ x → T i (x) := γ i s(x) , i = 1, 2.
Accordingly we define the transport plan
η := 1 2 (Id, T 1 ) ♯ m B + (Id, T 2 ) ♯ m B , where m B := m(B) −1 m B .
Step 3. The support of η is d 2 -cyclically monotone. To prove it we will use Lemma 4.1. The measure η is concentrated on the set
∆ := {(x, γ 1 s(x) ) : x ∈ B} ∪ {(x, γ 2 s(x)
) : x ∈ B} ⊂ Γ. Take any two couples (x 0 , y 0 ), (x 1 , y 1 ) ∈ ∆ and notice that by definition: ϕ(y 1 ) − ϕ(y 0 ) = 0, and therefore trivially (ϕ(y 1 ) − ϕ(y 0 )) (ϕ(x 1 ) − ϕ(x 0 )) = 0, and Lemma 4.1 can be applied to ∆. Hence η is optimal with (P 1 ) ♯ η ≪ m and is not induced by a map; this is a contradiction with the assumption. It follows that m(A + ) = 0. The claim for A − follows in the same manner.

Remark 4.6. If the space is itself non-branching, then Proposition 4.5 can be proved more directly under the assumption (A.1), that will be introduced at the beginning of Section 5. Recall that (X, d, m) is non-branching if for any γ 1 , γ 2 ∈ Geo such that
γ 1 0 = γ 2 0 , γ 1 t = γ 2 t ,
for some t ∈ (0, 1), implies that γ 1 1 = γ 2 1 . In particular the following statement holds Let (X, d, m) be non-branching and assume moreover (A.1) to hold. Then
m(A + ) = m(A − ) = 0.
For the proof of this statement (that goes beyond the scope of this note) we refer to [11], Lemma 5.3. The same comment will also apply to the next Theorem 4.7.

To summarize what proved so far introduce also the following notation: the set will be called the transport set. Since T e , A + and A − are σ-compact sets, notice that T is countable intersection of σ-compact sets and in particular Borel.

Theorem 4.7 (Theorem 5.5, [18]). Let (X, d, m) be such that for any µ 0 , µ 1 ∈ P(X) with µ 0 ≪ m any optimal transference plan for W 2 is concentrated on the graph of a function. Then the set of transport rays R ⊂ X × X is an equivalence relation on the transport set T and m(T e \ T ) = 0.

To recap, we have shown that given a d-monotone set Γ, the set of all those points moved by Γ, denoted with T e , can be written, neglecting a set of m-measure zero, as the union of a family of disjoint geodesics. The next step is to decompose the reference measure m restricted to T with respect to the partition given by R, where each equivalence class is given by
[x] = {y ∈ T : (x, y) ∈ R}.
Denoting the set of equivalence classes with Q, we can apply Disintegration Theorem (see Theorem 2.8) to the measure space (T , B(T ), m) and obtain the disintegration of m consistent with the partition of T in rays:
m T =ˆQ m q q(dq),
where q is the quotient measure.


## 4.1.

Structure of the quotient set. In order to use the strength of Disintegration Theorem to localize the measure, one needs to obtain a strongly consistent disintegration. Following the last part of Theorem 2.8, it is necessary to build a section S of T together with a measurable quotient map with image S. Proposition 4.8 (Q is locally contained in level sets of ϕ). It is possible to construct a Borel quotient map Q : T → Q such that the quotient set Q ⊂ X can be written locally as a level set of ϕ in the following sense:
Q = i∈N Q i , Q i ⊂ ϕ −1 (α i ), where α i ∈ Q, Q i is analytic and Q i ∩ Q j = ∅, for i = j.
Proof.

Step 1. For each n ∈ N, consider the set T n of those points x having ray R(x) longer than 1/n, i.e.

T n := P 1 {(x, z, w) ∈ T e × T e × T e : z, w ∈ R(x), d(z, w) ≥ 1/n} ∩ T .

It is easily seen that T = n∈N T n and that T n is Borel: the set T e is σ-compact and therefore its projection is again σ-compact.

Moreover if x ∈ T n , y ∈ T and (x, y) ∈ R then also y ∈ T n : for x ∈ T n there exists z, w ∈ T e with z, w ∈ R(x) and d(z, w) ≥ 1/n. Since x ∈ T necessarily z, w ∈ T . Since R is an equivalence relation on T and y ∈ T , it follows that z, w ∈ R(y). Hence y ∈ T n . In particular, T n is the union of all those maximal rays of T with length at least 1/n.

Using the same notation, we have T = ∪ n∈N T n with T n Borel, saturated with respect to R, each ray of T n is longer than 1/n and T n ∩ T n ′ = ∅ as soon as n = n ′ . Now we consider the following saturated subsets of T n : for α ∈ Q (4.2) T n,α := P 1 R ∩ (x, y) ∈ T n × T n : ϕ(y) = α − 1 3n ∩P 1 R ∩ (x, y) ∈ T n × T n : ϕ(y) = α + 1 3n , and we claim that
(4.3) T n = α∈Q T n,α .
We show the above identity by double inclusion. First note that (⊃) holds trivially. For the converse inclusion (⊂) observe that for each α ∈ Q, the set T n,α coincides with the family of those rays R(x) ∩ T n such that there exists y + , y − ∈ R(x) such that
(4.4) ϕ(y + ) = α − 1 3n , ϕ(y − ) = α + 1 3n .
Then we need to show that any x ∈ T n , also verifies x ∈ T n,α for a suitable α ∈ Q. So fix x ∈ T n and since R(x) is longer than 1/n, there exist z, y + , y − ∈ R(x) ∩ T n such that
ϕ(y − ) − ϕ(z) = 1 2n , ϕ(z) − ϕ(y + ) = 1 2n .
Consider now the geodesic γ ∈ G such that γ 0 = y − and γ 1 = y + . By continuity of [0, 1] ∋ t → ϕ(γ t ) it follows the existence of 0 < s 1 < s 2 < s 3 < 1 such that
ϕ(γ s3 ) = ϕ(γ s2 ) − 1 3n , ϕ(γ s1 ) = ϕ(γ s2 ) + 1 3n , ϕ ∈ Q.
This concludes the proof of the identity (4.3).

Step 2. By the above construction, one can check that for each α ∈ Q, the level set ϕ −1 (α) is a quotient set for T n,α , i.e. T n,α is formed by disjoint geodesics each one intersecting ϕ −1 (α) in exactly one point. Equivalently, ϕ −1 (α) is a section for the partition of T n induced by R.

Moreover T n,α is obtained as the projection of a Borel set and it is therefore analytic. Since T n,α is saturated with respect to R either T n,α ∩ T n,α ′ = ∅ or T n,α = T n,α ′ . Hence, removing the unnecessary α, we can assume that T = n∈N,α∈Q T n,α , is a partition. Then we characterize Q : T → T defining its graph as follows:
graph(Q) := n∈N,α∈Q T n,α × ϕ −1 (α) ∩ T n,α .
Notice that graph(Q) is analytic and therefore Q : T → Q is Borel (see Theorem 4.5.2 of [50]). The claim follows.

Corollary 4.9. The following strongly consistent disintegration formula holds true:
(4.5) m T =ˆQ m q q(dq), m q (Q −1 (q)) = 1, q-a.e. q ∈ Q.
Proof. From Proposition 4.8 there exists an analytic quotient set Q with Borel quotient map Q : T → Q.

In particular Q is a section and the push-forward σ-algebra of B(T ) on Q contains B(Q). From Theorem 2.8 (4.5) follows. 
R −1 (S) = {x ∈ T : (x, q) ∈ R, q ∈ S} = P 1 ({(x, q) ∈ T × S : (x, q) ∈ R}) = P 1 (T × S ∩ R) = P 1 (T e × S ∩ R).
and the regularity follows. Notice that R −1 (S) is formed by non-branching rays and m(T \ R −1 )(S)) = q(Q \ S) = 0. Hence we have proved that the transport set with end points T e admits a saturated, partitioned by disjoint rays, σ-compact subset of full measure with σ-compact quotient set. Since in what follows we will not use the definition (4.1), we will denote this set with T and its quotient set with Q.

For ease of notation X q := Q −1 (q). The next goal will be to deduce regularity properties for the conditional measures m q . The next function will be of some help during the note. 
graph(g) := (q, t, x) ∈ Q × [0, +∞) × T : (q, x) ∈ Γ, d(q, x) = t ∪ (q, t, x) ∈ Q × (−∞, 0] × T : (x, q) ∈ Γ, d(x, q) = t = graph(g + ) ∪ graph(g − ).
Hence the ray map associates to each q ∈ Q and t ∈ Dom (g(q, ·)) ⊂ R the unique element x ∈ T such that (q, x) ∈ Γ at distance t from q if t is positive or the unique element x ∈ T such that (x, q) ∈ Γ at distance −t from q if t is negative. By definition Dom(g) := g −1 (T ). Notice that from Remark 4.10 it is not restrictive to assume graph(g) to be σ-compact. In particular the map g is Borel.

Next we list few (trivial) regularity properties enjoyed by g.

Proposition 4.12. The following holds.

-g is a Borel map.

-t → g(q, t) is an isometry and if s, t ∈ Dom (g(q, ·)) with s ≤ t then (g(q, s), g(q, t)) ∈ Γ; -Dom(g) ∋ (q, t) → g(q, t) is bijective on Q −1 (Q) = T , and its inverse is
x → g −1 (x) = Q(x), ±d(x, Q(x))
where Q is the quotient map previously introduced and the positive or negative sign depends on
(x, Q(x)) ∈ Γ or (Q(x), x) ∈ Γ.
Observe that from Lemma 3.1, Dom (g(q, ·)) is a convex subset of R (i.e. an interval), for any q ∈ Q. Using the ray map g, we will review in Section 5 how to prove that q-a.e. conditional measure m q is absolutely continuous with respect to the 1-dimensional Hausdorff measure on X q , provided (X, d, m) enjoys weak curvature properties. The other main use of the ray map g was presented in Section 7 of [11] where it was used to build a 1-dimensional metric currents in the sense of Ambrosio-Kirchheim (see [6]) associated to T .

It is worth also noticing that so far, besides the assumption of Proposition 4.5, no extra assumption on the geometry of the space was used. In particular, given two probability measures µ 0 and µ 1 with finite first moment, the associated transport set permits to decompose the reference measure m in onedimensional conditional measures m q , i.e. formula (4.5) holds.


### Balanced transportation.

Here we want underline that the disintegration (or one-dimensional localization) of m induced by the L 1 -Optimal Transportation problem between µ 0 and µ 1 is actually a localization of the Monge problem. We will present this fact considering a function f :
X → R such that X f (x) m(dx) = 0,ˆX |f (x)|d(x, x 0 ) m(dx) < ∞,
and considering µ 0 := f + m and µ 1 := f − m, where f ± denotes the positive and the negative part of f . We can also assume µ 0 , µ 1 ∈ P(X) and study the Monge minimization problem between µ 0 and µ 1 . This setting is equivalent to study the general Monge problem assuming both µ 0 , µ 1 ≪ m; note indeed that µ 0 and µ 1 can always be assumed to be concentrated on disjoint sets (see [11] for details).

If ϕ is an associated Kantorovich potential producing as before the transport set T , we have a disintegration of m as follows:
m T =ˆQ m q q(dq), m q (X q ) = 1, q-a.e. q ∈ Q.
Then the natural localization of the Monge problem would be to consider for every q ∈ Q the Monge minimization problem between µ 0 q := f + m q , µ 1 q := f − m q , in the metric space (X q , d) (that is isometric via the ray map g to an interval of R with the Euclidean distance). To check that this family of problems makes sense we need to prove the following Lemma 4.13. It holds that for q-a.e. q ∈ Q one has´X f m q = 0.

Proof. Since for both µ 0 and µ 1 the set T e \ T is negligible (µ 0 , µ 1 ≪ m), for any Borel set C ⊂ Q (4.6) where the second equality follows from the fact that T does not branch: indeed since µ 0 (T ) = µ 1 (T ) = 1, then π (Γ \ {x = y}) ∩ T × T = 1 and therefore if x, y ∈ T and (x, y) ∈ Γ, then necessarily Q(x) = Q(y), that is they belong to the same ray. It follows that
µ 0 (Q −1 (C)) = π (Q −1 (C) × X) ∩ Γ \ {x = y} = π (X × Q −1 (C)) ∩ Γ \ {x = y} = µ 1 (Q −1 (C)),(Q −1 (C) × X) ∩ (Γ \ {x = y}) ∩ (T × T ) = (X × Q −1 (C)) ∩ (Γ \ {x = y}) ∩ (T × T ),
and (4.6) follows.

Since f has null mean value it holds´X f + (x)m(dx) = −´X f − (x)m(dx), which combined with (4.6) implies that for each Borel
C ⊂ Q CˆXq f (x)m q (dx)q(dq) =ˆCˆX q f + (x)m q (dx)q(dq) −ˆCˆX q f − (x)m q (dx)q(dq) = ˆX f + (x)m(dx) −1 µ 0 (Q −1 (C)) − µ 1 (Q −1 (C)) = 0.
Therefore for q-a.e. q ∈ Q the integral´f m q vanishes and the claim follows.

It can be proven in greater generality and without assuming µ 1 ≪ m that the Monge problem is localized once a strongly consistent disintegration of m restricted to the transport ray is obtained. See [11] for details.


## Regularity of conditional measures

We now review regularity and curvature properties of m q . What contained in this section is a collection of results spread across [11,17,18] and [20]. We try here to give a unified presentation. We will inspect three increasing level of regularity: for q-a.e. q ∈ Q (R.1) m q has no atomic part, i.e. m q ({x}) = 0, for any x ∈ X q ; (R.2) m q is absolutely continuous with respect to H 1 Xq = g(q, ·) ♯ L 1 ; (R.3) m q = g(q, ·) ♯ (h q L 1 ) verifies CD(K, N ), i.e. the m.m.s. (R, | · |, h q L 1 ) verifies CD(K, N ).

We will review how to obtain (R.1), (R.2), (R.3) starting from the following three increasing regularity assumptions on the space: Given a compact set C ⊂ X, we indicate with C t its translation along the transport set at distance with sign t, see the following Definition 5.1.
(A.1) if C ⊂ T is compact with m(C) > 0, then m(C t ) > 0 for uncountably many t ∈ R; (A.2) if C ⊂ T is compact with m(C) > 0, then m(C t ) > 0
We will see that: Even if we do not to state it each single time, assumptions (A.1) and (A.2) are not hypothesis on the smoothness of the space but on the regularity of the set Γ and therefore on the Monge problem itself; they should both be read as: for µ 0 and µ 1 probability measures over X, assume the existence of a 1-Lipschitz Kantorovich potential ϕ such that the associated transport set T verifies (A.1) (or (A.2)).


## 5.1.

Atomless conditional probabilities. The results presented here are taken from [11].

Definition 5.1. Let C ⊂ T be a compact set. For t ∈ R define the t-translation C t of C by
C t := g {(q, s + t) : (q, s) ∈ g −1 (C)} .
Since C ⊂ T is compact, g −1 (C) ⊂ Q × R is σ-compact (graph(g) is σ-compact) and the same holds true for
{(q, s + t) : (q, s) ∈ g −1 (C)}. Since C t = P 3 (graph(g) ∩ {(q, s + t) : (q, s) ∈ g −1 (C)} × T )
, it follows that C t σ-compact (projection of σ-compact sets is again σ-compact). Moreover the set B := {(t, x) ∈ R × T : x ∈ C t } is Borel and therefore by Fubini's Theorem the map t → m(C t ) is Borel. It follows that (A.1) makes sense.

Proposition 5.2 (Proposition 5.4, [11]). Assume (A.1) to hold and the space to be non-branching. Then (R.1) holds true, that is for q-a.e. q ∈ Q the conditional measure m q has no atoms.

Proof. The partition in trasport rays and the associated disintegration are well defined, see Remark 4.6. From the regularity of the disintegration and the fact that q(Q) = 1, we can assume that the map q → m q is weakly continuous on a compact set K ⊂ Q with q(Q \ K) < ε such that the length of the ray X q , denoted by L(X q ), is strictly larger than ε for all q ∈ K. It is enough to prove the proposition on K.

Step 1. From the continuity of K ∋ q → m q ∈ P(X) w.r.t. the weak topology, it follows that the map Hence it is Borel, and by Lusin Theorem (Theorem 5.8.11 of [50]) it is the countable union of Borel graphs: setting in case c i (q) = 0, we can consider them as Borel functions on K and order them w.r.t. Γ in the following sense:
q → C(q) := x ∈ X q : m q ({x}) > 0 = ∪ n x ∈ X q : m q ({x}) ≥ 2 −n is σ-closed, i.e.m q,atomic = i∈Z c i (q)δ xi(q) , (x i (q), x i+1 (q)) ∈ Γ, i ∈ Z, with K ∋ q → x i (q) Borel.
Step 2. Define the sets S ij (t) := q ∈ K : x i (q) = g g −1 (x j (q)) + t ,

Since K ⊂ Q, to define S ij (t) we are using the graph(g)∩Q×R×T , which is σ-compact: hence graph(S ij ) is analytic. For A j := {x j (q), q ∈ K} and t ∈ R + we have that
m((A j ) t ) =ˆK m q ((A j ) t ) q(dq) =ˆK m q,atomic ((A j ) t ) q(dq) = i∈ZˆK c i (q)δ xi(q) g(g −1 (x j (q)) + t) q(dq) = i∈ZˆS ij (t) c i (q) q(dq),
and we have used that A j ∩ X q is a singleton. Then for fixed i, j ∈ N, again from the fact that A j ∩ X q is a singleton
S ij (t) ∩ S ij (t ′ ) = S ij (t) t = t ′ , ∅ t = t ′ ,
and therefore the cardinality of the set t : q(S ij (t)) > 0 has to be countable. On the other hand,
m((A j ) t ) > 0 =⇒ t ∈ i t : q(S ij (t)) > 0 ,
contradicting (A.1).


### Absolute continuity.

The results presented here are taken from [11]. The condition (A.2) can be stated also in the following way: for every compact set C ⊂ T
m(C) > 0 =⇒ˆR m(C t )dt > 0.
Lemma 5.3. Let m be a Radon measure and m q = r q g(q, ·) ♯ L 1 + ω q , ω q ⊥ g(q, ·) ♯ L 1 be the Radon-Nikodym decomposition of m q w.r.t. g(q, ·) ♯ L 1 . Then there exists a Borel set C ⊂ X such that
L 1 P 2 g −1 (C) ∩ ({q} × R)) = 0,
and ω q = m q C for q-a.e. q ∈ Q.

Proof. Consider the measure λ = g ♯ (q ⊗ L 1 ), and compute the Radon-Nikodym decomposition
m = Dm Dλ λ + ω.
Then there exists a Borel set C such that ω = m C and λ(C) = 0. The set C proves the Lemma. Indeed C = ∪ q∈Q C q where C q = C ∩ R(q) is such that m q Cq = ω q and g(q, ·) ♯ L 1 (C q ) = 0 for q-a.e. q ∈ Q.

Theorem 5.4 (Theorem 5.7, [11]). Assume (A.2) to hold and the space to be non-branching. Then (R.2) holds true, that is for q-a.e. q ∈ Q the conditional measure m q is absolute continuous with respect to g(q, ·) ♯ L 1 .

The proof is based on the following simple observation.

Let η be a Radon measure on R. Suppose that for all A ⊂ R Borel with η(A) > 0 it holdŝ
R + η(A + t)dt = η ⊗ L 1 {(x, t) : t ≥ 0, x − t ∈ A} > 0.
Then η ≪ L 1 .

Proof. The proof will use Lemma 5.3: take C the set constructed in Lemma 5.3 and suppose by contradiction that m(C) > 0 and q ⊗ L 1 (g −1 (C)) = 0. In particular, for all t ∈ R it follows that q ⊗ L 1 (g −1 (C t )) = 0.
By Fubini-Tonelli Theorem 0 <ˆR + m(C t ) dt =ˆR + ˆg −1 (Ct) (g −1 ) ♯ m(dq dτ ) dt = (g −1 ) ♯ m ⊗ L 1 (q, τ, t) : (q, τ ) ∈ g −1 (T ), (q, τ − t) ∈ g −1 (C) ≤ˆQ ×R L 1 τ − g −1 (C ∩ Q −1 (q)) (g −1 ) ♯ m(dq dτ ) =ˆQ ×R L 1 g −1 (C ∩ Q −1 (q)) (g −1 ) ♯ m(dq dτ ) =ˆQ L 1 g −1 (C ∩ Q −1 (y)) q(dy) = 0.
That gives a contradiction.

The proof of Theorem 5.4 inspired the definition of inversion points and of inversion plan as presented in [19], in particular see Step 2. of the proof of Theorem 5.3 of [19]. : MCP(K, N ). The presentation of the following results is taken from [18]. The same results were already proved in [11] using more involved arguments and different notation.


### Weak Ricci curvature bounds

In this section we additionally assume the metric measure space to satisfy the measure contraction property MCP (K, N ). Recall that the space is also assumed to be non-branching.

Lemma 5.5. For each Borel C ⊂ T and δ ∈ R the set
(C × {ϕ = δ}) ∩ Γ, is d 2 -cyclically monotone.
Proof. The proof follows straightforwardly from Lemma 4.1. The set (C × {ϕ = c}) ∩ Γ is trivially a subset of Γ and whenever (x 0 , y 0 ), (
x 1 , y 1 ) ∈ (C × {ϕ = δ}) ∩ Γ, then (ϕ(y 1 ) − ϕ(y 0 )) · (ϕ(x 1 ) − ϕ(x 0 )) = 0.
We can deduce the following Corollary 5.6. For each Borel C ⊂ T and δ ∈ R define
C δ := P 1 ((C × {ϕ = δ}) ∩ Γ).
If m(C δ ) > 0, there exists a unique ν ∈ OptGeo such that
(5.1) (e 0 ) ♯ ν = m(C δ ) −1 m C δ , (e 0 , e 1 ) ♯ (ν) (C × {ϕ = δ}) ∩ Γ = 1.
From Corollary 5.6, we infer the existence of a map T C,δ depending on C and δ such that
(Id, T C,δ ) ♯ m(C δ ) −1 m C δ = (e 0 , e 1 ) ♯ ν.
Taking advantage of the ray map g, we define a convex combination between the identity map and T C,δ as follows:
C δ ∋ x → (T C,δ ) t (x) ∈ {z ∈ Γ(x) : d(x, z) = t · d(x, T C,δ (x))}.
Since C ⊂ T , the map (T C,δ ) t is well defined for all t ∈ [0, 1]. We then define the evolution of any subset A of C δ in the following way:
[0, 1] ∋ t → (T C,δ ) t (A).
In particular from now on we will adopt the following notation:
A t := (T C,δ ) t (A), ∀A ⊂ C δ , A compact.
So for any Borel C ⊂ T compact and δ ∈ R we have defined an evolution for compact subsets of C δ . The definition of the evolution depends both on C and δ.

Remark 5.7. Here we spend a few lines on the measurability of the maps involved in the definition of evolution of sets assuming for simplicity C to be compact. First note that since Γ is closed and C is compact, we can prove that also C δ is compact. Indeed from compactness of C we obtain that ϕ is bounded on C and then, since C is bounded, it follows that also C × {ϕ = c} ∩ Γ is bounded. Since X is proper, compactness follows. Moreover
graph(T C,δ ) = (C × {ϕ = δ}) ∩ Γ, hence T C,δ is continuous. Moreover (T C,δ ) t (A) = P 2 ({(x, z) ∈ Γ ∩ (A × X) : d(x, z) = t · d(x, T C,δ (x))}) ,
hence if A is compact, the same holds for (T C,δ ) t (A) and
[0, 1] ∋ t → m((T C,δ ) t (A))
is m-measurable.

The next result gives quantitative information on the behavior of the map t → m(A t ). The statement will be given assuming the lower bound on the generalized Ricci curvature K to be positive. Analogous estimates holds for any K ∈ R.

Proposition 5.8. For each compact C ⊂ T and δ ∈ R such that m(C δ ) > 0, it holds
(5.2) m(A t ) ≥ (1 − t) · inf x∈A   sin (1 − t)d(x, T C,δ (x)) K/(N − 1) sin d(x, T C,δ (x)) K/(N − 1)   N −1 m(A),
for all t ∈ [0, 1] and A ⊂ C δ compact set.

Proof. The proof of (5.2) is obtained by the standard method of approximation with Dirac deltas of the second marginal. Even though similar arguments already appeared many times in literature, in order to be self-contained, we include all the details. For ease of notation T = T C,δ and C = C δ .

Step 1. 
Λ I := I i=1 E i,I × {y i } ⊂ X × X,
is d 2 -cyclically monotone. Consider then A i,I := A ∩ E i,I and the approximate evolution
A i,I,t := {z ∈ X : d(z, y i ) = (1 − t)d(x, y i ), x ∈ A i,I };
and notice that A i,I,0 = A i,I . Then by MCP(K, N ) it holds
m(A i,I,t ) ≥ (1 − t) · inf x∈Ai,I   sin (1 − t)d(x, x i ) K/(N − 1) sin d(x, x i ) K/(N − 1)   N −1 m(A i,I ).
Taking the sum over i ≤ I in the previous inequality implies
i≤I m(A i,I,t ) ≥ (1 − t) · inf x∈A   sin (1 − t)d(x, T I (x)) K/(N − 1) sin d(x, T I (x)) K/(N − 1)   N −1 m(A),
where T I (x) := y i for x ∈ E i,I . From d 2 -cyclically monotonicity and the non-branching of the space, up to a set of measure zero, the map T I is well defined, i.e. m(E i,I ∩ E j,I ) = 0 for i = j. It follows that for each I ∈ N we can remove a set of measure zero from A and obtain
A i,I,t ∩ A j,I,t = ∅, i = j.
As before consider also the interpolated map T I,t and observe that A I,t = T I,t (A). Since also A is compact we obtain
m(A I,t ) ≥ (1 − t) · min x∈A   sin (1 − t)d(x, T I (x)) K/(N − 1) sin d(x, T I (x)) K/(N − 1)   N −1 m(A).
Step 2.

Since C is a compact set, for every I ∈ N the set Λ I is compact as well and it is a subset of C × {ϕ = δ} that can be assumed to be compact as well. By compactness, there exists a subsequence I n and a compact set Θ ⊂ C × {ϕ = δ} compact such that
lim n→∞ d H (Λ In , Θ) = 0,
where d H is the Hausdorff distance. Since the sequence {y i } i∈N is dense in {ϕ = δ} and C ⊂ T is compact, by definition of E i,I , necessarily for every (x, y) ∈ Θ it holds ϕ(x) + ϕ(y) = d(x, y), ϕ(y) = δ.

Hence Θ ⊂ Γ ∩ C × {ϕ = δ} and this in particular implies, by upper semicontinuity of m along converging sequences of closed sets, that m(A t ) ≥ lim sup n→∞ m(A In,t ) .

The claim follows.

As the goal is to localize curvature conditions, we first need to prove that almost every conditional probability is absolutely continuous with respect to the one dimensional Hausdorff measure restricted to the correct geodesic. One way is to prove that Proposition 5.8 implies (A.2) and then apply Theorem 5.4 to obtain (R.2) (approach used in [11]). Another option is to repeat verbatim the proof of Theorem 5.4 substituting the translation with the evolution considered in Proposition 5.8 and to observe that the claim follows (approach used in [18]). So we take for granted the following Proposition 5.9. Assume the non-branching m.m.s. (X, d, m) to satisfy MCP(K, N ). Then (R.2) holds true, that is for q-a.e. q ∈ Q the conditional measure m q is absolute continuous with respect to g(q, ·) ♯ L 1 .

To fix the notation, we now have proved the existence of a Borel function h : Dom (g) → R + such that
(5.3) m T = g ♯ h q ⊗ L 1
Using standard arguments, estimate (5.2) can be localized at the level of the density h: for each compact set A ⊂ T
P2(g −1 (At)) h(q, s)L 1 (ds) ≥ (1 − t) inf τ ∈P2(g −1 (A)) sin((1 − t)|τ − σ| K/(N − 1)) sin(|τ − σ| K/(N − 1)) N −1ˆP 2(g −1 (A))
h(q, s)L 1 (ds),

for q-a.e. q ∈ Q such that g(q, σ) ∈ T . Then using change of variable, one obtains that for q-a.e. q ∈ Q:
h(q, s + |s − σ|t) ≥ sin((1 − t)|s − σ| K/(N − 1)) sin(|s − σ| K/(N − 1)) N −1 h(y, s),
for L 1 -a.e. s ∈ P 2 (g −1 (R(q))) and σ ∈ R such that s + |σ − s| ∈ P 2 (g −1 (R(q))). We can rewrite the estimate in the following way:
h(q, τ ) ≥ sin((σ − τ ) K/(N − 1)) sin((σ − s) K/(N − 1)) N −1 h(q, s),
for L 1 -a.e. s ≤ τ ≤ σ such that g(q, s), g(q, τ ), g(q, σ) ∈ T . Since evolution can be also considered backwardly, we have proved the next  N ). For q-a.e. q ∈ Q it holds:
sin((σ + − τ ) K/(N − 1)) sin((σ + − s) K/(N − 1)) N −1 ≤ h(q, τ ) h(q, s) ≤ sin((τ − σ − ) K/(N − 1)) sin((s − σ − ) K/(N − 1)) N −1 ,
for σ − < s ≤ τ < σ + such that their image via g(q, ·) is contained in R(q).

In particular from Theorem 5.10 we deduce that (5.4) {t ∈ Dom (g(q, ·)) : h(q, t) > 0} = Dom (g(q, ·)), in particular such set is convex and t → h(q, t) is locally Lipschitz continuous.


## 5.4.

Weak Ricci curvature bounds: CD(K, N ). The results presented here are taken from [20]. We now turn to proving that the conditional probabilities inherit the synthetic Ricci curvature lower bounds, that is, (A.3) implies (R.3). Actually it is enough to assume the space to verify such a lower bound only locally to obtain globally the synthetic Ricci curvature lower bound on almost every 1dimensional metric measure spaces.

Since under the essentially non-branching condition CD loc (K, N ) implies MCP(K, N ) and existence and uniqueness of optimal transport maps, see [22], we can already assume (5.3) and (5.4) to hold. In particular t → h q (t) is locally Lipschitz continuous, where, for easy of notation h q = h(q, ·).

Theorem 5.11 (Theorem 4.2 of [20]). Let (X, d, m) be an essentially non-branching m.m.s. verifying the CD loc (K, N ) condition for some K ∈ R and N ∈ [1, ∞).

Then for any 1-Lipschitz function ϕ : X → R, the associated transport set Γ induces a disintegration of m restricted to the transport set verifying the following inequality: if N > 1 for q-a.e. q ∈ Q the following curvature inequality holds:
(5.5) h q ((1 − s)t 0 + st 1 ) 1/(N −1) ≥ σ (1−s) K,N −1 (t 1 − t 0 )h q (t 0 ) 1/(N −1) + σ (s) K,N −1 (t 1 − t 0 )h q (t 1 ) 1/(N −1)
, for all s ∈ [0, 1] and for all t 0 , t 1 ∈ Dom (g(q, ·)) with t 0 < t 1 . If N = 1, for q-a.e. q ∈ Q the density h q is constant.

Proof. We first consider the case N > 1.

Step 1. Thanks to Proposition 4.8, without any loss of generality we can assume that the quotient set Q (identified with the set {g(q, 0) : q ∈ Q}) is locally a subset of a level set of the map ϕ inducing the transport set, i.e. there exists a countable partition
{Q i } i∈N with Q i ⊂ Q Borel set such that {g(q, 0) : q ∈ Q i } ⊂ {x ∈ X : ϕ(x) = α i }.
It is clearly sufficient to prove (5.5) on each Q i ; so fixī ∈ N and for ease of notation assume αī = 0 and Q = Qī. As Dom (g(q, ·)) is a convex subset of R, we can also restrict to a uniform subinterval (a 0 , a 1 ) ⊂ Dom (g(q, ·)), ∀ q ∈ Q i , for some a 0 , a 1 ∈ R. Again without any loss of generality we also assume a 0 < 0 < a 1 .

Consider any a 0 < A 0 < A 1 < a 1 and L 0 , L 1 > 0 such that A 0 + L 0 < A 1 and A 1 + L 1 < a 1 . Then define the following two probability measures
µ 0 :=ˆQ g(q, ·) ♯ 1 L 0 L 1 [A0,A0+L0] q(dq), µ 1 :=ˆQ g(q, ·) ♯ 1 L 1 L 1 [A1,A1+L1]
q(dq).

Since g(q, ·) is an isometry one can also represent µ 0 and µ 1 in the following way:
µ i :=ˆQ 1 L i H 1 {g(q,t) : t∈[Ai,Ai+Li]} q(dq)
for i = 0, 1. Both µ i are absolutely continuous with respect to m and µ i = ̺ i m with
̺ i (g(q, t)) = 1 L i h q (t) −1 , ∀ t ∈ [A i , A i + L i ].
Moreover from Lemma 4.1 it follows that the curve [0, 1] ∋ s → µ s ∈ P(X) defined by
µ s :=ˆQ 1 L s H 1 {g(q,t) : t∈[As,As+Ls]} q(dq)
where L s := (1 − s)L 0 + sL 1 , A s := (1 − s)A 0 + sA 1 is the unique L 2 -Wasserstein geodesic connecting µ 0 to µ 1 . Again one has µ s = ̺ s m and can also write its density in the following way:
̺ s (g(q, t)) = 1 L s h q (t) −1 , ∀ t ∈ [A s , A s + L s ].
Step 2. By CD loc (K, N ) and the essentially non-branching property one has: for q-a.e. q ∈ Q i
(L s ) 1 N h q ((1 − s)t 0 + st 1 ) 1 N ≥ τ (1−s) K,N (t 1 − t 0 )(L 0 ) 1 N h q (t 0 ) 1 N + τ (s) K,N (t 1 − t 0 )(L 1 ) 1 N h q (t 1 ) 1 N ,
for L 1 -a.e. t 0 ∈ [A 0 , A 0 + L 0 ] and t 1 obtained as the image of t 0 through the monotone rearrangement of [A 0 , A 0 + L 0 ] to [A 1 , A 1 + L 1 ] and every s ∈ [0, 1]. If t 0 = A 0 + τ L 0 , then t 1 = A 1 + τ L 1 . Also A 0 and A 1 + L 1 should be taken close enough to verify the local curvature condition.

Then we can consider the previous inequality only for s = 1/2 and include the explicit formula for t 1 and obtain:
(L 0 + L 1 ) 1 N h q (A 1/2 + τ L 1/2 ) 1 N ≥ σ (1/2) K,N −1 (A 1 − A 0 + τ |L 1 − L 0 |) N −1 N (L 0 ) 1 N h q (A 0 + τ L 0 ) 1 N + (L 1 ) 1 N h q (A 1 + τ L 1 ) 1 N ,
for L 1 -a.e. τ ∈ [0, 1], where we used the notation A 1/2 := A0+A1 2 , L 1/2 := L0+L1 2 . Now observing that the map s → h q (s) is continuous, the previous inequality also holds for τ = 0:
(5.6) (L 0 + L 1 ) 1 N h q (A 1/2 ) 1 N ≥ σ (1/2) K,N −1 (A 1 − A 0 ) N −1 N (L 0 ) 1 N h q (A 0 ) 1 N + (L 1 ) 1 N h q (A 1 ) 1 N , for all A 0 < A 1 with A 0 , A 1 ∈ (a 0 , a 1 )
, all sufficiently small L 0 , L 1 and q-a.e. q ∈ Q, with exceptional set depending on A 0 , A 1 , L 0 and L 1 .

Noticing that (5.6) depends in a continuous way on A 0 , A 1 , L 0 and L 1 , it follows that there exists a common exceptional set N ⊂ Q such that q(N ) = 0 and for each q ∈ Q \ N for all A 0 , A 1 , L 0 and L 1 the inequality (5.6) holds true. Then one can make the following (optimal) choice
L 0 := L h q (A 0 ) 1 N −1 h q (A 0 ) 1 N −1 + h q (A 1 ) 1 N −1 , L 1 := L h q (A 1 ) 1 N −1 h q (A 0 ) 1 N −1 + h q (A 1 ) 1 N −1 ,
for any L > 0 sufficiently small, and obtain that
(5.7) h q (A 1/2 ) 1 N −1 ≥ σ (1/2) K,N −1 (A 1 − A 0 ) h q (A 0 ) 1 N −1 + h q (A 1 ) 1 N −1 .
Now one can observe that (5.7) is precisely the inequality requested for CD * loc (K, N − 1) to hold. As stated in Section 2.1, the reduced curvature-dimension condition verifies the local-to-global property. In particular, see [22,Lemma 5.1,Theorem 5.2], if a function verifies (5.7) locally, then it also satisfies it globally. Hence h q also verifies the inequality requested for CD * (K, N − 1) to hold, i.e. for q-a.e. q ∈ Q, the density h q verifies (5.5).

Step 3. For the case N = 1, repeat the same construction of Step 1. and obtain for q-a.e. q ∈ Q
(L s )h q ((1 − s)t 0 + st 1 ) ≥ (1 − s)L 0 h q (t 0 ) + sL 1 h q (t 1 ),
for any s ∈ [0, 1] and L 0 and L 1 sufficiently small. As before, we deduce for s = 1/2 that
L 0 + L 1 2 h q (A 1/2 ) ≥ 1 2 (L 0 h q (A 0 ) + L 1 h q (A 1 )) .
Now taking L 0 = 0 or L 1 = 0, it follows that necessarily h q has to be constant.

Accordingly to Remark 2.3, Theorem 5.11 can be alternatively stated as follows.

If (X, d, m) is an essentially non-branching m.m.s. verifying CD loc (K, N ) and ϕ : X → R is a 1-Lipschitz function, then the corresponding decomposition of the space in maximal rays {X q } q∈Q produces a disintegration {m q } q∈Q of m so that for q-a.e. q ∈ Q, the m.m.s. (Dom (g(q, ·)), | · |, h q L 1 ) verifies CD(K, N ).

Accordingly, one says that the disintegration q → m q is a CD(K, N ) disintegration.

The disintegration obtained with L 1 -Optimal Transportation is also balanced in the sense of Section 4.2. This additional information together with what proved so far is collected in the next Theorem 5.12 (Theorem 5.1 of [20]). Let (X, d, m) be an essentially non-branching metric measure space verifying the CD loc (K, N ) condition for some K ∈ R and N ∈ [1, ∞). Let f : X → R be m-integrable such that´X f m = 0 and assume the existence of
x 0 ∈ X such that´X |f (x)| d(x, x 0 ) m(dx) < ∞.
Then the space X can be written as the disjoint union of two sets Z and T with T admitting a partition {X q } q∈Q and a corresponding disintegration of m T , {m q } q∈Q such that:

• For any m-measurable set B ⊂ T it holds
m(B) =ˆQ m q (B) q(dq),
where q is a probability measure over Q defined on the quotient σ-algebra Q.

• For q-almost every q ∈ Q, the set X q is a geodesic and m q is supported on it. Moreover q → m q is a CD(K, N ) disintegration.

• For q-almost every q ∈ Q, it holds´X q f m q = 0 and f = 0 m-a.e. in Z. The proof is just a collection of already proven statements. We include it for readers convenience.

Proof. Consider
µ 0 := f + m 1 f + m , µ 1 := f − m 1 f − m ,
where f ± stands for the positive and negative part of f , respectively. From the summability assumption on f it follows the existence of ϕ : X → R, 1-Lipschitz Kantorovich potential for the couple of marginal probability µ 0 , µ 1 . Since the m.m.s. (X, d, m) is essentially non-branching, the transport set T is partitioned by the rays: m T =ˆQ m q q(dq), m q (X q ) = 1, q − a.e. q ∈ Q; moreover (X, d, m) verifies CD loc and therefore Theorem 5.11 implies that q → m q is a CD(K, N ) disintegration. Lemma 4.13 implies thatˆX q f (x) m q (dx) = 0.

To conclude moreover note that in X \ T necessarily f has to be zero. Take indeed any B ⊂ X \ T compact with m(B) > 0 and assume f = 0 over B. Then possibly taking a subset, we can assume f > 0 over B and therefore µ 0 (B) > 0. Since
µ 0 =ˆQ µ 0 q q(dq), µ 0 q (X q ) = 1,
necessarily B cannot be a subset of X \ T yielding a contradiction. All the claims are proved.


## Applications

Here we will collect some applications of the results proved so far, in particular of Proposition 5.2 and Theorem 5.11 6.1. Solution of the Monge problem. Here we review how regularity of conditional probabilities of the one-dimensional disintegration studied so far permits to construct a solution to the Monge problem. In particular we will see how Proposition 5.2 allows to construct an optimal map T . As the plan is to use the one-dimensional reduction, first we recall the one dimensional result for the Monge problem [56]. maps µ 0 to µ 1 . Moreover any other non decreasing map T ′ such that T ′ ♯ µ 0 = µ 1 coincides with T on the support of µ 0 up to a countable set.

(2) If φ : [0, +∞] → R is non decreasing and convex, then T is an optimal transport relative to the cost c(s, t) = φ(|s − t|). Moreover T is the unique optimal transference map if φ is strictly convex.

Theorem 6.2 (Theorem 6.2 of [11]). Let (X, d, m) be a non-branching metric measure space and consider µ 0 , µ 1 ∈ P(X) with finite first moment. Assume the existence of a Kantorovich potential ϕ such that the associated transport set T verifies (A.1). Assume µ 0 ≪ m. Then there exists a Borel map T : X → X such that X d(x, T (X)) µ 0 (dx) = min π∈Π(µ0,µ1)ˆX ×X d(x, y) π(dxdy).

Theorem 6.2 was presented in [11] assuming the space to be non-branching, while here we assume essentially non-branching.

Proof. Step 1. One dimensional reduction of µ 0 . Let ϕ : X → R be the Kantorovich potential from the assumptions and T the corresponding transport set. Accordingly
m T =ˆQ m q q(dq),
with m q (X q ) = 1 for q-a.e. q ∈ Q. Moreover from (A.1) for q-a.e. q ∈ Q the conditional m q has no atoms, i.e. m q ({z}) = 0 for all z ∈ X. From Lemma 3.4, we can assume that µ 0 (T e ) = µ 1 (T e ) = 1. Since µ 0 = ̺ 0 m, with ̺ 0 : X → [0, ∞), from Theorem 3.5 we have µ 0 (T ) = 1. Hence
µ 0 =ˆQ ̺ 0 m q q(dq) =ˆQ µ 0 q q 0 (dq), µ 0 q := ̺ 0 m q ˆX ̺ 0 (x)m q (dx) −1
, and q 0 = Q ♯ µ 0 . In particular µ 0, q has no atoms and µ 0 q (X q ) = 1.

Step 2. One dimensional reduction of µ 1 . As we are not making any assumption on µ 1 we cannot exclude that µ 1 (T e \ T ) > 0 and therefore to localize µ 1 one cannot proceed as for µ 0 . Consider therefore an optimal transport plan π with π(Γ) = 1. Since π(T ×T e ) = 1 and a partition of T is given, we can consider the following family of sets {X q ×T e } q∈Q as a partition of T × T e ; note indeed that X q × T e ∩ X q ′ ∩ T e = ∅ as soon as q = q ′ . The domain of the quotient map Q : T → Q can be trivially extended to T × T e by saying that Q(x, z) = Q(x) and observe that Q ♯ π(I) = π Q −1 (I) = π Q −1 (I) × T e = µ 0 (Q −1 (I)) = q 0 (I). In particular this implies that π =ˆQ π q q 0 (dq), π q (X q × T e ) = 1, for q 0 -a.e. q ∈ Q.

Then applying the projection µ 0 = P 1 ♯ π =ˆQ P 1 ♯ (π q ) q 0 (dq), and by uniqueness of disintegration P 1 ♯ (π q ) = µ 0 q for q 0 -a.e. q ∈ Q. Then we can find a localization of µ 1 as follows:
µ 1 = P 2 ♯ π =ˆQ P 2 ♯ (π q ) q 0 (dq) =ˆQ µ 1 q q 0 (dq),
where by definition we posed µ 1 q := P 2 ♯ (π q ) and by construction µ 1 q (X q ) = µ 0 q (X q ) = 1.

Step 3. Solution to the Monge problem. For each q ∈ Q consider the distribution functions H(q, t) := µ 0 q ((−∞, t)), F (q, t) := µ 1 q ((−∞, t)), where for ease of notation µ i q = g(q, ·) −1 ♯ µ i q for i = 0, 1. Then defineT , as Theorem 6.1 suggests, bŷ T (q, s) := q, sup t : F (q, t) ≤ H(q, s) .

Note that since H is continuous (µ 0 q has no atoms), the map s →T (q, s) is well-defined. Then define the transport map T : T → X as g •T • g −1 . It is fairly easy to observe that
T ♯ µ 0 =ˆQ g •T • g −1 ♯
µ 0 q q 0 (dq) =ˆQ µ 1 q q 0 (dq) = µ 1 ;

moreover (x, T (x)) ∈ Γ and therefore the graph of T is d-cyclically monotone and therefore the map T is optimal. Extend T to X as the identity. It remains to show that it is Borel. First observe that, possibly taking a compact subset of Q the map q → (µ 0 q , µ 1 q ) can be assumed to be weakly continuity; it follows that the maps Dom (g) ∋ (q, t) → H(q, t) := µ 0 q ((−∞, t)), (q, t) → F (q, t) := µ 1 q ((−∞, t)) are lower semicontinuous. Then for A Borel, T −1 (A × [t, +∞)) = (q, s) : q ∈ A, H(q, s) ≥ F (q, t) ∈ B(Q × R), and therefore the same applies for T .

If (X, d, m) verifies MCP then it also verifies (A.1), see Proposition 5.9. So we have the following Corollary 6.3 (Corollary 9.6 of [11]). Let (X, d, m) be a non-branching metric measure space verifying MCP(K, N ). Let µ 0 and µ 1 be probability measures with finite first moment and µ 0 ≪ m. Then there exists a Borel optimal transport map T : X → X solution to the Monge problem. Corollary 6.3 in particular implies the existence of solutions to the Monge problem in the Heisenberg group when µ 0 is assumed to be absolutely continuous with respect to the left-invariant Haar measure. Theorem 6.4 (Monge problem in the Heisenberg group). Consider (H n , d c , L 2n+1 ), the n-dimensional Heisenberg group endowed with the Carnot-Carathéodory distance d c and the (2n + 1)-Lebesgue measure that coincide with the Haar measure on (H n , d c ) under the identification H n ≃ R 2n+1 . Let µ 0 and µ 1 be two probability measures with finite first moment and µ 0 ≪ L 2n+1 . Then there exists a Borel optimal transport map T : X → X solution to the Monge problem.

Remark 6.5. The techniques used so far were successfully used also to threat the more general case of infinite dimensional spaces with curvature bound, see [16] where the existence of solutions for the Monge minimization problem in the Wiener space is proved. Note that the material presented in the previous sections can be obtained also without assuming the existence of a 1-Lipschitz Kantorovich potential (e.g. the Wiener space); the decomposition of the space in geodesics and the associated disintegration of the reference measures can be obtained starting from a generic d-cyclically monotone set. For all the details see [11]. 6.2. Isoperimetric inequality. We now turn to the second main application of techniques reviewed so far, the Lévy-Gromov isoperimetric inequality in singular spaces. The results of this section are taken from [20,21]. Theorem 6.6 (Theorem 1.2 of [20]). Let (X, d, m) be a metric measure space with m(X) = 1, verifying the essentially non-branching property and CD loc (K, N ) for some K ∈ R, N ∈ [1, ∞). Let D be the diameter of X, possibly assuming the value ∞. Proof. First of all we can assume D < ∞ and therefore m ∈ P 2 (X): indeed from the Bonnet-Myers Theorem if K > 0 then D < ∞, and if K ≤ 0 and D = ∞ then the model isoperimetric profile (2.9) trivializes, i.e. I K,N,∞ ≡ 0 for K ≤ 0.

For v = 0, 1 one can take as competitor the empty set and the whole space respectively, so it trivially holds with m q = g(q, ·) ♯ h q · L 1 ; moreover, for q-a.e. q ∈ Q, the density h q verifies (5.5) and X f (z) m q (dz) =ˆD om (g(q,·)) f (g(q, t)) · h q (t) L 1 (dt) = 0. Therefore (6.1) v = m q (A ∩ {g(q, t) : t ∈ R}) = (h q L 1 )(g(q, ·) −1 (A)), for q-a.e. q ∈ Q.

For every ε > 0 we then have
m(A ε ) − m(A) ε = 1 εˆT χ A ε \A m(dx) = 1 εˆQ ˆX χ A ε \A m q (dx) q(dq) =ˆQ 1 ε ˆD om (g(q,·)) χ A ε \A h q (t) L 1 (dt) q(dq)
=ˆQ (h q L 1 )(g(q, ·) −1 (A ε )) − (h q L 1 )(g(q, ·) −1 (A)) ε q(dq) ≥ˆQ (h q L 1 )((g(q, ·) −1 (A)) ε ) − (h q L 1 )(g(q, ·) −1 (A)) ε q(dq),

where the last inequality is given by the inclusion (g(q, ·) −1 (A)) ε ∩ supp(h q ) ⊂ g(q, ·) −1 (A ε ). Recalling (6.1) together with h q L 1 ∈ F s K,N,D , by Fatou's Lemma we get
m + (A) = lim inf ε↓0 m(A ε ) − m(A) ε ≥ˆQ lim inf ε↓0
(h q L 1 )((g(q, ·) −1 (A)) ε ) − (h q L 1 )(g(q, ·) −1 (A)) ε q(dq) =ˆQ (h q L 1 ) + (g(q, ·) −1 (A)) q(dq)

≥ˆQ I s K,N,D (v) q(dq)
= I K,N,D (v),
where in the last equality we used Theorem 2.6.

From the definition of I K,N,D , see (2.9), and the smooth results of E. Milman in [41], the estimates proved in Theorem 6.6 are sharp.

Furthermore, 1-dimensional localization technique permits to obtain rigidity in the following sense: if for some v ∈ (0, 1) it holds I (X,d,m) (v) = I K,N,π (v), then (X, d, m) is a spherical suspension. It is worth underlining that to obtain such a result (X, d, m) is assumed to be in the more regular class of RCD-spaces.

Even more, one can prove an almost rigidity statement: if (X, d, m) is an RCD * (K, N ) space such that I (X,d,m) (v) is close to I K,N,π (v) for some v ∈ (0, 1), this force X to be close, in the measure-Gromov-Hausdorff distance, to a spherical suspension. What follows is Corollary 1.6 of [20]. sin Y ) ≤ ε. We refer to [20] for the precise rigidity statement (Theorem 1.4, [20]) and for the proof of Theorem 1.4 and Corollary 1.6 of [20]. See also [20] for the precise definition of spherical suspension. We conclude by recalling that 1-dimensional localization was used also in [21] to obtain sharp version of several functional inequalities (e.g. Brunn-Minkowski, spectral gap, Log-Sobolev etc.) in the class of CD(K, N )-spaces. See [21] for details.


Definition 2.2 (CD condition). An essentially non-branching m.m.s. (X, d, m) verifies CD(K, N ) if and only if for each pair

## Remark 2. 3 .
3It is worth recalling that if (M, g) is a Riemannian manifold of dimension n and h ∈ C 2 (M ) with h > 0, then the m.m.s. (M, g, h vol) verifies CD(K, N ) with N ≥ n if and only if (see Theorem 1.7 of [52])


and verifies CD(K, 1) if and only if h is constant. Inequality (2.5) has also a non-smooth counterpart; if we drop the smoothness assumption on h it can be proven that the m.m.s. (I, | · |, hL 1 ) verifies CD(K, N ) if and only if

## Lemma 4. 4 .
4There exists an A-measurable map u : A + → G × G such that if u(x) = (γ 1 , γ 2 ) then -(x, γ 1 s ), (x, γ 2 s ) ∈ Γ for all s ∈ [0, 1]; Moreover both geodesics are non-constant.

## Proposition 4. 5 .
5Let (X, d, m) be a m.m.s. such that for any µ 0 , µ 1 ∈ P(X) with µ 0 ≪ m any optimal transference plan for W 2 is concentrated on the graph of a function. Thenm(A + ) = m(A − ) = 0. Proof. Step 1. Suppose by contradiction that m(A + ) > 0. By definition of A + , thanks to Lemma 4.2 and Lemma 4.4, for every x ∈ A + there exist two non-constant geodesics γ 1 , γ


:= T e \ (A + ∪ A − )

## Remark 4 . 10 .
410One can improve the regularity of the disintegration formula (4.5) as follows. From inner regularity of Borel measures there exists S ⊂ Q σ-compact, such that q(Q \ S) = 0. The subset R −1 (S) ⊂ T is again σ-compact, indeed

## Definition 4 . 11 (
411Definition 4.5, [11]). [Ray map] Define the ray map g : Dom(g) ⊂ Q × R → T via the formula:


for a set of t ∈ R with L 1 -positive measure; (A.3) the m.m.s. (X, d, m) verifies CD(K, N ).


(A.1) implies (R.1), (A.2) implies (R.2) and (A.3) implies (R.3). Actually we will also show a variant of (A.3) (assuming MCP instead of CD) implies a variant of (R.3) (MCP instead of CD).


its graph is countable union of closed sets: in fact, if (q m , x m ) → (y, x) and m qm ({x m }) ≥ 2 −n , then m q ({x}) ≥ 2 −n by upper semi-continuity on compact sets.


Consider a sequence {y i } i∈N ⊂ {ϕ = δ} dense in T (C). For each I ∈ N, define the family of sets E i,I := {x ∈ C : d(x, y i ) ≤ d(x, y j ), j = 1, . . . , I}, for i = 1, . . . , I. Then for all I ∈ N, by the same argument of Lemma 5.5, the set

## Theorem 5. 10 (
10Localization of MCP, Theorem 9.5 of [11]). Assume the non-branching m.m.s. (X, d, m) to satisfy MCP(K,

## Theorem 6. 1 .
1Let µ 0 , µ 1 be probability measures on R, µ 0 with no atoms, and let H(s) := µ 0 ((−∞, s)), F (t) := µ 1 ((−∞, t)), be the left-continuous distribution functions of µ 0 and µ 1 respectively. Then the following holds. (1) The non decreasing function T : R → R ∪ [−∞, +∞) defined by T (s) := sup t ∈ R : F (t) ≤ H(s)

## I
(X,d,m) (v) ≥ I K,N,D (v),where I K,N,D is the model isoperimetric profile defined in (2.9).

## I
(X,d,m) (0) = I (X,d,m) (1) = I K,N,D (0) = I K,N,D (1) = 0. Fix then v ∈ (0, 1) and let A ⊂ X be an arbitrary Borel subset of X such that m(A) = v. Consider the m-measurable function f (x) := χ A (x) − v and notice that´X f m = 0. Thus f verifies the hypothesis of Theorem 5.12 and noticing that f is never null, we can decompose X = Y ∪ T with m(Y ) = 0, m T =ˆQ m q q(dq),

## Theorem 6 . 7 (
67Almost equality in Lévy-Gromov implies mGH-closeness to a spherical suspension). For every N ∈ [2, ∞), v ∈ (0, 1), ε > 0 there existsδ =δ(N, v, ε) > 0 such that the following hold. For every δ ∈ [0,δ], if (X, d, m) is an RCD * (N − 1 − δ, N + δ) space satisfying I (X,d,m) (v) ≤ I N −1,N,π (v) + δ, then there exists an RCD * (N − 2, N − 1) space (Y, d Y , m Y ) with m Y (Y ) = 1 such that d mGH (X, [0, π] × N −1

Lecture notes on the Optimal Transport problems. L Ambrosio, Mathematical aspects of evolving interfaces -CIME Springer Lecture Notes. L. Ambrosio, Lecture notes on the Optimal Transport problems. Mathematical aspects of evolving interfaces -CIME Springer Lecture Notes, 1-52, (2003).

Functions of Bounded Variation and Free Discontinuity Problems. L Ambrosio, N Fusco, D Pallara, Oxford Mathematical Monographs. L. Ambrosio, N. Fusco and D. Pallara, Functions of Bounded Variation and Free Discontinuity Problems, Oxford Mathematical Monographs, (2000).

Bakry-Émery curvature-dimension condition and Riemannian Ricci curvature bounds. L Ambrosio, G Gigli, Savaré, Ann. Probab. 431L. Ambrosio, N Gigli and G. Savaré, Bakry-Émery curvature-dimension condition and Riemannian Ricci curvature bounds. Ann. Probab., 43, 1, (2015), 339-404.

Calculus and heat flow in metric measure spaces and applications to spaces with Ricci bounds from below. Invent. Math. 1952, Calculus and heat flow in metric measure spaces and applications to spaces with Ricci bounds from below, Invent. Math., 195, 2, (2014), 289-391.

Metric measure spaces with Riemannian Ricci curvature bounded from below. Duke Math. J. 163, Metric measure spaces with Riemannian Ricci curvature bounded from below, Duke Math. J., 163, (2014), 1405-1490.

Currents in metric spaces. L Ambrosio, Kirchheim, Acta Math. 1851L. Ambrosio and B Kirchheim, Currents in metric spaces, Acta Math., 185, 1, (2000), 1-80.

Existence of optimal transports with crystalline norms. L Ambrosio, A Kirchheim, Pratelli, Duke Math. J. 1252L. Ambrosio, B Kirchheim and A. Pratelli, Existence of optimal transports with crystalline norms. Duke Math. J., 125, 2, (2004), 207-241.

Nonlinear diffusion equations and curvature conditions in metric measure spaces. L Ambrosio, A Mondino, G Savaré, arXiv:1509.07273PreprintL. Ambrosio, A. Mondino and G. Savaré, Nonlinear diffusion equations and curvature conditions in metric measure spaces, Preprint arXiv:1509.07273.

Localization and tensorization properties of the curvature-dimension condition for metric measure spaces. K Bacher, K.-T Sturm, J. Funct. Anal. 259K. Bacher and K.-T. Sturm, Localization and tensorization properties of the curvature-dimension condition for metric measure spaces, J. Funct. Anal., 259, (2010), 28-56.

On the extremality, uniqueness and optimality of transference plans. S Bianchini, L Caravenna, Bull. Inst. Math. Acad. Sin. (N.S.). 44S. Bianchini and L. Caravenna, On the extremality, uniqueness and optimality of transference plans, Bull. Inst. Math. Acad. Sin. (N.S.), 4(4), (2009), 353-455.

The Monge problem for distance cost in geodesic spaces. S Bianchini, F Cavalletti, Commun. Math. Phys. 318S. Bianchini and F. Cavalletti, The Monge problem for distance cost in geodesic spaces, Commun. Math. Phys., 318, (2013), 615 -673.

On Sudakov's type decomposition of transference plans with norm costs. S Bianchini, S Daneri, Mem. Amer. Math. Soc. in pressS. Bianchini and S. Daneri, On Sudakov's type decomposition of transference plans with norm costs, Mem. Amer. Math. Soc., in press.

A course in Metric geometry. D Burago, Y Burago, S Ivanov, Graduate Studies in Mathematics. AMSD. Burago, Y. Burago and S. Ivanov, A course in Metric geometry, Graduate Studies in Mathematics, AMS, 2001.

Y D Burago, V Zalgaller, Geometric inequalities, Grundlehren der Mathematischen Wissenschaften. BerlinSpringer285Fundamental Principles of Mathematical SciencesY.D. Burago and V.A Zalgaller, Geometric inequalities, Grundlehren der Mathematischen Wissenschaften [Funda- mental Principles of Mathematical Sciences], 285. Springer, Berlin (1988).

Constructing optimal maps for Monge's transport problem as a limit of strictly convex costs. L Caffarelli, M Feldman, R J Mccann, J. Amer. Math. Soc. 15L. Caffarelli, M. Feldman and R.J. McCann, Constructing optimal maps for Monge's transport problem as a limit of strictly convex costs. J. Amer. Math. Soc., 15, (2002), 1-26.

The Monge problem in Wiener space Calc. F Cavalletti, F. Cavalletti, The Monge problem in Wiener space Calc. Var. PDE, 45, (2012), 101-124.

Decomposition of geodesics in the Wasserstein space and the globalization property. Geom. Funct. Anal. 24, Decomposition of geodesics in the Wasserstein space and the globalization property. Geom. Funct. Anal., 24, (2014), 493 -551.

Monge problem in metric measure spaces with Riemannian curvature-dimension condition. Nonlinear Anal. 99, Monge problem in metric measure spaces with Riemannian curvature-dimension condition, Nonlinear Anal., 99, (2014), 136-151.

Measure rigidity of Ricci curvature lower bounds. F Cavalletti, A Mondino, Adv. Math. 286F. Cavalletti and A. Mondino, Measure rigidity of Ricci curvature lower bounds, Adv. Math. 286 (2016) 430-480.

Sharp and rigid isoperimetric inequalities in metric-measure spaces with lower Ricci curvature bounds. Arxiv:1502.06465Preprint, Sharp and rigid isoperimetric inequalities in metric-measure spaces with lower Ricci curvature bounds, Preprint Arxiv:1502.06465, (2015).

Sharp geometric and functional inequalities in metric measure spaces with lower Ricci curvature bounds. arXiv:1502.06465to appear in Geom. Top, Sharp geometric and functional inequalities in metric measure spaces with lower Ricci curvature bounds, to appear in Geom. Top. arXiv: 1502.06465, (2015).

Local curvature-dimension condition implies measure-contraction property. F Cavalletti, K.-T Sturm, J. Funct. Anal. 262F. Cavalletti and K.-T. Sturm. Local curvature-dimension condition implies measure-contraction property. J. Funct. Anal., 262, 5110 -5127, 2012.

A proof of Sudakov theorem with strictly convex norms. L Caravenna, Math. Z. 2681L. Caravenna A proof of Sudakov theorem with strictly convex norms, Math. Z., 268, 1, (2011), 371-407.

A selection principle for the sharp quantitative isoperimetric inequality. M Cicalese, G P Leonardi, Arch. Rat. Mech. Anal. 2062M. Cicalese, G.P. Leonardi, A selection principle for the sharp quantitative isoperimetric inequality, Arch. Rat. Mech. Anal., 206, 2, (2012), 617-643.

Unique isoperimetric foliations of asymptotically flat manifolds in all dimensions. M Eichmair, J Metzger, Invent. Math. 194M. Eichmair and J. Metzger, Unique isoperimetric foliations of asymptotically flat manifolds in all dimensions, Invent. Math., 194, (2013), 591-630.

On the Equivalence of the Entropic Curvature-Dimension Condition and Bochner's Inequality on Metric Measure Space. M Erbar, K T Kuwada, Sturm, Invent. Math. 201M Erbar, Kuwada and K.T. Sturm, On the Equivalence of the Entropic Curvature-Dimension Condition and Bochner's Inequality on Metric Measure Space, Invent. Math., 201, 3, (2015), 993-1071.

L C Evans, Partial Differential Equations. AMS19L. C. Evans, Partial Differential Equations, Graduate Studies in Mathematics, vol. 19, AMS, 1998.

Monge's transport problem on a Riemannian manifold. M Feldman, R J Mccann, Trans. Amer. Math. Soc. 354M. Feldman and R.J. McCann Monge's transport problem on a Riemannian manifold, Trans. Amer. Math. Soc., 354, (2002), 1667-1697.

A mass transportation approach to quantitative isoperimetric inequalities. A Figalli, F Maggi, A Pratelli, Invent. Math. 1821A. Figalli, F. Maggi and A. Pratelli, A mass transportation approach to quantitative isoperimetric inequalities, Invent. Math., 182, 1, (2010), 167-211.

D H Fremlin, Measure Theory. 4D. H. Fremlin, Measure Theory, volume 4. Torres Fremlin, 2002.

The sharp quantitative isoperimetric inequality. N Fusco, F Maggi, A Pratelli, Ann. of Math. 168N. Fusco, F. Maggi and A. Pratelli, The sharp quantitative isoperimetric inequality, Ann. of Math., 168, (2008), 941-980.

Optimal maps in non branching spaces with Ricci curvature bounded from below. N Gigli, Geom. Funct. Anal. 224N. Gigli, Optimal maps in non branching spaces with Ricci curvature bounded from below, Geom. Funct. Anal., 22 (2012) no. 4, 990-999.

On the differential structure of metric measure spaces and applications. N Gigli, Mem. Am. Math. Soc. 236N. Gigli, On the differential structure of metric measure spaces and applications, Mem. Am. Math. Soc., 236 (2015) no. 1113.

Optimal maps and exponentiation on finite dimensional spaces with Ricci curvature bounded from below. N Gigli, T Rajala, K T Sturm, to appear in J. Geom. AnalysisN. Gigli, T. Rajala and K.T. Sturm, Optimal maps and exponentiation on finite dimensional spaces with Ricci curvature bounded from below to appear in J. Geom. Analysis.

Metric structures for Riemannian and non Riemannian spaces. M Gromov, Modern Birkhäuser Classics. M. Gromov, Metric structures for Riemannian and non Riemannian spaces, Modern Birkhäuser Classics, (2007).

Generalization of the spherical isoperimetric inequality to uniformly convex Banach spaces. M Gromov, V Milman, Compositio Math. 62M. Gromov and V. Milman, Generalization of the spherical isoperimetric inequality to uniformly convex Banach spaces. Compositio Math., 62, 3, (1987), 263-282.

Isoperimetric problems for convex bodies and a localization lemma. R Kannan, L Lovász, M Simonovits, Discrete Comput. Geom. 13R. Kannan, L. Lovász and M. Simonovits, Isoperimetric problems for convex bodies and a localization lemma, Discrete Comput. Geom., 13, 3-4, (1995), 541-559.

Needle decomposition in Riemannian geometry. B Klartag, AMSto appear in MemB. Klartag, Needle decomposition in Riemannian geometry, to appear in Mem. AMS.

Ricci curvature for metric-measure spaces via optimal transport. J Lott, C Villani, Ann. of Math. 2J. Lott and C. Villani, Ricci curvature for metric-measure spaces via optimal transport, Ann. of Math. (2) 169 (2009), 903-991.

Random walks in a convex body and an improved volume algorithm. L Lovász, M Simonovits, Random Structures Algorithms. 44L. Lovász and M. Simonovits, Random walks in a convex body and an improved volume algorithm, Random Structures Algorithms, 4, 4, (1993), 359-412.

Sharp Isoperimetric Inequalities and Model Spaces for Curvature-Dimension-Diameter Condition. E Milman, J. Europ. Math. Soc. to appearE. Milman, Sharp Isoperimetric Inequalities and Model Spaces for Curvature-Dimension-Diameter Condition, J. Europ. Math. Soc. to appear.

Complemented Brunn-Minkowski Inequalities and Isoperimetry for Homogeneous and Non-Homogeneous Measures. E Milman, L Rotem, Advances in Math. 262E. Milman and L. Rotem, Complemented Brunn-Minkowski Inequalities and Isoperimetry for Homogeneous and Non- Homogeneous Measures, Advances in Math., 262, 867-908, (2014).

Geometric Measure Theory (A Beginner's Guide). F Morgan, Elsevier/Academic PressAmsterdamFourth editionF. Morgan, Geometric Measure Theory (A Beginner's Guide), Elsevier/Academic Press, Amsterdam, Fourth edition, (2009).

In polytopes, small balls about some vertex minimize perimeter. J. Geom. Anal. 17, In polytopes, small balls about some vertex minimize perimeter. J. Geom. Anal. 17, 97-106, (2007).

Isoperimetric regions in cones. F Morgan, M Ritoré, Trans. Amer. Math. Soc. 354F. Morgan and M. Ritoré, Isoperimetric regions in cones, Trans. Amer. Math. Soc., 354, (2002), 2327-2339.

The isoperimetric inequality. R Osserman, Bull. Am. Math. Soc. 846R. Osserman, The isoperimetric inequality, Bull. Am. Math. Soc., 84 (6), 1182-1238, (1978)

An optimal Poincaré inequality for convex domains Arch. L E Payne, H F Weinberger, Rational Mech. Anal. 5L.E. Payne and H.F. Weinberger, An optimal Poincaré inequality for convex domains Arch. Rational Mech. Anal., 5, (1960), 286-292.

Geometric flows, isoperimetric inequalities and hyperbolic geometry, Mean curvature flow and isoperimetric inequalities. M Ritoré, Adv. Courses Math. CRM Barcelona. M. Ritoré, Geometric flows, isoperimetric inequalities and hyperbolic geometry, Mean curvature flow and isoperimetric inequalities, Adv. Courses Math. CRM Barcelona, 45-113, Birkhäuser, Basel, (2010).

The isoperimetric problem, Lecture series at the Clay Mathematics Institute, Summer School on the Global Theory of Minimal Surfaces. A Ros, MSRI. A. Ros The isoperimetric problem, Lecture series at the Clay Mathematics Institute, Summer School on the Global Theory of Minimal Surfaces, MSRI, Berkeley, California, (2001).

A course on Borel sets. A M Srivastava, SpringerA. M. Srivastava. A course on Borel sets. Springer, 1998.

On the geometry of metric measure spaces. I. K T Sturm, Acta Math. 196K.T. Sturm, On the geometry of metric measure spaces. I, Acta Math. 196 (2006), 65-131.

On the geometry of metric measure spaces. K T Sturm, Acta Math. IIK.T. Sturm, On the geometry of metric measure spaces. II, Acta Math. 196 (2006), 133-177.

Geometric problems in the theory of dimensional distributions. V N Sudakov, Proc. Steklov Inst. Math. 146V.N. Sudakov Geometric problems in the theory of dimensional distributions. Proc. Steklov Inst. Math. 146 (1979), 1-178.

On the Monge mass transfer problem. N S Trudinger, X J Wang, Calc. Var. PDE. 13N.S. Trudinger and X.J. Wang, On the Monge mass transfer problem, Calc. Var. PDE, 13, (2001), 19-31.

Topics in Optimal Transportation. C Villani, Graduate Studies in Mathematics. AMSC. Villani, Topics in Optimal Transportation, Graduate Studies in Mathematics, AMS, 2003.

Optimal transport. C Villani, Grundlehren der Mathematischen Wissenschaften. BerlinSpringer-Verlag338Old and newC. Villani, Optimal transport. Old and new, Grundlehren der Mathematischen Wissenschaften, 338, Springer-Verlag, Berlin, (2009).